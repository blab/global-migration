(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    366308,       9039]
NotebookOptionsPosition[    351933,       8625]
NotebookOutlinePosition[    352381,       8644]
CellTagsIndexPosition[    352338,       8641]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Analysis of standard phylogeographic model", "Title",
 CellChangeTimes->{{3.572699118876226*^9, 3.572699129090479*^9}}],

Cell[TextData[{
 "Requires ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " 9 to run without errors."
}], "Text",
 CellChangeTimes->{{3.617245434173065*^9, 3.6172454444759073`*^9}}],

Cell[CellGroupData[{

Cell["Input parameters", "Section",
 CellChangeTimes->{{3.59950915160145*^9, 3.599509157026783*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stem", "=", "\"\<yam_small_geo\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.5726991602787943`*^9, 3.572699160349663*^9}, 
   3.5727000453670692`*^9, {3.5727038737606897`*^9, 3.5727038738402033`*^9}, {
   3.572704890829528*^9, 3.5727048915575523`*^9}, {3.5727053646704473`*^9, 
   3.5727053670307007`*^9}, {3.572722682516913*^9, 3.5727226881732903`*^9}, {
   3.572722873011958*^9, 3.5727228945933657`*^9}, {3.5727230333831453`*^9, 
   3.572723033749332*^9}, {3.5727598284564466`*^9, 3.5727598285395327`*^9}, {
   3.5727613702279654`*^9, 3.5727613709733057`*^9}, {3.5727620778595867`*^9, 
   3.572762078132744*^9}, {3.572763072555286*^9, 3.572763072811871*^9}, {
   3.572772298345285*^9, 3.572772298708173*^9}, {3.572772428787241*^9, 
   3.572772428853985*^9}, {3.5727725504424686`*^9, 3.572772550520753*^9}, {
   3.5727747143898497`*^9, 3.572774714467963*^9}, {3.5727813603475943`*^9, 
   3.572781360848199*^9}, {3.5727814190716457`*^9, 3.572781419130851*^9}, {
   3.572781849541115*^9, 3.572781849604985*^9}, {3.572781899264358*^9, 
   3.5727818996159678`*^9}, {3.573284837980836*^9, 3.573284838084876*^9}, {
   3.573288866909505*^9, 3.57328886697017*^9}, {3.5732891520744877`*^9, 
   3.573289152202073*^9}, {3.5732908777567244`*^9, 3.573290877815044*^9}, {
   3.573294870795167*^9, 3.573294870868561*^9}, {3.5732954561433268`*^9, 
   3.573295456231996*^9}, {3.5732960766278477`*^9, 3.573296077024538*^9}, {
   3.5732963138885612`*^9, 3.5732963141112967`*^9}, {3.573383203083583*^9, 
   3.573383203153324*^9}, {3.575266259126505*^9, 3.5752662592861023`*^9}, {
   3.5752664714413853`*^9, 3.575266471733714*^9}, {3.575266569465374*^9, 
   3.575266569705055*^9}, {3.575796153735828*^9, 3.575796154658709*^9}, {
   3.57582620899094*^9, 3.575826209103202*^9}, {3.5758617005172567`*^9, 
   3.575861700780445*^9}, {3.575861878664754*^9, 3.575861878928112*^9}, {
   3.575961568034733*^9, 3.575961568107613*^9}, {3.5759675967287197`*^9, 
   3.575967596824279*^9}, {3.5759701919006243`*^9, 3.575970192558948*^9}, {
   3.575973148859817*^9, 3.575973148945731*^9}, {3.575973580605914*^9, 
   3.575973580689023*^9}, {3.5759737082783537`*^9, 3.575973708747655*^9}, 
   3.575973920597259*^9, {3.5759761649834347`*^9, 3.575976165440524*^9}, {
   3.575976249282465*^9, 3.5759762493465233`*^9}, {3.57597632814014*^9, 
   3.575976328219417*^9}, {3.5762165028692513`*^9, 3.576216502965757*^9}, {
   3.580754226166936*^9, 3.580754226267275*^9}, {3.580760566733973*^9, 
   3.58076056685557*^9}, {3.5808389782286882`*^9, 3.580838978404524*^9}, {
   3.580839244327125*^9, 3.5808392459363194`*^9}, {3.580839373374256*^9, 
   3.580839374411784*^9}, {3.580839808552041*^9, 3.580839808633795*^9}, {
   3.5808409519785633`*^9, 3.580840952116437*^9}, {3.5808409903164577`*^9, 
   3.580840991065872*^9}, {3.5808410427126513`*^9, 3.580841043980071*^9}, {
   3.5808411022746572`*^9, 3.580841103179947*^9}, {3.5808411477813673`*^9, 
   3.580841148856645*^9}, {3.580841193788316*^9, 3.580841193907998*^9}, {
   3.581871869200794*^9, 3.581871869300392*^9}, {3.581874131488068*^9, 
   3.581874131939308*^9}, {3.5818743212290707`*^9, 3.581874323859785*^9}, {
   3.5847259761934643`*^9, 3.5847259762531223`*^9}, {3.584726140787797*^9, 
   3.5847261409157476`*^9}, {3.584726275125639*^9, 3.584726275728097*^9}, {
   3.584726361713415*^9, 3.584726362736733*^9}, {3.584726509978169*^9, 
   3.584726510777936*^9}, {3.593912399111362*^9, 3.593912399205659*^9}, {
   3.5939125000650578`*^9, 3.5939125007771673`*^9}, {3.5939126200061283`*^9, 
   3.593912621229804*^9}, {3.5945885122819357`*^9, 3.594588512358841*^9}, {
   3.594589337945093*^9, 3.594589338045586*^9}, {3.594590576388131*^9, 
   3.5945905768723097`*^9}, {3.594591373563849*^9, 3.59459137379992*^9}, {
   3.59950691392809*^9, 3.599506919336335*^9}, {3.5995076386972923`*^9, 
   3.599507638819203*^9}, {3.599507881933751*^9, 3.599507885233979*^9}, {
   3.599534749765068*^9, 3.599534750114675*^9}, {3.5995350980168467`*^9, 
   3.5995350999497023`*^9}, {3.599535154746531*^9, 3.599535155129476*^9}, {
   3.599535262505883*^9, 3.599535265272493*^9}, {3.5995355093288383`*^9, 
   3.599535509709873*^9}, {3.599536110292823*^9, 3.599536112249158*^9}, {
   3.5995658033335857`*^9, 3.599565803537602*^9}, {3.5995658892530813`*^9, 
   3.599565889657936*^9}, {3.599565946467327*^9, 3.599565946616653*^9}, {
   3.599566038773074*^9, 3.5995660417546673`*^9}, {3.599566156114851*^9, 
   3.5995661567044363`*^9}, {3.5995662993014*^9, 3.599566303075108*^9}, {
   3.599566364806539*^9, 3.5995663652202044`*^9}, {3.599609273336576*^9, 
   3.599609277634501*^9}, {3.599609587090808*^9, 3.599609587665007*^9}, {
   3.5996105091998987`*^9, 3.599610510070266*^9}, {3.59961059220621*^9, 
   3.599610592332727*^9}, {3.5996115260921717`*^9, 3.599611526389817*^9}, {
   3.599611577521243*^9, 3.599611577807928*^9}, {3.599612260273711*^9, 
   3.599612260355033*^9}, {3.599613190832745*^9, 3.599613191071807*^9}, {
   3.601164216332103*^9, 3.6011642164817123`*^9}, {3.601216062541676*^9, 
   3.6012160626417723`*^9}, {3.601216139126848*^9, 3.6012161394257307`*^9}, {
   3.601216170252406*^9, 3.601216170586789*^9}, {3.601218120531151*^9, 
   3.6012181206289062`*^9}, {3.601223055030878*^9, 3.601223055150992*^9}, {
   3.60122313882451*^9, 3.6012231391049*^9}, {3.601223198731658*^9, 
   3.601223198990584*^9}, {3.601254541956728*^9, 3.601254542078312*^9}, {
   3.601258735594644*^9, 3.6012587357609787`*^9}, {3.601258768054356*^9, 
   3.6012587681898613`*^9}, {3.601258907191723*^9, 3.601258924107998*^9}, {
   3.6012604838666487`*^9, 3.601260529343573*^9}, {3.601260716520987*^9, 
   3.6012607167806396`*^9}, {3.6013060562929373`*^9, 
   3.6013060563500433`*^9}, {3.601313962764597*^9, 3.601313962904044*^9}, {
   3.601314102734536*^9, 3.601314131146887*^9}, {3.601314449041271*^9, 
   3.60131444909792*^9}, {3.601314499766078*^9, 3.601314500235099*^9}, {
   3.601314576932282*^9, 3.601314577178849*^9}, {3.601314835486417*^9, 
   3.6013148358851233`*^9}, {3.601314950249399*^9, 3.601314950369753*^9}, {
   3.6013149966034403`*^9, 3.601314996722376*^9}, {3.601318053186184*^9, 
   3.601318053265315*^9}, {3.601318113000949*^9, 3.60131811367134*^9}, {
   3.601318157205865*^9, 3.6013181582015123`*^9}, {3.601318836468665*^9, 
   3.601318836602839*^9}, {3.601333858957696*^9, 3.60133385905669*^9}, {
   3.6013436349884443`*^9, 3.601343635138365*^9}, {3.6013440324035673`*^9, 
   3.601344032577557*^9}, {3.60134416837059*^9, 3.6013441699828978`*^9}, {
   3.601344301651607*^9, 3.60134430394557*^9}, {3.602946324518615*^9, 
   3.6029463281041727`*^9}, {3.6029467713601227`*^9, 
   3.6029467714196873`*^9}, {3.602946866735053*^9, 3.6029468673236*^9}, {
   3.60294692660296*^9, 3.602946927593165*^9}, {3.602947042789485*^9, 
   3.6029470428461313`*^9}, {3.6029471096103086`*^9, 3.602947109668874*^9}, {
   3.602947166986754*^9, 3.6029471672732573`*^9}, {3.6029472420742817`*^9, 
   3.60294724234965*^9}, {3.60624947415985*^9, 3.606249527926815*^9}, {
   3.60659430986165*^9, 3.606594309969829*^9}, {3.606667241127901*^9, 
   3.606667241235002*^9}, {3.607113651812992*^9, 3.607113652675715*^9}, {
   3.6115076115275*^9, 3.611507612122923*^9}, {3.617245423807603*^9, 
   3.6172454277808313`*^9}, {3.6172802741494083`*^9, 3.6172802742976*^9}, {
   3.617280515521491*^9, 3.617280516246237*^9}, {3.617280716561037*^9, 
   3.617280716849155*^9}, {3.627139088160844*^9, 3.6271390882796097`*^9}, {
   3.627141773329101*^9, 3.627141773890051*^9}, {3.62714194454291*^9, 
   3.627141947017618*^9}, {3.627142168958811*^9, 3.627142169555503*^9}, {
   3.627142261299181*^9, 3.627142264025758*^9}, {3.627142561809861*^9, 
   3.627142562412429*^9}, {3.62714263384624*^9, 3.627142637477028*^9}, {
   3.627143568055139*^9, 3.62714356855364*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.572699950661583*^9, 3.5726999534673367`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.450268464627475*^9, 3.450268482415883*^9}, 
   3.5995091665479517`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", "\"\<..\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.450268464627475*^9, 3.450268482415883*^9}, {
   3.594592076804743*^9, 3.594592099609638*^9}, {3.594592153797632*^9, 
   3.5945921573532867`*^9}, 3.599509167464217*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "9"}], ";"}]], "Input",
 CellChangeTimes->{{3.572699270174024*^9, 3.572699271429542*^9}, {
   3.575961569986661*^9, 3.575961570539464*^9}, 3.5945796381639338`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"names", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<USACanada\>\"", ",", "\"\<SouthAmerica\>\"", ",", "\"\<Europe\>\"", 
     ",", "\"\<India\>\"", ",", "\"\<NorthChina\>\"", ",", 
     "\"\<SouthChina\>\"", ",", "\"\<JapanKorea\>\"", ",", 
     "\"\<SoutheastAsia\>\"", ",", "\"\<Oceania\>\""}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.572699384677044*^9, 3.572699399416445*^9}, {
  3.5726995698442574`*^9, 3.572699588349374*^9}, {3.572699831487899*^9, 
  3.5726998850013657`*^9}, {3.572702495932197*^9, 3.572702497942725*^9}, {
  3.575961572763401*^9, 3.575961582235628*^9}, {3.594579640756822*^9, 
  3.594579660655793*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fullNameRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<USA & Canada\>\""}], ",", 
     RowBox[{"\"\<JapanKorea\>\"", "\[Rule]", "\"\<Japan & Korea\>\""}], ",", 
     
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<South America\>\""}], 
     ",", 
     RowBox[{"\"\<SoutheastAsia\>\"", "\[Rule]", "\"\<Southeast Asia\>\""}], 
     ",", 
     RowBox[{"\"\<NorthChina\>\"", "\[Rule]", "\"\<North China\>\""}], ",", 
     RowBox[{"\"\<SouthChina\>\"", "\[Rule]", "\"\<South China\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572699403878302*^9, 3.572699526305357*^9}, {
  3.5726995824531813`*^9, 3.5726995841722403`*^9}, {3.5727025035259867`*^9, 
  3.5727025043406143`*^9}, {3.57596158837574*^9, 3.5759616200132217`*^9}, {
  3.594579666409408*^9, 3.594579693304901*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"shortNameRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<US/Can\>\""}], ",", 
     RowBox[{"\"\<JapanKorea\>\"", "\[Rule]", "\"\<Japan/Korea\>\""}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<S America\>\""}], ",", 
     RowBox[{"\"\<SoutheastAsia\>\"", "\[Rule]", "\"\<SE Asia\>\""}], ",", 
     RowBox[{"\"\<NorthChina\>\"", "\[Rule]", "\"\<N China\>\""}], ",", 
     RowBox[{"\"\<SouthChina\>\"", "\[Rule]", "\"\<S China\>\""}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.572699403878302*^9, 3.572699526305357*^9}, {
   3.5726995824531813`*^9, 3.5726995841722403`*^9}, {3.5727025035259867`*^9, 
   3.5727025043406143`*^9}, {3.57596158837574*^9, 3.5759616200132217`*^9}, {
   3.594579666409408*^9, 3.594579693304901*^9}, {3.60667548871555*^9, 
   3.606675539841062*^9}, 3.606675780316331*^9, {3.611507376569806*^9, 
   3.611507411171872*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"drop", "=", "200"}], ";", 
  RowBox[{"skip", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.572700074548641*^9, 3.572700109286785*^9}, {
   3.572759840405512*^9, 3.572759840928012*^9}, 3.573284842822003*^9, {
   3.573289155443012*^9, 3.57328915560286*^9}, {3.575961727657583*^9, 
   3.57596172775959*^9}, {3.575961768283881*^9, 3.575961768800084*^9}, {
   3.599507031155808*^9, 3.599507031206765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"type", "=", 
   RowBox[{
    RowBox[{"First", "[", 
     RowBox[{"StringSplit", "[", 
      RowBox[{"stem", ",", "\"\<_\>\""}], "]"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\"\<h3\>\"", "\[Rule]", "\"\<A/H3N2\>\""}], ",", 
      RowBox[{"\"\<h1\>\"", "\[Rule]", "\"\<A/H1N1\>\""}], ",", 
      RowBox[{"\"\<vic\>\"", "\[Rule]", "\"\<B/Vic\>\""}], ",", 
      RowBox[{"\"\<yam\>\"", "\[Rule]", "\"\<B/Yam\>\""}]}], "}"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.599509071341124*^9, 3.5995091635097523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"figureStem", "=", 
   RowBox[{"stem", "<>", "\"\</figures/\>\"", "<>", "stem"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5995092691382627`*^9, 3.5995093415787973`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"statStem", "=", 
   RowBox[{"stem", "<>", "\"\</stats/\>\"", "<>", "stem"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.5995092691382627`*^9, 3.5995092955367193`*^9}, {
  3.599509328474626*^9, 3.599509342404351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageResolution", "=", "300"}], ";"}]], "Input",
 CellChangeTimes->{{3.599532461486434*^9, 3.5995324658658323`*^9}, {
  3.5995327937997828`*^9, 3.599532794243514*^9}, {3.6062494227046967`*^9, 
  3.6062494232070007`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Section",
 CellChangeTimes->{{3.572699966021636*^9, 3.5726999927894087`*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Subsection",
 CellChangeTimes->{{3.57270014415388*^9, 3.572700144939843*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gappedPartition", "[", 
   RowBox[{"list_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{"list", ",", "n", ",", "n", ",", "1", ",", "\"\<\>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5225819720646067`*^9, 3.5225820012836437`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"numberToString", "[", "num_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Negative", "[", "num", "]"}], ",", 
    RowBox[{"\"\<\[Hyphen]\>\"", "<>", 
     RowBox[{"StringDrop", "[", 
      RowBox[{
       RowBox[{"ToString", "[", "num", "]"}], ",", "1"}], "]"}]}], ",", 
    RowBox[{"ToString", "[", "num", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5430344165992928`*^9, 3.5430345495743723`*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "frameTicks", "]"}]], "Input",
 CellChangeTimes->{{3.602946336653007*^9, 3.6029463387940474`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", 
   RowBox[{
   "xMin_", ",", "xMax_", ",", "yMin_", ",", "yMax_", ",", "xTicksStep_", ",",
     "yTicksStep_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"numberToString", "[", "i", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Floor", "[", 
           RowBox[{"yMin", ",", "yTicksStep"}], "]"}], ",", " ", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"yMax", ",", "yTicksStep"}], "]"}], ",", " ", 
          "yTicksStep"}], "}"}]}], "]"}], ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"numberToString", "[", "i", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Floor", "[", 
           RowBox[{"xMin", ",", "xTicksStep"}], "]"}], ",", " ", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"xMax", ",", "xTicksStep"}], "]"}], ",", " ", 
          "xTicksStep"}], "}"}]}], "]"}], ",", " ", "None"}], "}"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", 
   RowBox[{"yMin_", ",", "yMax_", ",", "yTicksStep_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"numberToString", "[", "i", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"Floor", "[", 
           RowBox[{"yMin", ",", "yTicksStep"}], "]"}], ",", " ", 
          RowBox[{"Ceiling", "[", 
           RowBox[{"yMax", ",", "yTicksStep"}], "]"}], ",", " ", 
          "yTicksStep"}], "}"}]}], "]"}], ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}, {3.572702750711907*^9, 
   3.572702767334564*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Options", "Subsection",
 CellChangeTimes->{{3.572700147472583*^9, 3.572700148080296*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Plot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.504470375409577*^9, 3.504470378639552*^9}, 
   3.5046382745465508`*^9, {3.5086770546065187`*^9, 3.508677055213378*^9}, {
   3.523603114165864*^9, 3.523603114563428*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLinePlot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4676602373716383`*^9, 3.467660260071209*^9}, {
   3.4676603868729563`*^9, 3.4676603996017923`*^9}, {3.468167564012947*^9, 
   3.468167564307066*^9}, {3.4701541012773438`*^9, 3.470154101470192*^9}, {
   3.471811539978726*^9, 3.471811540439839*^9}, 3.471884326923695*^9, {
   3.4718844561368303`*^9, 3.471884456315078*^9}, {3.471884922329157*^9, 
   3.471884925971725*^9}, {3.4844919835664377`*^9, 3.484491984975415*^9}, {
   3.504455919380142*^9, 3.504455928059474*^9}, {3.504456022006899*^9, 
   3.504456044453619*^9}, 3.504638277036727*^9, {3.508677052302403*^9, 
   3.5086770529013157`*^9}, 3.523603117365076*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"RegionPlot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4676602373716383`*^9, 3.467660260071209*^9}, {
   3.4676603868729563`*^9, 3.4676603996017923`*^9}, {3.468167564012947*^9, 
   3.468167564307066*^9}, {3.4701541012773438`*^9, 3.470154101470192*^9}, {
   3.471811539978726*^9, 3.471811540439839*^9}, 3.471884326923695*^9, {
   3.4718844561368303`*^9, 3.471884456315078*^9}, {3.471884922329157*^9, 
   3.471884925971725*^9}, {3.4844919835664377`*^9, 3.484491984975415*^9}, {
   3.504455919380142*^9, 3.504455928059474*^9}, {3.504456022006899*^9, 
   3.504456044453619*^9}, 3.504638277036727*^9, {3.508677052302403*^9, 
   3.5086770529013157`*^9}, 3.523603117365076*^9, {3.54124037091967*^9, 
   3.541240374050376*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListPlot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4676602373716383`*^9, 3.467660260071209*^9}, {
   3.4676603868729563`*^9, 3.4676603996017923`*^9}, {3.467666324969969*^9, 
   3.467666327447343*^9}, {3.4681675688840017`*^9, 3.468167569091207*^9}, {
   3.4701541044607487`*^9, 3.470154104582665*^9}, {3.471811541842801*^9, 
   3.4718115421142673`*^9}, 3.471884325355791*^9, {3.4718844539289913`*^9, 
   3.471884454138794*^9}, {3.471884928282701*^9, 3.4718849302837057`*^9}, {
   3.4844919871388206`*^9, 3.484491988218148*^9}, {3.5044559220217447`*^9, 
   3.5044559327429028`*^9}, {3.504456028977055*^9, 3.504456047312049*^9}, 
   3.5046382805583897`*^9, {3.508677049640526*^9, 3.5086770502929773`*^9}, 
   3.5236031182701073`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListLogPlot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4676602373716383`*^9, 3.467660260071209*^9}, {
   3.4676603868729563`*^9, 3.4676603996017923`*^9}, {3.467666324969969*^9, 
   3.467666327447343*^9}, {3.4681675688840017`*^9, 3.468167569091207*^9}, {
   3.4681744722314787`*^9, 3.4681744743657312`*^9}, {3.470154106540081*^9, 
   3.470154106629767*^9}, {3.471811543818861*^9, 3.471811544058243*^9}, {
   3.471884323692552*^9, 3.471884341906563*^9}, {3.4718849326540003`*^9, 
   3.471884934412127*^9}, {3.484491990354877*^9, 3.484491991434237*^9}, {
   3.504455923179418*^9, 3.50445593508741*^9}, {3.504456031512616*^9, 
   3.504456050047752*^9}, 3.504638282900895*^9, {3.5086770468704*^9, 
   3.50867704744444*^9}, 3.523603119382763*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ListContourPlot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4676602373716383`*^9, 3.467660260071209*^9}, {
   3.4676603868729563`*^9, 3.4676603996017923`*^9}, {3.467666324969969*^9, 
   3.467666327447343*^9}, {3.4681675688840017`*^9, 3.468167569091207*^9}, {
   3.4681744722314787`*^9, 3.4681744743657312`*^9}, {3.470154106540081*^9, 
   3.470154106629767*^9}, {3.471811543818861*^9, 3.471811544058243*^9}, {
   3.471884323692552*^9, 3.471884341906563*^9}, {3.4718849326540003`*^9, 
   3.471884934412127*^9}, {3.484491990354877*^9, 3.484491991434237*^9}, {
   3.504455923179418*^9, 3.50445593508741*^9}, {3.504456031512616*^9, 
   3.504456050047752*^9}, 3.504638282900895*^9, {3.5070456496060743`*^9, 
   3.5070456626651278`*^9}, {3.508677044269836*^9, 3.508677044916758*^9}, 
   3.523603120389209*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ContourPlot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4676602373716383`*^9, 3.467660260071209*^9}, {
   3.4676603868729563`*^9, 3.4676603996017923`*^9}, {3.467666324969969*^9, 
   3.467666327447343*^9}, {3.4681675688840017`*^9, 3.468167569091207*^9}, {
   3.4681744722314787`*^9, 3.4681744743657312`*^9}, {3.470154106540081*^9, 
   3.470154106629767*^9}, {3.471811543818861*^9, 3.471811544058243*^9}, {
   3.471884323692552*^9, 3.471884341906563*^9}, {3.4718849326540003`*^9, 
   3.471884934412127*^9}, {3.484491990354877*^9, 3.484491991434237*^9}, {
   3.504455923179418*^9, 3.50445593508741*^9}, {3.504456031512616*^9, 
   3.504456050047752*^9}, 3.504638282900895*^9, {3.5070456496060743`*^9, 
   3.5070456626651278`*^9}, {3.507119309814056*^9, 3.5071193120105867`*^9}, {
   3.508677041485755*^9, 3.508677042170229*^9}, 3.523603122184651*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"DiscretePlot", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4676602373716383`*^9, 3.467660260071209*^9}, {
   3.4676603868729563`*^9, 3.4676603996017923`*^9}, {3.467666324969969*^9, 
   3.467666327447343*^9}, {3.4681675688840017`*^9, 3.468167569091207*^9}, {
   3.4681744722314787`*^9, 3.4681744743657312`*^9}, {3.470154106540081*^9, 
   3.470154106629767*^9}, {3.471811543818861*^9, 3.471811544058243*^9}, {
   3.471884323692552*^9, 3.471884341906563*^9}, {3.4718849326540003`*^9, 
   3.471884934412127*^9}, {3.484491990354877*^9, 3.484491991434237*^9}, {
   3.504455923179418*^9, 3.50445593508741*^9}, {3.504456031512616*^9, 
   3.504456050047752*^9}, 3.504638282900895*^9, {3.506962511102281*^9, 
   3.506962515043408*^9}, {3.508677037261856*^9, 3.508677037853074*^9}, 
   3.523603123165823*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Graphics", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", "False"}], ",", 
    RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.471884272048812*^9, 3.471884277231666*^9}, {
   3.4718843092898293`*^9, 3.471884335729241*^9}, {3.4718849366355886`*^9, 
   3.471884938755726*^9}, {3.471884975849451*^9, 3.47188498330054*^9}, {
   3.48449199373929*^9, 3.4844919948265457`*^9}, {3.493398493086906*^9, 
   3.493398493683886*^9}, {3.504455924227942*^9, 3.504455935951573*^9}, {
   3.504456035903509*^9, 3.504456052616499*^9}, 3.504638285732658*^9, {
   3.5086770350051107`*^9, 3.508677035604743*^9}, 3.523603124126172*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"Histogram", ",", 
    RowBox[{"LabelStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}], ",", 
    RowBox[{"ChartBaseStyle", "\[Rule]", 
     RowBox[{"EdgeForm", "[", "Thin", "]"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.505841184981737*^9, 3.5058412211429787`*^9}, {
   3.5086770248715887`*^9, 3.5086770284853563`*^9}, {3.522060369921104*^9, 
   3.52206037046496*^9}, 3.5236031263200083`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"SmoothDensityHistogram", ",", 
    RowBox[{"FrameStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], ",", 
    RowBox[{"Axes", "\[Rule]", "False"}], ",", 
    RowBox[{"Frame", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], ",", 
    RowBox[{"FrameTicksStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"FrameStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "All"}], "}"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.505841184981737*^9, 3.5058412211429787`*^9}, {
   3.506442685653002*^9, 3.506442711198154*^9}, {3.506442751824505*^9, 
   3.5064427540873013`*^9}, {3.508677031525243*^9, 3.5086770324986258`*^9}, 
   3.523603128493544*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ArrayPlot", ",", 
    RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
    RowBox[{"Frame", "\[Rule]", "False"}], ",", 
    RowBox[{"Mesh", "\[Rule]", "True"}], ",", 
    RowBox[{"MeshStyle", "\[Rule]", "Thin"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.523701673254911*^9, 3.523701710436368*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Colors", "Section",
 CellChangeTimes->{{3.5637026239618883`*^9, 3.563702624598942*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rgbRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<Oceania\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.557", ",", "0.085", ",", "0.086"}], "}"}]}], ",", 
     RowBox[{"\"\<SoutheastAsia\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.559", ",", "0.743", ",", "0.814"}], "}"}]}], ",", 
     RowBox[{"\"\<SouthChina\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.656", ",", "0.421", ",", "0.693"}], "}"}]}], ",", 
     RowBox[{"\"\<India\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.921", ",", "0.657", ",", "0.371"}], "}"}]}], ",", 
     RowBox[{"\"\<NorthChina\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.628", ",", "0.800", ",", "0.646"}], "}"}]}], ",", 
     RowBox[{"\"\<JapanKorea\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.166", ",", "0.277", ",", "0.526"}], "}"}]}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.572", ",", "0.384", ",", "0.141"}], "}"}]}], ",", 
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.840", ",", "0.774", ",", "0.407"}], "}"}]}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.395", ",", "0.516", ",", "0.278"}], "}"}]}], ",", 
     RowBox[{"\"\<China\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.642", ",", "0.611", ",", "0.670"}], "}"}]}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.563702973774851*^9, 3.563703210153569*^9}, {
   3.563703251074592*^9, 3.563703339824286*^9}, {3.563703399539124*^9, 
   3.563703483092354*^9}, {3.564830591807249*^9, 3.564830613003511*^9}, {
   3.5648306534733257`*^9, 3.564830656627075*^9}, {3.564830753989819*^9, 
   3.564830763507556*^9}, {3.5648312072878017`*^9, 3.564831248568795*^9}, {
   3.572699280817813*^9, 3.572699287472753*^9}, {3.594579756477339*^9, 
   3.594579757105897*^9}, 3.594579796853631*^9, 3.594579838401368*^9, {
   3.594579889665291*^9, 3.594579915870203*^9}, {3.626648309625814*^9, 
   3.62664831665771*^9}, {3.626648437899933*^9, 3.626648451606011*^9}, {
   3.626648511839307*^9, 3.626648518380702*^9}, 3.626648566860611*^9, {
   3.626648606216683*^9, 3.6266486120306253`*^9}, {3.626707342351037*^9, 
   3.6267073493786488`*^9}, {3.626707420252123*^9, 3.626707425930458*^9}, {
   3.6267077757984667`*^9, 3.626707777972597*^9}, {3.6267078686214743`*^9, 
   3.626707876387309*^9}, {3.626708482677506*^9, 3.626708489923243*^9}, {
   3.626708522916834*^9, 3.626708530874954*^9}, {3.626708589037422*^9, 
   3.626708595683661*^9}, {3.626708858904509*^9, 3.626708866619915*^9}, {
   3.626709195589353*^9, 3.626709202570347*^9}, {3.6267096509207973`*^9, 
   3.626709658862883*^9}, 3.626709926238546*^9, {3.626710151899805*^9, 
   3.626710165801746*^9}, {3.626710227273473*^9, 3.626710231969018*^9}, {
   3.626710322549559*^9, 3.6267103315162897`*^9}, {3.626715199056719*^9, 
   3.626715226716427*^9}, {3.626715339017693*^9, 3.626715350977013*^9}, {
   3.626715935688057*^9, 3.6267159529540167`*^9}, {3.6267160559597673`*^9, 
   3.6267160668576736`*^9}, {3.6267164960917807`*^9, 3.626716527616886*^9}, {
   3.626716605560878*^9, 3.626716614077927*^9}, {3.62671671528955*^9, 
   3.6267167262934227`*^9}, 3.6306860068009987`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorRules", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
       RowBox[{"RGBColor", "[", 
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "rgbRules"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5726995211332903`*^9, 3.572699555634791*^9}, {
  3.573625776496723*^9, 3.5736257952564173`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"colorList", "=", 
   RowBox[{"names", "/.", "colorRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572702333682968*^9, 3.572702344135672*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"legend", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PointSize", "[", "0.075", "]"}], ",", 
       RowBox[{"MapIndexed", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#1", "/.", "colorRules"}], ",", 
            RowBox[{"Point", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"#2", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], "]"}], ",",
             "Black", ",", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"#1", "/.", "fullNameRules"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"#2", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
                "Black"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "names"}], 
        "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.05"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "1000"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.506853399636057*^9, 3.506853421978413*^9}, {
   3.506853686838426*^9, 3.506853691724464*^9}, {3.5414430342516127`*^9, 
   3.541443091722629*^9}, {3.551123265276415*^9, 3.551123269108185*^9}, 
   3.563702663852314*^9, {3.563702777746853*^9, 3.563702781000704*^9}, {
   3.5637029001249933`*^9, 3.563702939271389*^9}, {3.57269932739065*^9, 
   3.572699380580049*^9}, {3.5726995662290077`*^9, 3.5726995670811167`*^9}, {
   3.5726995977585287`*^9, 3.572699611794368*^9}, {3.572699656575276*^9, 
   3.572699821205635*^9}, {3.5726998991636353`*^9, 3.572699900834217*^9}, {
   3.572702528319632*^9, 3.572702534188805*^9}, {3.575811426469593*^9, 
   3.575811558018898*^9}, 3.5995336724029512`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lat & Long", "Section",
 CellChangeTimes->{{3.57271682050661*^9, 3.57271682321067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"map", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"EdgeForm", "[", "White", "]"}], ",", 
        RowBox[{"RGBColor", "[", 
         RowBox[{"0.896", ",", "0.8878", ",", "0.8548"}], "]"}], ",", 
        RowBox[{
         RowBox[{"CountryData", "[", 
          RowBox[{"\"\<World\>\"", ",", "\"\<SchematicPolygon\>\""}], "]"}], "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "-", "360"}], ",", "y"}], "}"}]}]}], ",", 
        RowBox[{
         RowBox[{"CountryData", "[", 
          RowBox[{"\"\<World\>\"", ",", "\"\<SchematicPolygon\>\""}], "]"}], "/.", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x_", ",", "y_"}], "}"}], ":>", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"360", "+", "x"}], ",", "y"}], "}"}]}]}], ",", 
        RowBox[{"CountryData", "[", 
         RowBox[{"\"\<World\>\"", ",", "\"\<SchematicPolygon\>\""}], "]"}]}], 
       "}"}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "170"}], ",", "190"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "55"}], ",", "75"}], "}"}]}], "}"}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.448734898554577*^9, 3.448734963492844*^9}, {
   3.448735000851989*^9, 3.448735088853664*^9}, {3.448735132359168*^9, 
   3.448735204552092*^9}, {3.448735260819229*^9, 3.448735357098737*^9}, {
   3.448735670139338*^9, 3.448735679905459*^9}, {3.448735910040505*^9, 
   3.448735913142179*^9}, {3.448888440970923*^9, 3.448888441098311*^9}, {
   3.4488888137985888`*^9, 3.448888848808506*^9}, {3.448888984804592*^9, 
   3.448889015747676*^9}, {3.4488890674849653`*^9, 3.448889090262648*^9}, {
   3.448889374021203*^9, 3.4488893745944653`*^9}, {3.4488897254368687`*^9, 
   3.448889734977436*^9}, 3.44888979654709*^9, {3.448889844011694*^9, 
   3.448889893783503*^9}, {3.448889932247267*^9, 3.4488900059995003`*^9}, {
   3.448890040602106*^9, 3.448890044232819*^9}, {3.448890116211753*^9, 
   3.448890118283774*^9}, {3.4488901505321302`*^9, 3.4488902837493973`*^9}, {
   3.448895341491722*^9, 3.4488953525653353`*^9}, {3.4488955457946253`*^9, 
   3.448895568810416*^9}, {3.44889562120373*^9, 3.448895621562683*^9}, {
   3.449332831294854*^9, 3.449332835034033*^9}, {3.449332961269773*^9, 
   3.449332961700656*^9}, {3.449335788099471*^9, 3.449335788423851*^9}, {
   3.452510926526093*^9, 3.4525109269470987`*^9}, {3.4534707654614697`*^9, 
   3.4534708682964478`*^9}, {3.4534796264119873`*^9, 3.453479634680635*^9}, {
   3.453553976680546*^9, 3.4535539953657017`*^9}, {3.4538317634618797`*^9, 
   3.453831776914043*^9}, {3.458476200043675*^9, 3.4584762005273952`*^9}, {
   3.459001984014373*^9, 3.45900198540945*^9}, {3.466439572069747*^9, 
   3.4664395792050323`*^9}, {3.4664401119396343`*^9, 3.466440112567174*^9}, {
   3.572722386133217*^9, 3.5727223880981827`*^9}, {3.572773089712934*^9, 
   3.572773182486107*^9}, {3.572774571085437*^9, 3.572774685380909*^9}, {
   3.5727765427955837`*^9, 3.572776542995502*^9}, {3.5727765899671907`*^9, 
   3.572776590198497*^9}, {3.6066609010272503`*^9, 3.606660901390965*^9}},
 CellID->1143417716],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapCoordRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "100"}], ",", "40"}], "}"}]}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "55"}], ",", 
        RowBox[{"-", "10"}]}], "}"}]}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"9", ",", "51"}], "}"}]}], ",", 
     RowBox[{"\"\<India\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"77", ",", "20"}], "}"}]}], ",", 
     RowBox[{"\"\<NorthChina\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"109", ",", "38"}], "}"}]}], ",", 
     RowBox[{"\"\<SouthChina\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"113", ",", "23"}], "}"}]}], ",", 
     RowBox[{"\"\<JapanKorea\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"138", ",", "36"}], "}"}]}], ",", 
     RowBox[{"\"\<SoutheastAsia\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"104", ",", "1"}], "}"}]}], ",", 
     RowBox[{"\"\<Oceania\>\"", "->", 
      RowBox[{"{", 
       RowBox[{"151", ",", 
        RowBox[{"-", "34"}]}], "}"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.448731934501749*^9, 3.44873195521887*^9}, {
   3.448888450149867*^9, 3.448888484649283*^9}, {3.448888677012669*^9, 
   3.448888699367841*^9}, {3.448888785600292*^9, 3.448888790303423*^9}, {
   3.448889470614107*^9, 3.448889516230603*^9}, 3.448898172994183*^9, {
   3.4489281873303967`*^9, 3.448928187530648*^9}, {3.448932309324601*^9, 
   3.4489323164408007`*^9}, {3.448933088088067*^9, 3.448933127855459*^9}, {
   3.449331488906748*^9, 3.449331491945753*^9}, {3.449335026532839*^9, 
   3.449335029248949*^9}, {3.449335307614686*^9, 3.4493353211827593`*^9}, {
   3.4493368713340883`*^9, 3.449336872914851*^9}, {3.449336938599387*^9, 
   3.449336940804401*^9}, {3.449505468102516*^9, 3.449505470426218*^9}, {
   3.453469865400386*^9, 3.4534698706878366`*^9}, {3.4534704559238777`*^9, 
   3.453470468817437*^9}, {3.4534706671968317`*^9, 3.453470673587414*^9}, {
   3.453599559506887*^9, 3.4535995601072598`*^9}, {3.4537695438046303`*^9, 
   3.453769545488513*^9}, {3.453831352176442*^9, 3.453831352432723*^9}, {
   3.45847605565396*^9, 3.458476064222837*^9}, {3.459254639759801*^9, 
   3.45925464577347*^9}, {3.4595562767125463`*^9, 3.459556277707568*^9}, {
   3.57271682584348*^9, 3.572716826891254*^9}, {3.572716976452202*^9, 
   3.5727170331412783`*^9}, {3.57271708282273*^9, 3.572717216908737*^9}, {
   3.572717280511015*^9, 3.572717290661913*^9}, {3.572721776851611*^9, 
   3.57272186314853*^9}, {3.5727219256506577`*^9, 3.572721939435878*^9}, {
   3.572722039629332*^9, 3.572722040396687*^9}, {3.572774975178499*^9, 
   3.5727749885550413`*^9}, {3.572775100866794*^9, 3.5727751040576572`*^9}, {
   3.5727751800470247`*^9, 3.5727751843361607`*^9}, {3.5727752198344307`*^9, 
   3.572775221257277*^9}, {3.599507008584607*^9, 3.599507015881803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapCoords", "=", 
   RowBox[{"names", "/.", "mapCoordRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572721983330472*^9, 3.5727219959317713`*^9}, 
   3.572722162563509*^9, 3.572722809148851*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"leftMapCoordRules", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"loc", "=", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"long", "=", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"lat", "=", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"long", ">", "100"}], ",", 
          RowBox[{"loc", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"long", "-", "360"}], ",", "lat"}], "}"}]}], ",", 
          RowBox[{"loc", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"long", ",", "lat"}], "}"}]}]}], "]"}]}], "]"}], "&"}], 
     ",", "mapCoordRules"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5727742422445927`*^9, 3.5727743731349707`*^9}, 
   3.57277445174831*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"leftMapCoords", "=", 
   RowBox[{"names", "/.", "leftMapCoordRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572774378066945*^9, 3.572774390354619*^9}, 
   3.572774448674851*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rightMapCoordRules", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"loc", "=", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ",", 
          RowBox[{"long", "=", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"lat", "=", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"long", "<", "0"}], ",", 
          RowBox[{"loc", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"long", "+", "360"}], ",", "lat"}], "}"}]}], ",", 
          RowBox[{"loc", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"long", ",", "lat"}], "}"}]}]}], "]"}]}], "]"}], "&"}], 
     ",", "mapCoordRules"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5727742422445927`*^9, 3.5727743731349707`*^9}, {
  3.57277445174831*^9, 3.5727744600695543`*^9}, {3.572774506624467*^9, 
  3.5727745126407633`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rightMapCoords", "=", 
   RowBox[{"names", "/.", "rightMapCoordRules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572774378066945*^9, 3.572774390354619*^9}, {
  3.572774448674851*^9, 3.572774466244227*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Posterior", "Section",
 CellChangeTimes->{{3.522579330537306*^9, 3.522579335336144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcmc", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"stem", "<>", "\"\</\>\"", "<>", "stem", "<>", "\"\<.log\>\""}], 
     ",", "\"\<Table\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.522579340295617*^9, 3.522579352135378*^9}, {
   3.522652128788019*^9, 3.5226521479787817`*^9}, {3.5227512638646812`*^9, 
   3.522751266799011*^9}, {3.522751986197178*^9, 3.522751988180953*^9}, 
   3.523258910289151*^9, {3.523345067728773*^9, 3.523345070463234*^9}, {
   3.5995078696421413`*^9, 3.5995078749214983`*^9}, {3.599507912819838*^9, 
   3.5995079129807863`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcmc", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{"mcmc", ",", "2"}], "]"}]}], ";", 
  RowBox[{"header", "=", 
   RowBox[{"mcmc", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.522579354660413*^9, 3.522579362854353*^9}, 
   3.523345228733964*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"headerRules", "=", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "->", 
       RowBox[{"#2", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "header"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.522058555107422*^9, 3.5220585659195023`*^9}, {
   3.5225793699333773`*^9, 3.5225793724986553`*^9}, {3.523094426326892*^9, 
   3.523094448735559*^9}, {3.523345169328724*^9, 3.523345170024534*^9}, {
   3.523345234429104*^9, 3.523345237114811*^9}, {3.5233509568875427`*^9, 
   3.5233509669161177`*^9}, 3.572701754498939*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mcmc", "=", 
   RowBox[{"mcmc", "[", 
    RowBox[{"[", 
     RowBox[{"drop", ";;", 
      RowBox[{"-", "1"}], ";;", "skip"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.522654104322351*^9, 3.522654117457795*^9}, {
   3.522751656272767*^9, 3.522751658822713*^9}, 3.5227612709688683`*^9, {
   3.522761622890473*^9, 3.522761623891144*^9}, {3.523094400046721*^9, 
   3.523094400757884*^9}, {3.52334525938721*^9, 3.5233452700752172`*^9}, {
   3.523345333995352*^9, 3.523345337131072*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tracePlot", "[", "name_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "index", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"index", "=", 
      RowBox[{"name", "/.", "headerRules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumberQ", "[", "index", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"mcmc", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "index"}], "]"}], "]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Gray"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.55"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<MCMC sample\>\"", ",", 
            RowBox[{"header", "[", 
             RowBox[{"[", "index", "]"}], "]"}]}], "}"}]}], ",", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"50", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"30", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.541159775836277*^9, 3.5411599245376377`*^9}, {
  3.5411599548975077`*^9, 3.541159983351654*^9}, {3.541166066182725*^9, 
  3.541166122462722*^9}, {3.5411772099076223`*^9, 3.541177210123169*^9}, {
  3.541177291662283*^9, 3.541177311315609*^9}, {3.5727002537474203`*^9, 
  3.57270025460411*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"traceMean", "[", "name_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "index", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"index", "=", 
      RowBox[{"name", "/.", "headerRules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumberQ", "[", "index", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Mean", "[", 
        RowBox[{"mcmc", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "index"}], "]"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.541159775836277*^9, 3.5411599245376377`*^9}, {
  3.5411599548975077`*^9, 3.541159983351654*^9}, {3.541166066182725*^9, 
  3.541166122462722*^9}, {3.5411772099076223`*^9, 3.541177210123169*^9}, {
  3.541177291662283*^9, 3.541177311315609*^9}, {3.5411806834509697`*^9, 
  3.54118069847473*^9}, {3.5727002565389547`*^9, 3.572700257235359*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"traceLast", "[", "name_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "index", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"index", "=", 
      RowBox[{"name", "/.", "headerRules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumberQ", "[", "index", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Last", "[", 
        RowBox[{"mcmc", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "index"}], "]"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.541159775836277*^9, 3.5411599245376377`*^9}, {
  3.5411599548975077`*^9, 3.541159983351654*^9}, {3.541166066182725*^9, 
  3.541166122462722*^9}, {3.5411772099076223`*^9, 3.541177210123169*^9}, {
  3.541177291662283*^9, 3.541177311315609*^9}, {3.5411806834509697`*^9, 
  3.54118069847473*^9}, {3.5577440178237753`*^9, 3.557744024559724*^9}, {
  3.57270025930044*^9, 3.572700260053012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"traceQuartiles", "[", "name_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "index", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"index", "=", 
      RowBox[{"name", "/.", "headerRules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumberQ", "[", "index", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Quartiles", "[", 
        RowBox[{"mcmc", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "index"}], "]"}], "]"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.542631533002524*^9, 3.54263153759501*^9}, {
  3.572700261947196*^9, 3.572700262652116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"traceCI", "[", "name_String", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "index", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"index", "=", 
      RowBox[{"name", "/.", "headerRules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"NumberQ", "[", "index", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"mcmc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "index"}], "]"}], "]"}], ",", "0.025"}], 
          "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"mcmc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "index"}], "]"}], "]"}], ",", "0.25"}], 
          "]"}], ",", 
         RowBox[{"Median", "[", 
          RowBox[{"mcmc", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "index"}], "]"}], "]"}], "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"mcmc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "index"}], "]"}], "]"}], ",", "0.75"}], 
          "]"}], ",", 
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"mcmc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "index"}], "]"}], "]"}], ",", "0.975"}], 
          "]"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.542631533002524*^9, 3.54263153759501*^9}, {
  3.5429617137702503`*^9, 3.542961771281238*^9}, {3.559021247651555*^9, 
  3.559021256037712*^9}, {3.572700265511053*^9, 3.572700266309099*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tracePlot", "[", "\"\<posterior\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.572700173204108*^9, 3.572700207216261*^9}, 
   3.599508653975748*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tracePlot", "[", "\"\<geoSiteModel.mu\>\"", "]"}], ";"}]], "Input",\

 CellChangeTimes->{{3.572700173204108*^9, 3.572700216862866*^9}, 
   3.599508662166484*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"statistics", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Prepend", "[", 
       RowBox[{
        RowBox[{"Round", "[", 
         RowBox[{
          RowBox[{"traceCI", "[", "#", "]"}], ",", "0.001"}], "]"}], ",", 
        "#"}], "]"}], "&"}], ",", 
     RowBox[{"{", "\"\<geoSiteModel.mu\>\"", "}"}]}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.559021427322077*^9, 3.5590214583269653`*^9}, 
   3.5590215653614407`*^9, {3.559022669243671*^9, 3.5590226739055967`*^9}, {
   3.559022908901277*^9, 3.559022914382407*^9}, 3.5590230181615677`*^9, {
   3.566909992811447*^9, 3.5669100066781178`*^9}, {3.572700763034567*^9, 
   3.57270078711158*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"statistics", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"statistics", ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<name\>\"", ",", "\"\<2.5%\>\"", ",", "\"\<25%\>\"", ",", 
       "\"\<50%\>\"", ",", "\"\<75%\>\"", ",", "\"\<97.5%\>\""}], "}"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5590214741283703`*^9, 3.5590215595464478`*^9}, 
   3.599508667397093*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tree", "Section",
 CellChangeTimes->{{3.456071091393384*^9, 3.456071091919424*^9}, {
   3.457280446142313*^9, 3.457280447923895*^9}, {3.4577164928909483`*^9, 
   3.457716495616729*^9}, 3.457977626402193*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"removeTips", "=", 
   RowBox[{"{", "\"\<A/Kunming/1_Va10/2005\>\"", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.607188024196163*^9, 3.607188027618266*^9}, {
  3.607188151896459*^9, 3.607188154875238*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"treePlot", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
      "ids", ",", "drop", ",", "antigenic", ",", "typeLabel", ",", "legend"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
        "ids", ",", "antigenic"}], "}"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"ToExpression", "[", "rules", "]"}]}], ";", 
     RowBox[{"labels", "=", 
      RowBox[{"ToExpression", "[", "labels", "]"}]}], ";", 
     RowBox[{"coords", "=", 
      RowBox[{"ToExpression", "[", "coords", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"labels", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "labels"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ids", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"array", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\<->\>\""}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"array", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"array", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], ",", "ids"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"drop", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"ids", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"removeTips", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tips", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"tips", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", "x"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"rules", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"type", ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"legend", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PointSize", "[", "0.02", "]"}], ",", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "/.", "colorRules"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.01", ",", 
                 RowBox[{"0.97", "-", 
                  RowBox[{"0.037", "*", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], "]"}], "]"}],
              ",", "Black", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"#1", "/.", "fullNameRules"}], ",", 
                 RowBox[{"Scaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.05", ",", 
                    RowBox[{"0.97", "-", 
                    RowBox[{"0.037", "*", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
                 "Black"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "names"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"typeLabel", ",", "legend", ",", 
         RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", "labels"}], "/.", 
               "colorRules"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"coordsA", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "coords"}]}], ",", 
                  RowBox[{"coordsB", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "coords"}]}]}], 
                 "}"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{"coordsA", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coordsB", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"coordsA", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "coordsB"}],
                   "}"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "rules"}], 
          "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "/.", "labels"}], "/.", "colorRules"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Point", "[", 
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coords"}], ")"}], "]"}], ",", 
                RowBox[{"#", "/.", "ids"}]}], "]"}]}], "}"}], "&"}], ",", 
           "tips"}], "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.85"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", "0.03", "]"}], ",", "0"}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
       ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6012600996616993`*^9, 3.6012601872290697`*^9}, {
  3.60126024090471*^9, 3.6012602535988007`*^9}, {3.601260302395293*^9, 
  3.601260302911364*^9}, {3.6012604345679693`*^9, 3.601260434739829*^9}, {
  3.607117793157528*^9, 3.607117817797896*^9}, {3.607123649711425*^9, 
  3.6071236499596977`*^9}, {3.6071881592392178`*^9, 3.6071883868503428`*^9}}],

Cell[CellGroupData[{

Cell["World", "Subsubsection",
 CellChangeTimes->{{3.6029464649341927`*^9, 3.602946467383122*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_all.rules\>\""}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.601260193325478*^9, 3.601260199643749*^9}, {
   3.601260277104423*^9, 3.6012602776285353`*^9}, {3.601260422154879*^9, 
   3.601260422593507*^9}, 3.601260493101454*^9, 3.607113664267852*^9, {
   3.607115630247674*^9, 3.607115630742197*^9}, {3.6071177726247377`*^9, 
   3.607117773029808*^9}, 3.6071238005742683`*^9, 3.607188013392025*^9, 
   3.6071884046408253`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_tree.png\>\""}], ",", " ", "fig", ",", 
    " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_tree.pdf\>\""}], ",", " ", "fig", ",", 
    " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["USA", "Subsubsection",
 CellChangeTimes->{{3.6029464494192553`*^9, 3.602946449581278*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_usa.rules\>\""}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, 
   3.601260497053035*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_usatree.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_usatree.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["South China", "Subsubsection",
 CellChangeTimes->{{3.602946452598565*^9, 3.602946454088318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_schina.rules\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, 
   3.602946525152431*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_schinatree.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, 3.602946526523938*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_schinatree.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, 
   3.602946527514104*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["North China", "Subsubsection",
 CellChangeTimes->{{3.602946471506153*^9, 3.6029464733304977`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_nchina.rules\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, 
   3.602946525152431*^9, {3.602946592625342*^9, 3.602946592757454*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_nchinatree.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, 3.602946526523938*^9, {
   3.602946594416897*^9, 3.602946594528407*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_nchinatree.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, 
   3.602946527514104*^9, {3.6029465962166348`*^9, 3.602946596316566*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["India", "Subsubsection",
 CellChangeTimes->{{3.602946480416415*^9, 3.60294648087805*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_india.rules\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, {
   3.601317971550562*^9, 3.60131797563761*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_indiatree.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, {3.601317978552312*^9, 
   3.6013179805182753`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_indiatree.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, {
   3.601317982844528*^9, 3.601317985919305*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["South America", "Subsubsection",
 CellChangeTimes->{{3.6029464844213753`*^9, 3.602946490936448*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_sa.rules\>\""}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, {
   3.601317988886237*^9, 3.6013179890549917`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_satree.png\>\""}], ",", " ", "fig", ",",
     " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, {3.601317991267437*^9, 
   3.6013179921692047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_satree.pdf\>\""}], ",", " ", "fig", ",",
     " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, {
   3.6013179946897783`*^9, 3.601317995823678*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Southeast Asia", "Subsubsection",
 CellChangeTimes->{{3.602946506314458*^9, 3.602946508095935*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_seasia.rules\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, {
   3.601317988886237*^9, 3.6013179890549917`*^9}, {3.602946513397953*^9, 
   3.6029465143347273`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_seasiatree.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, {3.601317991267437*^9, 
   3.6013179921692047`*^9}, {3.602946516972659*^9, 3.602946517920171*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_seasiatree.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, {
   3.6013179946897783`*^9, 3.601317995823678*^9}, 3.6029465208947697`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Japan and Korea", "Subsubsection",
 CellChangeTimes->{{3.602946506314458*^9, 3.602946508095935*^9}, {
  3.602946602493753*^9, 3.602946605725124*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_jk.rules\>\""}], "]"}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, {
   3.601317988886237*^9, 3.6013179890549917`*^9}, {3.602946513397953*^9, 
   3.6029465143347273`*^9}, {3.6029466076578503`*^9, 3.6029466093765993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_jktree.png\>\""}], ",", " ", "fig", ",",
     " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, {3.601317991267437*^9, 
   3.6013179921692047`*^9}, {3.602946516972659*^9, 3.602946517920171*^9}, {
   3.6029466129280243`*^9, 3.602946614450869*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_jktree.pdf\>\""}], ",", " ", "fig", ",",
     " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, {
   3.6013179946897783`*^9, 3.601317995823678*^9}, 3.6029465208947697`*^9, {
   3.6029466170522013`*^9, 3.602946618585211*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Oceania", "Subsubsection",
 CellChangeTimes->{{3.602946506314458*^9, 3.602946508095935*^9}, {
  3.602946602493753*^9, 3.602946627356986*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_oceania.rules\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, {
   3.601317988886237*^9, 3.6013179890549917`*^9}, {3.602946513397953*^9, 
   3.6029465143347273`*^9}, {3.6029466076578503`*^9, 
   3.6029466093765993`*^9}, {3.6029466446075*^9, 3.602946646677178*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_oceaniatree.png\>\""}], ",", " ", "fig",
     ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, {3.601317991267437*^9, 
   3.6013179921692047`*^9}, {3.602946516972659*^9, 3.602946517920171*^9}, {
   3.6029466129280243`*^9, 3.602946614450869*^9}, {3.6029466498927107`*^9, 
   3.6029466515808563`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_oceaniatree.pdf\>\""}], ",", " ", "fig",
     ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, {
   3.6013179946897783`*^9, 3.601317995823678*^9}, 3.6029465208947697`*^9, {
   3.6029466170522013`*^9, 3.602946618585211*^9}, {3.602946653390634*^9, 
   3.602946655309391*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Europe", "Subsubsection",
 CellChangeTimes->{{3.602946506314458*^9, 3.602946508095935*^9}, {
  3.602946602493753*^9, 3.602946627356986*^9}, {3.602946700704195*^9, 
  3.60294670322044*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"treePlot", "[", 
    RowBox[{"stem", "<>", "\"\</out_europe.rules\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6012602844703817`*^9, 3.601260284996928*^9}, {
   3.601260464092416*^9, 3.6012604645783443`*^9}, 3.601260505660774*^9, {
   3.601317988886237*^9, 3.6013179890549917`*^9}, {3.602946513397953*^9, 
   3.6029465143347273`*^9}, {3.6029466076578503`*^9, 
   3.6029466093765993`*^9}, {3.6029466446075*^9, 3.6029466717166567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_europetree.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.599507845830187*^9, 
   3.599507846682403*^9}, {3.599507944122045*^9, 3.5995079564771338`*^9}, 
   3.5995086851419573`*^9, {3.5995093882168617`*^9, 3.5995093918918867`*^9}, 
   3.5995324990599203`*^9, {3.601247672552443*^9, 3.601247672732448*^9}, {
   3.601260471851213*^9, 3.6012604730240297`*^9}, {3.601317991267437*^9, 
   3.6013179921692047`*^9}, {3.602946516972659*^9, 3.602946517920171*^9}, {
   3.6029466129280243`*^9, 3.602946614450869*^9}, {3.6029466498927107`*^9, 
   3.602946677518609*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_europetree.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.46626590518427*^9, 3.466265911127919*^9}, {
   3.5727012895689993`*^9, 3.572701344746109*^9}, {3.5752653784798183`*^9, 
   3.575265384676196*^9}, {3.599508228743372*^9, 3.599508230618452*^9}, 
   3.599508685923481*^9, 3.599509396104816*^9, {3.601247675444585*^9, 
   3.601247675604589*^9}, {3.601260475342482*^9, 3.6012604764520617`*^9}, {
   3.6013179946897783`*^9, 3.601317995823678*^9}, 3.6029465208947697`*^9, {
   3.6029466170522013`*^9, 3.602946618585211*^9}, {3.602946653390634*^9, 
   3.602946681487525*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trunk ", "Section",
 CellChangeTimes->{{3.458494930766955*^9, 3.458494933124058*^9}, 
   3.466088773182148*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rNames", "=", 
   RowBox[{"Reverse", "[", "names", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.575973291855995*^9, 3.5759732987490463`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rColorList", "=", 
   RowBox[{"Reverse", "[", "colorList", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5759732995458*^9, 3.575973306685088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"start", "=", "2000"}], ";", 
  RowBox[{"stop", "=", "2010"}], ";"}]], "Input",
 CellChangeTimes->{{3.466189842987747*^9, 3.466189849980487*^9}, {
  3.466190053141617*^9, 3.4661900561707706`*^9}, {3.4661903266139317`*^9, 
  3.466190326844545*^9}, {3.4662875611522427`*^9, 3.4662875613250093`*^9}, {
  3.466287666635845*^9, 3.466287666953268*^9}, {3.4662885187310123`*^9, 
  3.466288518891901*^9}, {3.466288594927876*^9, 3.4662885958531933`*^9}, {
  3.4663604836836567`*^9, 3.466360483825536*^9}, {3.466361324878994*^9, 
  3.466361325012239*^9}, {3.572702311520653*^9, 3.572702314797467*^9}, {
  3.573288509439694*^9, 3.5732885096052017`*^9}, {3.5752655739714537`*^9, 
  3.575265574225544*^9}, {3.576217159563472*^9, 3.576217159680114*^9}, {
  3.5762200838710833`*^9, 3.576220085120965*^9}, {3.6012203255297203`*^9, 
  3.6012203262857647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"skls", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"stem", "<>", "\"\</out_trunk.skylines\>\""}], ",", 
     "\"\<Table\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4464892160351543`*^9, 3.446489291306086*^9}, {
   3.4464893293346233`*^9, 3.446489341482953*^9}, {3.44648938391372*^9, 
   3.446489409732457*^9}, {3.446489623570805*^9, 3.4464896578412533`*^9}, {
   3.446489766750271*^9, 3.446489767691557*^9}, 3.446489798260378*^9, 
   3.446489854541531*^9, 3.446489980824048*^9, {3.446491823715356*^9, 
   3.446491827053802*^9}, {3.446491933696455*^9, 3.446491936215694*^9}, {
   3.44689812436197*^9, 3.446898124915516*^9}, {3.446915574435937*^9, 
   3.446915578960082*^9}, {3.450110651706155*^9, 3.4501106527029133`*^9}, {
   3.450812398993968*^9, 3.450812400355904*^9}, {3.4549644715237627`*^9, 
   3.454964474033231*^9}, {3.4557281610547533`*^9, 3.45572816218121*^9}, {
   3.4557430046124983`*^9, 3.4557430084658318`*^9}, {3.456079904829232*^9, 
   3.456079905127595*^9}, {3.457283576981021*^9, 3.457283605026471*^9}, {
   3.457284541639275*^9, 3.457284542368473*^9}, {3.457370913880912*^9, 
   3.457370914653758*^9}, {3.4577165041112747`*^9, 3.457716511081767*^9}, {
   3.457717084474822*^9, 3.4577170924448566`*^9}, {3.4577171401263103`*^9, 
   3.457717143270032*^9}, {3.457734162874511*^9, 3.4577341640945473`*^9}, {
   3.457885897963072*^9, 3.45788589986985*^9}, {3.4579739709561567`*^9, 
   3.457973973784443*^9}, {3.4580626505492563`*^9, 3.4580626584499063`*^9}, {
   3.4584109215857477`*^9, 3.458410928751972*^9}, {3.460740156827441*^9, 
   3.460740158469754*^9}, {3.4660330498192253`*^9, 3.466033050432755*^9}, {
   3.4670423867083406`*^9, 3.467042388479227*^9}, {3.5727023182462263`*^9, 
   3.572702318446003*^9}, {3.572703167214315*^9, 3.5727031678803864`*^9}, {
   3.572722731040547*^9, 3.572722731720385*^9}, {3.572760314428586*^9, 
   3.57276033912077*^9}, {3.601220328590425*^9, 3.601220358501648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"length", "=", 
   RowBox[{"Length", "[", 
    RowBox[{"Select", "[", 
     RowBox[{"skls", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", 
        RowBox[{"\"\<pro_\>\"", "<>", 
         RowBox[{"names", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.46618614777444*^9, 3.4661861589574337`*^9}, 
   3.466186238607768*^9, {3.572702461434145*^9, 3.5727024644566097`*^9}, {
   3.5727026428621883`*^9, 3.572702643271201*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"skltable", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "length", "}"}]}], "]"}], "}"}], ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"list", " ", "=", " ", 
           RowBox[{"Select", "[", 
            RowBox[{"skls", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "==", 
               RowBox[{"\"\<pro_\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}]}], "&"}]}], "]"}]}], 
          "}"}], ",", " ", 
         RowBox[{"list", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", " ", "4"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", "rNames"}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4661768258321247`*^9, 3.466176851022986*^9}, {
   3.466186172602347*^9, 3.466186234018998*^9}, {3.466186784199246*^9, 
   3.466186784468974*^9}, {3.5727024156573753`*^9, 3.5727024221598186`*^9}, {
   3.572702680020433*^9, 3.5727026802614393`*^9}, {3.601220423539524*^9, 
   3.601220423972962*^9}, {3.601221153082505*^9, 3.601221157866049*^9}, 
   3.601221210690535*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"skltable", "=", 
   RowBox[{"Accumulate", "[", "skltable", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4661841611647587`*^9, 3.466184181564443*^9}, 
   3.4661861254611893`*^9, 3.466186180653747*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timelist", "=", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{"skls", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "==", 
        RowBox[{"\"\<pro_\>\"", "<>", 
         RowBox[{"names", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4661842729985867`*^9, 3.466184299271391*^9}, {
  3.572702482386098*^9, 3.572702489958514*^9}, {3.572702685255632*^9, 
  3.5727026856763573`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"skltable", "=", 
   RowBox[{"MapIndexed", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"timelist", "[", 
         RowBox[{"[", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "#1"}], "}"}], 
      "&"}], ",", "skltable", ",", 
     RowBox[{"{", "2", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4661842031542273`*^9, 3.466184228413291*^9}, {
   3.4661843110645733`*^9, 3.4661843425701427`*^9}, {3.4661858614166327`*^9, 
   3.46618587503117*^9}, {3.4661860546599913`*^9, 3.466186061148155*^9}, 
   3.466186097861471*^9, {3.4661861866757727`*^9, 3.466186188193014*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"skltable", ",", 
     RowBox[{"PlotRange", " ", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"start", ",", "stop"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"Filling", " ", "\[Rule]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"i", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", "+", "1"}], "}"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Lighter", "[", 
             RowBox[{
              RowBox[{"rColorList", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "0.4"}], "]"}], "]"}]}], 
          "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
     ",", 
     RowBox[{"Axes", "\[Rule]", "False"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"AbsoluteThickness", "[", "0.5", "]"}], ",", 
        RowBox[{"GrayLevel", "[", "0.25", "]"}]}], "]"}]}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
     RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.15", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0"}], "}"}]}], "}"}]}], ",", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"frameTicks", "[", 
       RowBox[{"0", ",", "1", ",", "0.25"}], "]"}]}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<\>\"", ",", "\"\<Trunk probability\>\""}], "}"}]}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.466176852215859*^9, 3.4661768888865023`*^9}, {
   3.466183782363316*^9, 3.4661837866544333`*^9}, {3.46618393923496*^9, 
   3.466183976275391*^9}, {3.4661840360811462`*^9, 3.466184093147965*^9}, {
   3.466185893406157*^9, 3.466185955097872*^9}, {3.46618625581631*^9, 
   3.466186415901572*^9}, {3.466186676075788*^9, 3.4661866987719927`*^9}, 
   3.4661868423787823`*^9, {3.466187727901451*^9, 3.466187728409191*^9}, {
   3.4661880741416597`*^9, 3.4661880755237722`*^9}, {3.466189523851769*^9, 
   3.466189524827317*^9}, {3.4661896764519777`*^9, 3.466189678507338*^9}, {
   3.466189874555354*^9, 3.4661898763984547`*^9}, {3.466190304980487*^9, 
   3.466190394658251*^9}, {3.46619044026899*^9, 3.466190448696137*^9}, {
   3.4661905044068537`*^9, 3.4661905045620813`*^9}, {3.466287717610183*^9, 
   3.46628775280508*^9}, {3.466288096268577*^9, 3.466288096416232*^9}, {
   3.4662881788700027`*^9, 3.4662881790341167`*^9}, {3.466288530268272*^9, 
   3.466288613431869*^9}, {3.4663604611030273`*^9, 3.4663604683191967`*^9}, {
   3.466360505083804*^9, 3.466360529836335*^9}, {3.4663618455315104`*^9, 
   3.466361859462549*^9}, {3.466362276062956*^9, 3.466362282741138*^9}, {
   3.467042269285206*^9, 3.467042269958311*^9}, {3.478868390837729*^9, 
   3.478868408232438*^9}, {3.478868495210635*^9, 3.4788685092188683`*^9}, {
   3.478868643841957*^9, 3.478868710621519*^9}, {3.478868746718532*^9, 
   3.478868747212175*^9}, {3.4788688118027487`*^9, 3.4788688612216387`*^9}, {
   3.478869539743572*^9, 3.4788695404859447`*^9}, {3.478870173037303*^9, 
   3.47887017332953*^9}, {3.4788702378789988`*^9, 3.4788702381578493`*^9}, {
   3.478870274632214*^9, 3.478870274762665*^9}, {3.5727027751533203`*^9, 
   3.5727027856404057`*^9}, {3.5727030199838676`*^9, 3.572703083850883*^9}, {
   3.572704429473521*^9, 3.572704504621571*^9}, {3.572704534776886*^9, 
   3.572704608492462*^9}, 3.5732876048034487`*^9, {3.601220440161751*^9, 
   3.6012204417893143`*^9}, {3.601220559213401*^9, 3.60122055948706*^9}, {
   3.601221173726005*^9, 3.601221183328328*^9}, 3.601221215511808*^9, 
   3.6012227501430902`*^9, 3.611506897919525*^9, 3.6115076682623*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeLabel", "[", 
   RowBox[{"name_", ",", "loc_"}], "]"}], ":=", 
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"name", "/.", "shortNameRules"}], ",", "loc"}], "]"}], ",", 
    RowBox[{"Directive", "[", 
     RowBox[{
      RowBox[{"Darker", "[", 
       RowBox[{
        RowBox[{"name", "/.", "colorRules"}], ",", "0.4"}], "]"}], ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6115071013063297`*^9, 3.611507128516675*^9}, 
   3.6115071844579*^9, {3.61150726884839*^9, 3.611507268967286*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"labels", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<NorthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2000.7", ",", "0.9"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SouthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2002.2", ",", "0.4"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SoutheastAsia\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2003.6", ",", "0.08"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SouthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2004.7", ",", "0.32"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<India\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2005.8", ",", "0.48"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<USACanada\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2008.05", ",", "0.9"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.611507131581678*^9, 3.611507364541959*^9}, {
  3.6115074218128*^9, 3.6115074346102753`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"stem", "\[Equal]", "\"\<h3_large_geo\>\""}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"fig", ",", "labels"}], "]"}], ",", "\[IndentingNewLine]", 
     "fig"}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.611507443145269*^9, 3.611507497851746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_trunkpro.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4663619477911253`*^9, 3.466361948397429*^9}, {
   3.478868878910345*^9, 3.4788688792151318`*^9}, {3.5727027058246098`*^9, 
   3.572702728746069*^9}, {3.6012205466978273`*^9, 3.60122056895765*^9}, 
   3.601222753162395*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_trunkpro.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4663619477911253`*^9, 3.466361948397429*^9}, {
   3.478868878910345*^9, 3.4788688792151318`*^9}, {3.5727027058246098`*^9, 
   3.572702728746069*^9}, {3.575265640591477*^9, 3.575265649289258*^9}, {
   3.6012205522976418`*^9, 3.6012205635579243`*^9}, 3.601222754192471*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Ancestral regions ", "Section",
 CellChangeTimes->{{3.458494930766955*^9, 3.458494933124058*^9}, 
   3.466088773182148*^9, {3.575796221905142*^9, 3.575796224991737*^9}}],

Cell[CellGroupData[{

Cell["Region-specific origins", "Subsection",
 CellChangeTimes->{{3.575972081278623*^9, 3.575972085287115*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"numberToString", "[", "i", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", " ", "5"}], "}"}]}], "]"}], ",", " ", 
      "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}, {3.606251544957864*^9, 
   3.606251554396941*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"historyPlot", "[", 
   RowBox[{"file_", ",", "fromRegion_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rNames", ",", "rColorList", ",", "start", ",", "stop", ",", "skls", ",",
       "length", ",", "timelist", ",", "skltable"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rNames", "=", 
      RowBox[{"Reverse", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rColorList", "=", 
      RowBox[{"Reverse", "[", "colorList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"start", "=", "0"}], ";", 
     RowBox[{"stop", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"skls", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"length", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<prohist_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"timelist", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<prohist_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "length", "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"list", " ", "=", " ", 
              RowBox[{"Select", "[", 
               RowBox[{"skls", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "==", 
                  RowBox[{
                  "\"\<prohist_\>\"", "<>", "fromRegion", "<>", "\"\<_\>\"", "<>",
                    "i"}]}], "&"}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", " ", "4"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "rNames"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Accumulate", "[", "skltable", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"timelist", "[", 
            RowBox[{"[", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "#1"}], 
          "}"}], "&"}], ",", "skltable", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"skltable", ",", 
       RowBox[{"PlotRange", " ", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"start", ",", "stop"}], "}"}], ",", "All"}], "}"}]}], ",", 
       
       RowBox[{"Filling", " ", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", "+", "1"}], "}"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Lighter", "[", 
               RowBox[{
                RowBox[{"rColorList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0.35"}], "]"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.5", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.25", "]"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.15", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.05", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"10", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"15", ",", "5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"fromRegion", "/.", "fullNameRules"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"Pi", "/", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.575809271407324*^9, 3.5758093155100193`*^9}, 
   3.575809922124495*^9, {3.575973312067293*^9, 3.575973324542577*^9}, {
   3.59391175064878*^9, 3.5939117507860937`*^9}, 3.59391201698888*^9, {
   3.59950881498554*^9, 3.599508822694296*^9}, 3.599534681118429*^9, {
   3.606251347384489*^9, 3.6062513650919447`*^9}, {3.606251395636416*^9, 
   3.606251437417556*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"historyPlot", "[", 
       RowBox[{
        RowBox[{"stem", "<>", "\"\</out_hist.skylines\>\""}], ",", "#"}], 
       "]"}], "&"}], ",", "names"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.575809319248608*^9, 3.575809343226701*^9}, {
  3.6062514410692472`*^9, 3.606251455155768*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"gappedPartition", "[", 
     RowBox[{"plots", ",", "3"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.575809345315193*^9, 3.575809364235099*^9}, {
   3.575809768226357*^9, 3.575809797324811*^9}, 3.575966028458551*^9, 
   3.5995088503871*^9, 3.59950888444387*^9, 3.606251337555228*^9, 
   3.606251563562025*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_regionhist.png\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4663619477911253`*^9, 3.466361948397429*^9}, {
   3.478868878910345*^9, 3.4788688792151318`*^9}, {3.5727027058246098`*^9, 
   3.572702728746069*^9}, {3.575809808647966*^9, 3.575809813661202*^9}, {
   3.575972402950287*^9, 3.575972404092958*^9}, {3.599508860777494*^9, 
   3.5995088870444*^9}, 3.599508967920855*^9, 3.599509407574562*^9, 
   3.599532501961872*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_regionhist.pdf\>\""}], ",", " ", "fig", 
    ",", " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4663619477911253`*^9, 3.466361948397429*^9}, {
   3.478868878910345*^9, 3.4788688792151318`*^9}, {3.5727027058246098`*^9, 
   3.572702728746069*^9}, {3.575265640591477*^9, 3.575265649289258*^9}, {
   3.575809812293799*^9, 3.575809815664321*^9}, {3.5759724083169327`*^9, 
   3.575972409404986*^9}, {3.5995088692298203`*^9, 3.599508888084414*^9}, 
   3.5995089687852983`*^9, 3.599509412266534*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Global origins", "Subsection",
 CellChangeTimes->{{3.575972088847093*^9, 3.575972090574862*^9}}],

Cell["Take average of histories greater than 2 years.", "Text",
 CellChangeTimes->{{3.575976089757585*^9, 3.575976100228259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"globalPro", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "skls", ",", "timelist", ",", "skltable", ",", "pos", ",", "pro"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"skls", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"timelist", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<prohist_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"list", " ", "=", " ", 
               RowBox[{"Select", "[", 
                RowBox[{"skls", ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                   RowBox[{
                   "\"\<prohist_\>\"", "<>", "j", "<>", "\"\<_\>\"", "<>", 
                    "i"}]}], "&"}]}], "]"}]}], "}"}], ",", " ", 
             RowBox[{"list", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", " ", "4"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "names"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "names"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"timelist", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "2"}]}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pro", "=", 
      RowBox[{"Map", "[", 
       RowBox[{"Mean", ",", 
        RowBox[{"skltable", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "pos"}], "]"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pro", "/", 
      RowBox[{"Total", "[", "pro", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5759747445840273`*^9, 3.575974785272934*^9}, {
   3.5759748917488327`*^9, 3.57597493542767*^9}, {3.5759750042076406`*^9, 
   3.5759750068122168`*^9}, {3.575976026135572*^9, 3.575976030116068*^9}, 
   3.575976076050712*^9, {3.606659621790331*^9, 3.606659648564967*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pro", "=", 
  RowBox[{"globalPro", "[", 
   RowBox[{"stem", "<>", "\"\</out_hist.skylines\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.606659611144856*^9, 3.6066596189149437`*^9}, {
  3.60665966347113*^9, 3.60665966462271*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.17183158638820265`", ",", "0.08178277494877652`", ",", 
   "0.03844673548105507`", ",", "0.37423694508120675`", ",", 
   "0.0362354619875893`", ",", "0.09892207523415425`", ",", 
   "0.1014317404465775`", ",", "0.028660505508089427`", ",", 
   "0.06845217492434856`"}], "}"}]], "Output",
 CellChangeTimes->{{3.606659651251129*^9, 3.606659670024837*^9}, 
   3.6066600333532743`*^9, 3.6066612269461184`*^9, 3.606666342151659*^9, 
   3.6066672634728317`*^9, 3.6066695456512203`*^9, 3.607125579301635*^9, 
   3.607129761038533*^9, 3.607129863523663*^9, 3.607132823078547*^9, 
   3.6071809883550577`*^9, 3.607181319717924*^9, 3.607183530619059*^9, 
   3.607184583675667*^9, 3.607188439127676*^9, 3.607188986791065*^9, 
   3.617246439168168*^9, 3.617280309121438*^9, 3.617280540923184*^9, 
   3.617280738621503*^9, 3.62103520628094*^9, 3.626707991901616*^9, 
   3.626708685301838*^9, 3.6267089830820303`*^9, 3.626709297403612*^9, 
   3.626709738815377*^9, 3.62671046047752*^9, 3.626715690924446*^9, 
   3.626716024289566*^9, 3.626716139172608*^9, 3.6267166960366383`*^9, 
   3.626716782253869*^9, 3.627139129428076*^9, 3.627141612749186*^9, 
   3.6271417978560257`*^9, 3.6271419714885187`*^9, 3.6271421913151484`*^9, 
   3.627142288126136*^9, 3.6271425849276247`*^9, 3.627142659527622*^9, 
   3.627143590491921*^9, 3.627149626811955*^9, 3.630850778998757*^9, 
   3.632001648150063*^9, 3.632234261953727*^9, 3.632234565032205*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"statStem", "<>", "\"\<_origin.tsv\>\""}], ",", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"names", ",", "pro"}], "}"}], "]"}], ",", "\"\<Table\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.5759749631873493`*^9, 3.575975001281893*^9}, {
   3.575976116081585*^9, 3.575976150495368*^9}, {3.5995089591697397`*^9, 
   3.599509002236504*^9}, {3.599509425029961*^9, 3.5995094289181023`*^9}, 
   3.606659673189851*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Migration table", "Section",
 CellChangeTimes->{{3.4934002331218863`*^9, 3.493400238135262*^9}, {
   3.5727165675579023`*^9, 3.572716569520173*^9}, {3.6013076230294657`*^9, 
   3.601307624317288*^9}, 3.602946403759103*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"migMatrix", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mcmc", ",", "header", ",", "headerRules", ",", "rateNames", ",", 
      "rateIndices", ",", "indictorNames", ",", "indicatorIndices", ",", 
      "clockIndex", ",", "rates", ",", "locationPairsA", ",", 
      "locationPairsB", ",", "locationPairs", ",", "base"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Extract", " ", "means", " ", "from", " ", "MCMC"}], " ", "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mcmc", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mcmc", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{"mcmc", ",", "2"}], "]"}]}], ";", 
     RowBox[{"header", "=", 
      RowBox[{"mcmc", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"headerRules", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#1", "->", 
          RowBox[{"#2", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "&"}], ",", "header"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"mcmc", "=", 
      RowBox[{"mcmc", "[", 
       RowBox[{"[", 
        RowBox[{"drop", ";;", 
         RowBox[{"-", "1"}], ";;", "skip"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rateNames", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"header", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"StringFreeQ", "[", 
           RowBox[{"x", ",", "\"\<geoRates\>\""}], "]"}]}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rateIndices", "=", 
      RowBox[{"rateNames", "/.", "headerRules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"indictorNames", "=", 
      RowBox[{"Cases", "[", 
       RowBox[{"header", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"!", 
          RowBox[{"StringFreeQ", "[", 
           RowBox[{"x", ",", "\"\<geoIndicators\>\""}], "]"}]}]}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"indicatorIndices", "=", 
      RowBox[{"indictorNames", "/.", "headerRules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"clockIndex", "=", 
      RowBox[{"\"\<geoSiteModel.mu\>\"", "/.", "headerRules"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rates", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Mean", "[", 
          RowBox[{
           RowBox[{"mcmc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#1"}], "]"}], "]"}], "*", 
           RowBox[{"mcmc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "#2"}], "]"}], "]"}], "*", 
           RowBox[{"mcmc", "[", 
            RowBox[{"[", 
             RowBox[{"All", ",", "clockIndex"}], "]"}], "]"}]}], "]"}], "&"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"rateIndices", ",", "indicatorIndices"}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Organize", " ", "these", " ", "into", " ", "a", " ", "matrix", " ", 
       "rather", " ", "than", " ", "a", " ", "vector"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"locationPairsA", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", ">", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "j"}], "}"}], ",", "Null"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
        "Null"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"locationPairsB", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"j", ">", "i"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "i"}], "}"}], ",", "Null"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
        "Null"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"locationPairs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"locationPairsA", ",", "locationPairsB"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"base", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "n", "}"}], ",", 
        RowBox[{"{", "n", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Total", "[", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"ReplacePart", "[", 
          RowBox[{"base", ",", 
           RowBox[{"#1", "\[Rule]", "#2"}]}], "]"}], "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"locationPairs", ",", "rates"}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6065947177689047`*^9, 3.606594838500597*^9}, {
  3.606594901432444*^9, 3.606594997539567*^9}, {3.606595033207917*^9, 
  3.606595063779867*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mig", "=", 
   RowBox[{"migMatrix", "[", 
    RowBox[{"stem", "<>", "\"\</\>\"", "<>", "stem", "<>", "\"\<.log\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606595012463208*^9, 3.60659502818095*^9}, 
   3.6065950703091*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"statStem", "<>", "\"\<_mig.tsv\>\""}], ",", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"Prepend", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Round", "[", 
           RowBox[{"mig", ",", "0.01"}], "]"}], "]"}], ",", "names"}], "]"}], 
       "]"}], ",", 
      RowBox[{"Prepend", "[", 
       RowBox[{"names", ",", "\"\<\>\""}], "]"}]}], "]"}], ",", 
    "\"\<Table\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{
  3.4497508663172703`*^9, 3.450435787155594*^9, 3.4504358243681498`*^9, 
   3.450445230012908*^9, {3.4506344675577497`*^9, 3.45063452874063*^9}, {
   3.4506360016762867`*^9, 3.450636012109112*^9}, {3.4507010843875513`*^9, 
   3.450701085155601*^9}, {3.450714326951878*^9, 3.450714327094544*^9}, {
   3.45311517023493*^9, 3.4531152095438843`*^9}, {3.4531255896472893`*^9, 
   3.453125589778038*^9}, {3.453470001136586*^9, 3.453470001260231*^9}, 
   3.45886581181911*^9, {3.458902066464347*^9, 3.4589020824081984`*^9}, 
   3.458908295868874*^9, {3.4592564075405912`*^9, 3.459256410909573*^9}, {
   3.459439147949222*^9, 3.459439156960627*^9}, {3.459440247263577*^9, 
   3.4594402491236887`*^9}, {3.459544762129092*^9, 3.459544763910811*^9}, {
   3.5995095146247187`*^9, 3.599509539463716*^9}, {3.59950987011887*^9, 
   3.599509878490716*^9}, {3.599510031982233*^9, 3.599510038119422*^9}, 
   3.601307584826004*^9, 3.6029464104474077`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Array", "Section",
 CellChangeTimes->{{3.6013024121284857`*^9, 3.601302412807643*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"myColorFunction", "[", "t_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "col", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"col", "=", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "0.3", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"White", ",", "col", ",", 
         RowBox[{"Darker", "[", 
          RowBox[{"col", ",", "0.6"}], "]"}]}], "}"}], ",", 
       RowBox[{"t", "/", "5"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5141381800352917`*^9, 3.5141381977597456`*^9}, {
   3.5141382580646825`*^9, 3.5141382859770985`*^9}, 3.5141388972823825`*^9, 
   3.5141390108763824`*^9, {3.5141419913668685`*^9, 3.5141420535708685`*^9}, {
   3.5142095579370346`*^9, 3.514209602899531*^9}, {3.5142096676860085`*^9, 
   3.514209768969136*^9}, {3.514212098661096*^9, 3.51421214454646*^9}, {
   3.5142125687954607`*^9, 3.5142125703944607`*^9}, 3.514214813144457*^9, {
   3.5142148711714573`*^9, 3.5142148794744573`*^9}, {3.514645659195969*^9, 
   3.5146456659194827`*^9}, {3.5147348441026683`*^9, 
   3.5147348503896685`*^9}, {3.5147549314561377`*^9, 
   3.5147549361421375`*^9}, {3.514755612904605*^9, 3.5147556202003345`*^9}, {
   3.5147557055968733`*^9, 3.5147557193242455`*^9}, {3.524341150194163*^9, 
   3.524341181870163*^9}, {3.5243412648431625`*^9, 3.524341265962163*^9}, {
   3.524341321911163*^9, 3.5243413299261627`*^9}, {3.527756089603444*^9, 
   3.527756108292919*^9}, {3.528712908306775*^9, 3.528712948148211*^9}, {
   3.528713653033052*^9, 3.528713763454945*^9}, {3.528713794127141*^9, 
   3.528713806919944*^9}, 3.5287138490970163`*^9, {3.5287138866085253`*^9, 
   3.528714090370517*^9}, {3.5287141228278513`*^9, 3.52871427036867*^9}, {
   3.528714350046898*^9, 3.528714442793103*^9}, {3.5287144884741497`*^9, 
   3.528714524185977*^9}, {3.52871456479205*^9, 3.52871459953341*^9}, {
   3.5287146473197203`*^9, 3.528714653407761*^9}, {3.6013025342124643`*^9, 
   3.60130254470979*^9}, 3.601302596844816*^9, {3.601302668175363*^9, 
   3.601302779184379*^9}, {3.601304053247645*^9, 3.601304054338387*^9}, 
   3.601314197957111*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"migPlot", "[", 
   RowBox[{"file_", ",", "type_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "max", ",", "sidebar", ",", "mig", ",", "migList", ",", "ticks", ",", 
      "typeLabel"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"max", "=", "10"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sidebar", "=", 
      RowBox[{"DensityPlot", "[", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "max"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "23"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "myColorFunction"}], ",", 
        RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "21"}], ",", 
        RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Round", "[", "i", "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "0", ",", "max", ",", "1"}], "}"}]}], 
              "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], "]"}]}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mig", "=", 
      RowBox[{"migMatrix", "[", "file", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"migList", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"n", "+", "1", "-", "i"}], ",", 
            RowBox[{"mig", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"names", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "+", "1", "-", "i"}], "]"}], "]"}], "/.", 
                 "fullNameRules"}], ",", 
                RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ",", " ", "None"}],
          "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Rotate", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"names", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", "fullNameRules"}], 
                  ",", 
                  RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", 
                RowBox[{"Pi", "/", "2"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ",", "None"}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"\"\<                     \>\"", "<>", "type"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "1.07"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Bold", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
            RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "150"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.05"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"typeLabel", ",", "\"\<\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{"migList", ",", 
             RowBox[{"ImageSize", "\[Rule]", "225"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", "myColorFunction"}], ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.5", ",", 
                  RowBox[{"n", "+", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", 
                  RowBox[{"n", "+", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "max"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", "ticks"}], ",", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
             RowBox[{"ClippingStyle", "\[Rule]", 
              RowBox[{"myColorFunction", "[", "max", "]"}]}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"70", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"70", ",", "0"}], "}"}]}], "}"}]}]}], "]"}], ",", 
           "sidebar"}], "}"}]}], "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Top"}], "}"}]}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0.25"}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606671827060236*^9, 3.606672035261981*^9}, {
  3.606672070464641*^9, 3.606672107039757*^9}, {3.606672194044075*^9, 
  3.606672197025749*^9}, {3.606672241185091*^9, 3.606672244739587*^9}, {
  3.6066722992202806`*^9, 3.60667233935507*^9}, {3.6066724201007767`*^9, 
  3.6066727764258013`*^9}, {3.606672856020941*^9, 3.606673134593934*^9}, {
  3.607129199397279*^9, 3.6071292041697397`*^9}, {3.607181185706327*^9, 
  3.607181190928631*^9}, {3.607181253748363*^9, 3.6071812718431168`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"migPlot", "[", 
    RowBox[{
     RowBox[{"stem", "<>", "\"\</\>\"", "<>", "stem", "<>", "\"\<.log\>\""}], 
     ",", "type"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606671860186022*^9, 3.606671872556944*^9}, {
   3.6066722306891727`*^9, 3.606672231320815*^9}, {3.6066724370803957`*^9, 
   3.606672437629139*^9}, {3.606673066985072*^9, 3.606673099128734*^9}, 
   3.6066735128923388`*^9, 3.607181166416431*^9, 3.6071812885923843`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_grid.png\>\""}], ",", " ", "fig", ",", 
    " ", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4663619477911253`*^9, 3.466361948397429*^9}, {
   3.478868878910345*^9, 3.4788688792151318`*^9}, {3.5727027058246098`*^9, 
   3.572702728746069*^9}, {3.575809808647966*^9, 3.575809813661202*^9}, {
   3.575972402950287*^9, 3.575972404092958*^9}, {3.599508860777494*^9, 
   3.5995088870444*^9}, 3.599508967920855*^9, 3.599509407574562*^9, 
   3.599532501961872*^9, {3.601304127193384*^9, 3.601304131818849*^9}, {
   3.601304253225732*^9, 3.601304253696948*^9}, 3.601307648035759*^9, 
   3.6029464134662943`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_grid.pdf\>\""}], ",", " ", "fig", ",", 
    " ", "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4663619477911253`*^9, 3.466361948397429*^9}, {
   3.478868878910345*^9, 3.4788688792151318`*^9}, {3.5727027058246098`*^9, 
   3.572702728746069*^9}, {3.575265640591477*^9, 3.575265649289258*^9}, {
   3.575809812293799*^9, 3.575809815664321*^9}, {3.5759724083169327`*^9, 
   3.575972409404986*^9}, {3.5995088692298203`*^9, 3.599508888084414*^9}, 
   3.5995089687852983`*^9, 3.599509412266534*^9, 3.601304135875519*^9, {
   3.601304255163395*^9, 3.601304255633068*^9}, 3.601307649318487*^9, 
   3.602946414853611*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stationary distribution", "Section",
 CellChangeTimes->{{3.4494077262212343`*^9, 3.449407730399107*^9}, {
   3.449410734469157*^9, 3.449410740436795*^9}, {3.449411842834334*^9, 
   3.44941184358982*^9}, 3.572759647644866*^9}],

Cell["\<\
Not used at the moment.  Directly calculating origin proportions from trees.\
\>", "Text",
 CellChangeTimes->{{3.606659683774613*^9, 3.6066596986184807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"equilibrium", "[", "mig_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"mcmig", ",", "maxrate"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Reverse", " ", "the", " ", "migration", " ", "rates"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mcmig", "=", 
      RowBox[{"Transpose", "[", "mig", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Find", " ", "greatest", " ", "row"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"maxrate", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "#", "]"}], "&"}], ",", "mcmig"}], "]"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Equalize", " ", "totals", " ", "by", " ", "adding", " ", "to", " ", 
       "diagonals"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mcmig", "=", 
      RowBox[{"mcmig", "+", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"maxrate", "-", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", "#", "]"}], "&"}], ",", "mcmig"}], "]"}]}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Normalizing", " ", "the", " ", "outgoing", " ", "rates"}], 
       ",", 
       RowBox[{
       "so", " ", "that", " ", "each", " ", "row", " ", "sums", " ", "to", 
        " ", "1"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mcmig", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "/", 
          RowBox[{"Total", "[", "#", "]"}]}], "&"}], ",", "mcmig"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Stationary", " ", "state", " ", "is", " ", "principal", " ", 
       "eigenvector"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"First", "@", 
       RowBox[{"Eigenvectors", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "mcmig", "]"}], ",", "1"}], "]"}]}], "/", 
      RowBox[{"Total", "[", 
       RowBox[{"First", "@", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"Transpose", "[", "mcmig", "]"}], ",", "1"}], "]"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606595106653893*^9, 3.6065952240059423`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"equilmean", "=", 
   RowBox[{"equilibrium", "[", "mig", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6065952264819193`*^9, 3.6065952337894917`*^9}, 
   3.6065952659667788`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Map", "Section",
 CellChangeTimes->{{3.458854283033678*^9, 3.4588542834725027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"greatCirclePoints", "[", 
   RowBox[{"{", 
    RowBox[{"coordA_", ",", "coordB_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"pos1", ",", "pos2", ",", "distance", ",", "direction"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pos1", "=", 
      RowBox[{"GeoPosition", "[", 
       RowBox[{"Reverse", "[", "coordA", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pos2", "=", 
      RowBox[{"GeoPosition", "[", 
       RowBox[{"Reverse", "[", "coordB", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"distance", "=", 
      RowBox[{"GeoDistance", "[", 
       RowBox[{"pos1", ",", "pos2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"direction", "=", 
      RowBox[{"GeoDirection", "[", 
       RowBox[{"pos1", ",", "pos2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Reverse", "[", 
        RowBox[{"LatitudeLongitude", "[", 
         RowBox[{"GeoDestination", "[", 
          RowBox[{"pos1", ",", " ", 
           RowBox[{"{", 
            RowBox[{"d", ",", "direction"}], "}"}]}], "]"}], "]"}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"d", ",", "0", ",", "distance", ",", 
         RowBox[{"5", "*", 
          RowBox[{"10", "^", "4"}]}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.572776148663684*^9, 3.572776331526848*^9}, {
   3.5727763648726683`*^9, 3.57277637169598*^9}, {3.5727764251169243`*^9, 
   3.572776428163883*^9}, 3.572776550477358*^9, {3.5727765805220337`*^9, 
   3.572776584413827*^9}, {3.573288981571231*^9, 3.573288981800521*^9}, {
   3.575962620747759*^9, 3.575962630274231*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"greatCircleLine", "[", 
   RowBox[{"{", 
    RowBox[{"coordA_", ",", "coordB_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vector", ",", "gathered"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vector", "=", 
      RowBox[{"greatCirclePoints", "[", 
       RowBox[{"{", 
        RowBox[{"coordA", ",", "coordB"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"gathered", "=", 
      RowBox[{"Gather", "[", 
       RowBox[{"vector", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "<", "180"}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "gathered", "]"}], ">", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{
           RowBox[{"First", "[", "gathered", "]"}], ",", "5"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"Last", "[", "gathered", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"First", "[", "gathered", "]"}], ",", "5"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.572776148663684*^9, 3.572776331526848*^9}, {
   3.5727763648726683`*^9, 3.57277637169598*^9}, {3.5727764251169243`*^9, 
   3.572776428163883*^9}, 3.572776550477358*^9, {3.5727765805220337`*^9, 
   3.572776584413827*^9}, {3.5727806917275457`*^9, 3.57278070500735*^9}, {
   3.57278075725289*^9, 3.572780798749312*^9}, {3.5727808735836697`*^9, 
   3.572780912502061*^9}, {3.572780955410918*^9, 3.572780955480637*^9}, {
   3.572781945448057*^9, 3.572781945908143*^9}, {3.573288793724916*^9, 
   3.573288834788432*^9}, {3.573288957202463*^9, 3.5732889576558723`*^9}, {
   3.584725497413103*^9, 3.5847255331490726`*^9}, {3.5847256811251297`*^9, 
   3.5847257330554533`*^9}, {3.601165013724718*^9, 3.6011650141161537`*^9}, 
   3.601165134618078*^9, {3.601165173500197*^9, 3.601165186617128*^9}, 
   3.601166371912952*^9, {3.601166564400869*^9, 3.6011665897532883`*^9}, {
   3.601166658865304*^9, 3.6011666591910477`*^9}, {3.601166694632826*^9, 
   3.6011667196498203`*^9}, {3.601166775646831*^9, 3.601166778329555*^9}, {
   3.6011668282349854`*^9, 3.601166831005493*^9}, {3.6011668616493807`*^9, 
   3.601166886295084*^9}, {3.601167276396867*^9, 3.601167277697249*^9}, {
   3.6011677725694427`*^9, 3.601167782605421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"leftGreatCircleLine", "[", 
   RowBox[{"{", 
    RowBox[{"coordA_", ",", "coordB_"}], "}"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"vector", ",", "gathered"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"vector", "=", 
      RowBox[{"greatCirclePoints", "[", 
       RowBox[{"{", 
        RowBox[{"coordA", ",", "coordB"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"vector", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", "360"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "&"}], ",", "vector"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"gathered", "=", 
      RowBox[{"Gather", "[", 
       RowBox[{"vector", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"EuclideanDistance", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "<", "180"}], "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "gathered", "]"}], ">", "1"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Arrow", "[", 
          RowBox[{
           RowBox[{"First", "[", "gathered", "]"}], ",", "5"}], "]"}], ",", 
         RowBox[{"Line", "[", 
          RowBox[{"Last", "[", "gathered", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"Arrow", "[", 
        RowBox[{
         RowBox[{"First", "[", "gathered", "]"}], ",", "5"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.572776148663684*^9, 3.572776331526848*^9}, {
   3.5727763648726683`*^9, 3.57277637169598*^9}, {3.5727764251169243`*^9, 
   3.572776428163883*^9}, 3.572776550477358*^9, {3.5727765805220337`*^9, 
   3.572776584413827*^9}, {3.5727806917275457`*^9, 3.57278070500735*^9}, {
   3.57278075725289*^9, 3.572780798749312*^9}, {3.5727808735836697`*^9, 
   3.572780912502061*^9}, {3.572780955410918*^9, 3.572780955480637*^9}, {
   3.572781945448057*^9, 3.572781945908143*^9}, {3.573288793724916*^9, 
   3.573288834788432*^9}, {3.573288957202463*^9, 3.5732889576558723`*^9}, {
   3.584725497413103*^9, 3.5847255331490726`*^9}, {3.5847256811251297`*^9, 
   3.5847257330554533`*^9}, {3.601165013724718*^9, 3.6011650141161537`*^9}, 
   3.601165134618078*^9, {3.601165173500197*^9, 3.601165186617128*^9}, 
   3.601166371912952*^9, {3.601166564400869*^9, 3.6011665897532883`*^9}, {
   3.601166658865304*^9, 3.6011666591910477`*^9}, {3.601166694632826*^9, 
   3.6011667196498203`*^9}, {3.601166775646831*^9, 3.601166778329555*^9}, {
   3.6011668282349854`*^9, 3.601166831005493*^9}, {3.6011668616493807`*^9, 
   3.601166886295084*^9}, {3.601167276396867*^9, 3.601167277697249*^9}, {
   3.6011677725694427`*^9, 3.601167782605421*^9}, {3.601168032101245*^9, 
   3.601168035818923*^9}, {3.60116807447409*^9, 3.60116809737807*^9}, {
   3.601168135927382*^9, 3.6011681368124332`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"centralPairs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<SouthAmerica\>\""}], ",", 
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<Europe\>\""}], ",", 
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<India\>\""}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<Europe\>\""}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<India\>\""}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", "\"\<India\>\""}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", "\"\<NorthChina\>\""}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", "\"\<SouthChina\>\""}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", "\"\<JapanKorea\>\""}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", "\"\<SoutheastAsia\>\""}], ",", 
     RowBox[{"\"\<Europe\>\"", "\[Rule]", "\"\<Oceania\>\""}], ",", 
     RowBox[{"\"\<India\>\"", "\[Rule]", "\"\<NorthChina\>\""}], ",", 
     RowBox[{"\"\<India\>\"", "\[Rule]", "\"\<SouthChina\>\""}], ",", 
     RowBox[{"\"\<India\>\"", "\[Rule]", "\"\<JapanKorea\>\""}], ",", 
     RowBox[{"\"\<India\>\"", "\[Rule]", "\"\<SoutheastAsia\>\""}], ",", 
     RowBox[{"\"\<India\>\"", "\[Rule]", "\"\<Oceania\>\""}], ",", 
     RowBox[{"\"\<NorthChina\>\"", "\[Rule]", "\"\<JapanKorea\>\""}], ",", 
     RowBox[{"\"\<SouthChina\>\"", "\[Rule]", "\"\<JapanKorea\>\""}], ",", 
     RowBox[{"\"\<NorthChina\>\"", "\[Rule]", "\"\<SoutheastAsia\>\""}], ",", 
     
     RowBox[{"\"\<SouthChina\>\"", "\[Rule]", "\"\<SoutheastAsia\>\""}], ",", 
     
     RowBox[{"\"\<NorthChina\>\"", "\[Rule]", "\"\<Oceania\>\""}], ",", 
     RowBox[{"\"\<SouthChina\>\"", "\[Rule]", "\"\<Oceania\>\""}], ",", 
     RowBox[{"\"\<JapanKorea\>\"", "\[Rule]", "\"\<SoutheastAsia\>\""}], ",", 
     
     RowBox[{"\"\<JapanKorea\>\"", "\[Rule]", "\"\<Oceania\>\""}], ",", 
     RowBox[{"\"\<SoutheastAsia\>\"", "\[Rule]", "\"\<Oceania\>\""}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<SoutheastAsia\>\""}], 
     ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<NorthChina\>\""}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<SouthChina\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5727734126810513`*^9, 3.572773490716748*^9}, {
  3.5727735509040003`*^9, 3.572773588660075*^9}, {3.572773619867867*^9, 
  3.572773620102231*^9}, {3.57277367712877*^9, 3.5727737544809103`*^9}, {
  3.5759619439672003`*^9, 3.575961976299034*^9}, {3.575962009653517*^9, 
  3.5759620209059772`*^9}, {3.575962063210586*^9, 3.575962133003355*^9}, {
  3.599510178881482*^9, 3.599510327074057*^9}, {3.601166173497567*^9, 
  3.60116618767629*^9}, {3.601167069247491*^9, 3.601167069486368*^9}, {
  3.60116712205655*^9, 3.601167122313505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"outerPairs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<NorthChina\>\""}], ",", 
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<SouthChina\>\""}], ",", 
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<JapanKorea\>\""}], ",", 
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<SoutheastAsia\>\""}], ",", 
     RowBox[{"\"\<USACanada\>\"", "\[Rule]", "\"\<Oceania\>\""}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<JapanKorea\>\""}], ",", 
     RowBox[{"\"\<SouthAmerica\>\"", "\[Rule]", "\"\<Oceania\>\""}]}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.572773428028181*^9, 3.572773443214196*^9}, {
   3.572773499125909*^9, 3.5727735994069023`*^9}, {3.572773631526441*^9, 
   3.57277363183118*^9}, {3.5727736918175383`*^9, 3.572773694929736*^9}, 
   3.57277375765497*^9, {3.575961994395501*^9, 3.575962030526679*^9}, {
   3.575962095603888*^9, 3.5759621388171263`*^9}, {3.5995103328159647`*^9, 
   3.5995103718403263`*^9}, {3.601166231765511*^9, 3.6011662359961777`*^9}, {
   3.601167065667121*^9, 3.6011670661050663`*^9}, {3.601167118582157*^9, 
   3.601167118948354*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"base", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "n", "}"}], ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.57277394474378*^9, 3.572773960634077*^9}, {
   3.572774069178499*^9, 3.572774069582131*^9}, 3.5727741633294077`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"centralMigMatrix", "[", "mig_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fromMatrix", ",", "toMatrix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fromMatrix", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"from", ",", "to", ",", "m"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"from", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"to", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"m", "=", 
              RowBox[{"mig", "[", 
               RowBox[{"[", 
                RowBox[{"from", ",", "to"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"base", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"from", ",", "to"}], "}"}], "\[Rule]", "m"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
         "centralPairs"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"toMatrix", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"from", ",", "to", ",", "m"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"to", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"from", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"m", "=", 
              RowBox[{"mig", "[", 
               RowBox[{"[", 
                RowBox[{"from", ",", "to"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"base", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"from", ",", "to"}], "}"}], "\[Rule]", "m"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
         "centralPairs"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fromMatrix", "+", "toMatrix"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.606595295161058*^9, 3.6065953703073683`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"outerMigMatrix", "[", "mig_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"fromMatrix", ",", "toMatrix"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fromMatrix", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"from", ",", "to", ",", "m"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"from", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"to", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"m", "=", 
              RowBox[{"mig", "[", 
               RowBox[{"[", 
                RowBox[{"from", ",", "to"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"base", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"from", ",", "to"}], "}"}], "\[Rule]", "m"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
         "outerPairs"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"toMatrix", "=", 
      RowBox[{"Total", "[", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"from", ",", "to", ",", "m"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"to", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"from", "=", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"names", ",", 
                 RowBox[{"#", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"m", "=", 
              RowBox[{"mig", "[", 
               RowBox[{"[", 
                RowBox[{"from", ",", "to"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{"base", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"from", ",", "to"}], "}"}], "\[Rule]", "m"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], "&"}], ",", 
         "outerPairs"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fromMatrix", "+", "toMatrix"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.606595398627103*^9, 3.6065954453241167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"minimumRate", "=", "0.25"}], ";", 
  RowBox[{"thicknessScaler", "=", "0.0025"}], ";", 
  RowBox[{"circleScaler", "=", "25"}], ";"}]], "Input",
 CellChangeTimes->{{3.572781234142552*^9, 3.572781276228973*^9}, {
   3.5727813304110823`*^9, 3.5727813432022047`*^9}, {3.572781446114279*^9, 
   3.572781457553343*^9}, {3.572781500142838*^9, 3.572781527789296*^9}, {
   3.572781576945973*^9, 3.572781577193391*^9}, {3.572781797695558*^9, 
   3.5727818203571177`*^9}, {3.573288763588797*^9, 3.573288763706509*^9}, {
   3.573294746618987*^9, 3.573294746763342*^9}, {3.573294785097237*^9, 
   3.57329481466376*^9}, 3.599532233995941*^9, {3.599532805563012*^9, 
   3.59953280597047*^9}, {3.599532884733453*^9, 3.59953291236675*^9}, {
   3.5995329541261377`*^9, 3.5995329548606052`*^9}, {3.599609466861554*^9, 
   3.599609467747913*^9}, {3.599610119693481*^9, 3.599610120060213*^9}, {
   3.60116856417908*^9, 3.6011685643546257`*^9}, {3.6011685951980057`*^9, 
   3.601168626391992*^9}, {3.6013086658486233`*^9, 3.601308668192439*^9}, {
   3.601313755617663*^9, 3.601313755779701*^9}, {3.601313871717124*^9, 
   3.601313871930228*^9}, {3.6013139044205523`*^9, 3.601313904549611*^9}, {
   3.6013146448663473`*^9, 3.601314645137375*^9}, 3.601314716973715*^9, 
   3.6013147634389877`*^9, {3.6066610674867496`*^9, 3.606661073865116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapGraph", "[", 
   RowBox[{"mig_", ",", "pro_", ",", "coords_", ",", "vertexQ_"}], "]"}], ":=", 
  RowBox[{"GraphPlot", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", ">", "minimumRate"}], ",", "1", ",", "0"}], "]"}], 
       "&"}], ",", "mig", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], ",", 
    RowBox[{"VertexRenderingFunction", "\[Rule]", 
     RowBox[{"If", "[", 
      RowBox[{"vertexQ", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"colorList", "[", 
            RowBox[{"[", "#2", "]"}], "]"}], ",", 
           RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
           RowBox[{"Disk", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"circleScaler", "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"pro", "[", 
                RowBox[{"[", "#2", "]"}], "]"}], "]"}]}]}], "]"}]}], "}"}], 
         "&"}], ")"}], ",", "None"}], "]"}]}], ",", 
    RowBox[{"VertexCoordinateRules", "\[Rule]", "coords"}], ",", 
    RowBox[{"EdgeRenderingFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"thismig", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"mig", ",", "#2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GrayLevel", "[", "0.2", "]"}], ",", 
           RowBox[{"Arrowheads", "[", 
            RowBox[{"11", "*", "thicknessScaler", "*", 
             RowBox[{"Sqrt", "[", "thismig", "]"}]}], "]"}], ",", 
           RowBox[{"Thickness", "[", 
            RowBox[{"thicknessScaler", "*", "thismig"}], "]"}], ",", 
           RowBox[{"greatCircleLine", "[", "#1", "]"}]}], "}"}]}], "]"}], 
       "&"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5727815827054033`*^9, 3.5727816134534807`*^9}, {
   3.572781662555615*^9, 3.572781700781192*^9}, {3.5727817676251163`*^9, 
   3.5727817786183653`*^9}, 3.573288745615478*^9, {3.573290506401643*^9, 
   3.573290508284696*^9}, {3.5759624667353477`*^9, 3.575962529783252*^9}, {
   3.584725867955089*^9, 3.584725874127501*^9}, {3.584725932478219*^9, 
   3.584725958627203*^9}, {3.599510444628674*^9, 3.5995104632504377`*^9}, {
   3.59951058272046*^9, 3.599510587602975*^9}, {3.59951066038813*^9, 
   3.599510685407361*^9}, {3.599532247295138*^9, 3.5995322512857113`*^9}, {
   3.599532904699224*^9, 3.599532915093169*^9}, {3.601168303979117*^9, 
   3.601168306222666*^9}, {3.601168345844819*^9, 3.601168346497457*^9}, 
   3.6011683974524097`*^9, 3.601168445072216*^9, {3.601168479926057*^9, 
   3.601168487225698*^9}, 3.601168560632202*^9, 3.601313798338963*^9, {
   3.6013138324471197`*^9, 3.601313832594349*^9}, {3.601313866878459*^9, 
   3.6013138670757*^9}, 3.601318882753091*^9, {3.6066598785969257`*^9, 
   3.606659883929041*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"leftMapGraph", "[", 
   RowBox[{"mig_", ",", "pro_", ",", "coords_", ",", "vertexQ_"}], "]"}], ":=", 
  RowBox[{"GraphPlot", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"#", ">", "minimumRate"}], ",", "1", ",", "0"}], "]"}], 
       "&"}], ",", "mig", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], ",", 
    RowBox[{"VertexRenderingFunction", "\[Rule]", 
     RowBox[{"If", "[", 
      RowBox[{"vertexQ", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"colorList", "[", 
            RowBox[{"[", "#2", "]"}], "]"}], ",", 
           RowBox[{"EdgeForm", "[", "Black", "]"}], ",", 
           RowBox[{"Disk", "[", 
            RowBox[{"#1", ",", 
             RowBox[{"circleScaler", "*", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"pro", "[", 
                RowBox[{"[", "#2", "]"}], "]"}], "]"}]}]}], "]"}]}], "}"}], 
         "&"}], ")"}], ",", "None"}], "]"}]}], ",", 
    RowBox[{"VertexCoordinateRules", "\[Rule]", "coords"}], ",", 
    RowBox[{"EdgeRenderingFunction", "\[Rule]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"thismig", "=", 
           RowBox[{"Extract", "[", 
            RowBox[{"mig", ",", "#2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"GrayLevel", "[", "0.2", "]"}], ",", 
           RowBox[{"Arrowheads", "[", 
            RowBox[{"11", "*", "thicknessScaler", "*", 
             RowBox[{"Sqrt", "[", "thismig", "]"}]}], "]"}], ",", 
           RowBox[{"Thickness", "[", 
            RowBox[{"thicknessScaler", "*", "thismig"}], "]"}], ",", 
           RowBox[{"leftGreatCircleLine", "[", "#1", "]"}]}], "}"}]}], "]"}], 
       "&"}], ")"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5727815827054033`*^9, 3.5727816134534807`*^9}, {
   3.572781662555615*^9, 3.572781700781192*^9}, {3.5727817676251163`*^9, 
   3.5727817786183653`*^9}, 3.573288745615478*^9, {3.573290506401643*^9, 
   3.573290508284696*^9}, {3.5759624667353477`*^9, 3.575962529783252*^9}, {
   3.584725867955089*^9, 3.584725874127501*^9}, {3.584725932478219*^9, 
   3.584725958627203*^9}, {3.599510444628674*^9, 3.5995104632504377`*^9}, {
   3.59951058272046*^9, 3.599510587602975*^9}, {3.59951066038813*^9, 
   3.599510685407361*^9}, {3.599532247295138*^9, 3.5995322512857113`*^9}, {
   3.599532904699224*^9, 3.599532915093169*^9}, {3.601168103173852*^9, 
   3.6011681121657467`*^9}, {3.6011682534403343`*^9, 
   3.6011682664853773`*^9}, {3.601168388106674*^9, 3.601168401878727*^9}, 
   3.601168444338037*^9, {3.601168483338942*^9, 3.601168490704175*^9}, 
   3.601168558523378*^9, {3.60131379293633*^9, 3.6013137950506077`*^9}, {
   3.601313835071363*^9, 3.601313835446575*^9}, {3.601313868109478*^9, 
   3.6013138682926893`*^9}, 3.6013188731888647`*^9, {3.606659890019009*^9, 
   3.6066599100078897`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapPlot", "[", 
   RowBox[{"logFile_", ",", "proFile_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mig", ",", "pro", ",", "centralMig", ",", "outerMig", ",", 
      "centralGraph", ",", "leftGraph", ",", "rightGraph"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mig", "=", 
      RowBox[{"migMatrix", "[", "logFile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pro", "=", 
      RowBox[{"globalPro", "[", "proFile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centralMig", "=", 
      RowBox[{"centralMigMatrix", "[", "mig", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outerMig", "=", 
      RowBox[{"outerMigMatrix", "[", "mig", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centralGraph", "=", 
      RowBox[{"mapGraph", "[", 
       RowBox[{"centralMig", ",", "pro", ",", "mapCoords", ",", "True"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"leftGraph", "=", 
      RowBox[{"leftMapGraph", "[", 
       RowBox[{
       "outerMig", ",", "pro", ",", "leftMapCoords", ",", "True", ",", 
        "type"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rightGraph", "=", 
      RowBox[{"mapGraph", "[", 
       RowBox[{"outerMig", ",", "pro", ",", "rightMapCoords", ",", "True"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
      "map", ",", "leftGraph", ",", "rightGraph", ",", "centralGraph"}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606595472124769*^9, 3.6065955136035337`*^9}, {
  3.606659713812097*^9, 3.606659738940147*^9}, {3.606659791776434*^9, 
  3.60665984400651*^9}, {3.606659915870278*^9, 3.606659953998472*^9}, {
  3.606660405969136*^9, 3.606660420942246*^9}, {3.6066608862894163`*^9, 
  3.606660886588251*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mapPlot", "[", 
   RowBox[{"logFile_", ",", "proFile_", ",", "type_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "mig", ",", "pro", ",", "centralMig", ",", "outerMig", ",", 
      "centralGraph", ",", "leftGraph", ",", "rightGraph", ",", "label"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mig", "=", 
      RowBox[{"migMatrix", "[", "logFile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pro", "=", 
      RowBox[{"globalPro", "[", "proFile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centralMig", "=", 
      RowBox[{"centralMigMatrix", "[", "mig", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"outerMig", "=", 
      RowBox[{"outerMigMatrix", "[", "mig", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"centralGraph", "=", 
      RowBox[{"mapGraph", "[", 
       RowBox[{"centralMig", ",", "pro", ",", "mapCoords", ",", "True"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"leftGraph", "=", 
      RowBox[{"leftMapGraph", "[", 
       RowBox[{"outerMig", ",", "pro", ",", "leftMapCoords", ",", "True"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rightGraph", "=", 
      RowBox[{"mapGraph", "[", 
       RowBox[{"outerMig", ",", "pro", ",", "rightMapCoords", ",", "True"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"label", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"type", ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.03", ",", "0.05"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Bold", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{
      "map", ",", "leftGraph", ",", "rightGraph", ",", "centralGraph", ",", 
       "label"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606595472124769*^9, 3.6065955136035337`*^9}, {
  3.606659713812097*^9, 3.606659738940147*^9}, {3.606659791776434*^9, 
  3.60665984400651*^9}, {3.606659915870278*^9, 3.606659953998472*^9}, {
  3.606660405969136*^9, 3.606660420942246*^9}, {3.606660712470702*^9, 
  3.606660862952125*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"mapPlot", "[", 
    RowBox[{
     RowBox[{"stem", "<>", "\"\</\>\"", "<>", "stem", "<>", "\"\<.log\>\""}], 
     ",", 
     RowBox[{"stem", "<>", "\"\</out_hist.skylines\>\""}], ",", "type"}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606659720955153*^9, 3.606659723554554*^9}, {
   3.606659762740103*^9, 3.606659779941683*^9}, {3.606659998252181*^9, 
   3.6066599988306913`*^9}, 3.606660081300971*^9, 3.606660383526266*^9, {
   3.606660480260686*^9, 3.606660483315592*^9}, 3.606660932351445*^9, {
   3.606661020279004*^9, 3.6066610319719954`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_map.png\>\""}], ",", "fig", ",", 
    "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"figureStem", "<>", "\"\<_map.pdf\>\""}], ",", "fig", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Persistence", "Section",
 CellChangeTimes->{{3.606666335181048*^9, 3.606666336915436*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"persistencePlot", "[", 
   RowBox[{"file_", ",", "type_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "max", ",", "data", ",", "lowerRules", ",", "meanRules", ",", 
      "upperRules", ",", "lowerList", ",", "meanList", ",", "upperList", ",", 
      "ticks", ",", "lines", ",", "points", ",", "label"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"max", "=", "3.5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"file", ",", "\"\<Table\>\""}], "]"}], ",", "2"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lowerRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"upperRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"meanRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lowerList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/.", "lowerRules"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upperList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/.", "upperRules"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"meanList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "meanRules"}]}], "}"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"numberToString", "[", "i", "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "0", ",", " ", "5", ",", " ", "0.5"}], 
             "}"}]}], "]"}], ",", " ", "None"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Rotate", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"names", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/.", "fullNameRules"}], 
                ",", 
                RowBox[{"Pi", "/", "2"}]}], "]"}], ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"EvenQ", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", "None"}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerList", ",", "upperList"}], "}"}], ",", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"{", "2", "}"}]}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"LightGray", ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<Persistence\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5", ",", "9.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "max"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", "ticks"}], ",", 
        RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
        RowBox[{"Prolog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Dashed", ",", "Gray"}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.75", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"9.75", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"points", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"meanList", ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"#", ",", 
              RowBox[{"AbsolutePointSize", "[", "8", "]"}]}], "]"}], "&"}], 
           ",", "colorList"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"label", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"type", ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.03", ",", "0.98"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Bold", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"lines", ",", "points", ",", "label"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606666356181574*^9, 3.6066663634563513`*^9}, {
  3.6066663952994423`*^9, 3.6066664137285147`*^9}, {3.606666451908165*^9, 
  3.606667196650134*^9}, {3.606667315663821*^9, 3.6066673239403763`*^9}, {
  3.606667388057116*^9, 3.606667469000414*^9}, {3.606667769935293*^9, 
  3.606667830860983*^9}, {3.606670580639389*^9, 3.606670588310375*^9}, {
  3.607181497517707*^9, 3.607181498010765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"persistencePlot", "[", 
   RowBox[{"file_", ",", "type_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "names", ",", "colorList", ",", "n", ",", "max", ",", "data", ",", 
      "lowerRules", ",", "meanRules", ",", "upperRules", ",", "lowerList", 
      ",", "meanList", ",", "upperList", ",", "ticks", ",", "lines", ",", 
      "points", ",", "label"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"names", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<USACanada\>\"", ",", "\"\<SouthAmerica\>\"", ",", 
        "\"\<Europe\>\"", ",", "\"\<India\>\"", ",", "\"\<NorthChina\>\"", 
        ",", "\"\<SouthChina\>\"", ",", "\"\<China\>\"", ",", 
        "\"\<JapanKorea\>\"", ",", "\"\<SoutheastAsia\>\"", ",", 
        "\"\<Oceania\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colorList", "=", 
      RowBox[{"names", "/.", "colorRules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"max", "=", "3.5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"file", ",", "\"\<Table\>\""}], "]"}], ",", "2"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lowerRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"upperRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"meanRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"lowerList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/.", "lowerRules"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upperList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{
           RowBox[{"names", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "/.", "upperRules"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"meanList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"names", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "/.", "meanRules"}]}], "}"}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", " ", 
              RowBox[{"numberToString", "[", "i", "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "0", ",", " ", "5", ",", " ", "0.5"}], 
             "}"}]}], "]"}], ",", " ", "None"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Rotate", "[", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"names", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "/.", "fullNameRules"}], 
                ",", 
                RowBox[{"Pi", "/", "2"}]}], "]"}], ",", " ", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"EvenQ", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], 
            ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ",", " ", "None"}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lowerList", ",", "upperList"}], "}"}], ",", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{"{", "2", "}"}]}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"None", ",", "None"}], "}"}]}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"LightGray", ",", 
           RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<Persistence\>\""}], "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.5", ",", "10.5"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "max"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", "ticks"}], ",", 
        RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
        RowBox[{"Prolog", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Dashed", ",", "Gray"}], "]"}], ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.75", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"10.75", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
          "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"points", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"meanList", ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"#", ",", 
              RowBox[{"AbsolutePointSize", "[", "8", "]"}]}], "]"}], "&"}], 
           ",", "colorList"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"label", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"type", ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.03", ",", "0.98"}], "}"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", "Bold", ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
           RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"lines", ",", "points", ",", "label"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606666356181574*^9, 3.6066663634563513`*^9}, {
  3.6066663952994423`*^9, 3.6066664137285147`*^9}, {3.606666451908165*^9, 
  3.606667196650134*^9}, {3.606667315663821*^9, 3.6066673239403763`*^9}, {
  3.606667388057116*^9, 3.606667469000414*^9}, {3.606667769935293*^9, 
  3.606667830860983*^9}, {3.606670580639389*^9, 3.606670588310375*^9}, {
  3.607181497517707*^9, 3.607181498010765*^9}, {3.607189845863757*^9, 
  3.607189887765563*^9}, {3.607190078067212*^9, 3.60719013466696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"meanPersistence", "[", "file_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data", ",", "meanRules"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"data", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"file", ",", "\"\<Table\>\""}], "]"}], ",", "2"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"meanRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"names", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "/.", "meanRules"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6066696189856853`*^9, 3.6066696964070873`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"persistenceCorrelationPlot", "[", 
   RowBox[{"persistenceFile_", ",", "originFile_", ",", "type_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xMax", ",", "yMax", ",", "persist", ",", "pro", ",", "lm", ",", "r", 
      ",", "rho", ",", "rP", ",", "rhoP", ",", "pairs", ",", "pvalue", ",", 
      "ticks", ",", "typeLabel", ",", "rLabel", ",", "rhoLabel"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xMax", "=", "3.5"}], ";", "\[IndentingNewLine]", 
     RowBox[{"yMax", "=", "0.4"}], ";", "\[IndentingNewLine]", 
     RowBox[{"persist", "=", 
      RowBox[{"meanPersistence", "[", "persistenceFile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pro", "=", 
      RowBox[{"globalPro", "[", "originFile", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"pairs", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"persist", ",", "pro"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lm", "=", 
      RowBox[{"LinearModelFit", "[", 
       RowBox[{"pairs", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Correlation", "[", 
       RowBox[{"persist", ",", "pro"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rP", "=", 
      RowBox[{
       RowBox[{"lm", "[", "\"\<ParameterPValues\>\"", "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rho", "=", 
      RowBox[{"SpearmanRho", "[", 
       RowBox[{"persist", ",", "pro"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rhoP", "=", 
      RowBox[{"SpearmanRankTest", "[", 
       RowBox[{"persist", ",", "pro"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pairs", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "#", "}"}], "&"}], ",", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"persist", ",", "pro"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"frameTicks", "[", 
       RowBox[{
       "0", ",", "xMax", ",", "0", ",", "yMax", ",", "0.5", ",", "0.1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"type", ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.03", ",", "0.98"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "Bold", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"\"\<\!\(\*
StyleBox[\"r\",
FontSlant->\"Italic\"]\)\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)= \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"Round", "[", 
             RowBox[{"r", ",", "0.01"}], "]"}], "]"}], "<>", "\"\<, \!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\) = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"Round", "[", 
             RowBox[{"rP", ",", "0.0001"}], "]"}], "]"}]}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.03", ",", "0.88"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rhoLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"\"\<\[Rho]\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)= \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"Round", "[", 
             RowBox[{"rho", ",", "0.01"}], "]"}], "]"}], "<>", "\"\<, \!\(\*
StyleBox[\"P\",
FontSlant->\"Italic\"]\) = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{"Round", "[", 
             RowBox[{"rhoP", ",", "0.0001"}], "]"}], "]"}]}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.03", ",", "0.78"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"pairs", ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"#", ",", 
             RowBox[{"AbsolutePointSize", "[", "6", "]"}]}], "]"}], "&"}], 
          ",", "colorList"}], "]"}]}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.65"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "xMax"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "yMax"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", "ticks"}], ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<Regional persistence\>\"", ",", "\"\<Origin proportion\>\""}], 
         "}"}]}], ",", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"typeLabel", ",", "rLabel", ",", "rhoLabel"}], "}"}]}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606669562979103*^9, 3.6066695912673407`*^9}, {
   3.6066697213162203`*^9, 3.6066699207212553`*^9}, {3.60666996332974*^9, 
   3.6066701379518547`*^9}, {3.606670171312071*^9, 3.606670224569158*^9}, {
   3.606670295521614*^9, 3.606670309478696*^9}, {3.6066705308068666`*^9, 
   3.606670571381459*^9}, {3.606677252609955*^9, 3.606677327539119*^9}, 
   3.6066773724419603`*^9, 3.606677403133677*^9, {3.6066775951275873`*^9, 
   3.606677656403265*^9}, 3.606678271704845*^9, {3.607184199975226*^9, 
   3.607184200513184*^9}, {3.6071842384026814`*^9, 3.6071843715995197`*^9}, {
   3.6071844438967237`*^9, 3.607184456898759*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"persistenceCorrelationPlot", "[", 
   RowBox[{
    RowBox[{
    "stem", "<>", "\"\</stats/\>\"", "<>", "stem", "<>", 
     "\"\<_persistence.tsv\>\""}], ",", 
    RowBox[{"stem", "<>", "\"\</out_hist.skylines\>\""}], ",", "type"}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.606669799466106*^9, 3.606669832033594*^9}, {
   3.6066699333584213`*^9, 3.606669940989993*^9}, {3.606670596094067*^9, 
   3.606670596272469*^9}, 3.6066707097806873`*^9, 3.606677298764216*^9, 
   3.606677334424461*^9, {3.6066776441686077`*^9, 3.606677669173411*^9}, 
   3.6071842210976267`*^9, 3.607184549510651*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"persistColorFunction", "[", "t_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "col", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"col", "=", 
      RowBox[{
       RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "0.3", 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Blend", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"White", ",", "col", ",", 
         RowBox[{"Darker", "[", 
          RowBox[{"col", ",", "0.6"}], "]"}]}], "}"}], ",", 
       RowBox[{"t", "/", "3"}]}], "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5141381800352917`*^9, 3.5141381977597456`*^9}, {
   3.5141382580646825`*^9, 3.5141382859770985`*^9}, 3.5141388972823825`*^9, 
   3.5141390108763824`*^9, {3.5141419913668685`*^9, 3.5141420535708685`*^9}, {
   3.5142095579370346`*^9, 3.514209602899531*^9}, {3.5142096676860085`*^9, 
   3.514209768969136*^9}, {3.514212098661096*^9, 3.51421214454646*^9}, {
   3.5142125687954607`*^9, 3.5142125703944607`*^9}, 3.514214813144457*^9, {
   3.5142148711714573`*^9, 3.5142148794744573`*^9}, {3.514645659195969*^9, 
   3.5146456659194827`*^9}, {3.5147348441026683`*^9, 
   3.5147348503896685`*^9}, {3.5147549314561377`*^9, 
   3.5147549361421375`*^9}, {3.514755612904605*^9, 3.5147556202003345`*^9}, {
   3.5147557055968733`*^9, 3.5147557193242455`*^9}, {3.524341150194163*^9, 
   3.524341181870163*^9}, {3.5243412648431625`*^9, 3.524341265962163*^9}, {
   3.524341321911163*^9, 3.5243413299261627`*^9}, {3.527756089603444*^9, 
   3.527756108292919*^9}, {3.528712908306775*^9, 3.528712948148211*^9}, {
   3.528713653033052*^9, 3.528713763454945*^9}, {3.528713794127141*^9, 
   3.528713806919944*^9}, 3.5287138490970163`*^9, {3.5287138866085253`*^9, 
   3.528714090370517*^9}, {3.5287141228278513`*^9, 3.52871427036867*^9}, {
   3.528714350046898*^9, 3.528714442793103*^9}, {3.5287144884741497`*^9, 
   3.528714524185977*^9}, {3.52871456479205*^9, 3.52871459953341*^9}, {
   3.5287146473197203`*^9, 3.528714653407761*^9}, {3.6013025342124643`*^9, 
   3.60130254470979*^9}, 3.601302596844816*^9, {3.601302668175363*^9, 
   3.601302779184379*^9}, {3.601304053247645*^9, 3.601304054338387*^9}, 
   3.601314197957111*^9, {3.63200306529456*^9, 3.632003098021789*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"persistencePairPlot", "[", 
   RowBox[{"file_", ",", "type_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "names", ",", "colorList", ",", "n", ",", "max", ",", "add", ",", "data",
       ",", "meanRules", ",", "persist", ",", "sidebar", ",", "persistList", 
      ",", "ticks", ",", "typeLabel"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"names", "=", 
      RowBox[{"{", 
       RowBox[{
       "\"\<USACanada\>\"", ",", "\"\<SouthAmerica\>\"", ",", 
        "\"\<Europe\>\"", ",", "\"\<India\>\"", ",", "\"\<NorthChina\>\"", 
        ",", "\"\<SouthChina\>\"", ",", "\"\<China\>\"", ",", 
        "\"\<JapanKorea\>\"", ",", "\"\<SoutheastAsia\>\"", ",", 
        "\"\<Oceania\>\""}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"colorList", "=", 
      RowBox[{"names", "/.", "colorRules"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"max", "=", "3.0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"sidebar", "=", 
      RowBox[{"DensityPlot", "[", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "0", ",", "max"}], "}"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "42.55"}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "persistColorFunction"}], ",", 
        RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "21"}], ",", 
        RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"None", ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"PaddedForm", "[", 
                  RowBox[{"i", ",", 
                   RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", " ", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", " ", "0.3"}], "}"}]}], "}"}], ",", " ", 
               RowBox[{"{", 
                RowBox[{"i", ",", " ", "0", ",", "max", ",", "0.5"}], "}"}]}],
               "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"None", ",", "None"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], "]"}]}], 
        ",", 
        RowBox[{"LabelStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"Black", ",", 
           RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
           RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
        ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", "\"\<                years\>\"", "}"}]}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"5", ",", "31"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"15", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"data", "=", 
      RowBox[{"Drop", "[", 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"file", ",", "\"\<Table\>\""}], "]"}], ",", "2"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"meanRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "&"}], ",", "data"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"meanRules", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"StringReplace", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{
            "\"\<NorthChina_SouthChina_\>\"", "\[Rule]", "\"\<China_\>\""}]}],
            "]"}], "\[Rule]", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "&"}], ",", "meanRules"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"meanRules", "=", 
      RowBox[{"Append", "[", 
       RowBox[{"meanRules", ",", 
        RowBox[{"\"\<China\>\"", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"\"\<NorthChina_SouthChina\>\"", "/.", "meanRules"}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"persist", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"regionA", "\[Equal]", "regionB"}], ",", 
          RowBox[{"regionA", "/.", "meanRules"}], ",", 
          RowBox[{"First", "@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"regionA", "<>", "\"\<_\>\"", "<>", "regionB"}], 
                 ")"}], "/.", "meanRules"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"regionB", "<>", "\"\<_\>\"", "<>", "regionA"}], 
                 ")"}], "/.", "meanRules"}]}], "}"}], ",", 
             RowBox[{"x_", "/;", 
              RowBox[{"NumberQ", "[", "x", "]"}]}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"regionA", ",", "names"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"regionB", ",", "names"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"persistList", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{"n", "+", "1", "-", "i"}], ",", 
            RowBox[{"persist", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ticks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"names", "[", 
                  RowBox[{"[", 
                   RowBox[{"n", "+", "1", "-", "i"}], "]"}], "]"}], "/.", 
                 "shortNameRules"}], ",", 
                RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
                RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
               "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ",", " ", "None"}],
          "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Rotate", "[", 
               RowBox[{
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"names", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "/.", "shortNameRules"}], 
                  ",", 
                  RowBox[{"FontSize", "\[Rule]", "9"}], ",", 
                  RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], 
                 "]"}], ",", 
                RowBox[{"Pi", "/", "2"}]}], "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", " ", "n"}], "}"}]}], "]"}], ",", "None"}], 
         "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"\"\<                     \>\"", "<>", "type"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "1.07"}], "}"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", "Bold", ",", 
            RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
            RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "150"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.05"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Grid", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"typeLabel", ",", "\"\<\>\""}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ListDensityPlot", "[", 
            RowBox[{"persistList", ",", 
             RowBox[{"ImageSize", "\[Rule]", "200"}], ",", 
             RowBox[{"InterpolationOrder", "\[Rule]", "0"}], ",", 
             RowBox[{"ColorFunction", "\[Rule]", "persistColorFunction"}], 
             ",", 
             RowBox[{"Frame", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"True", ",", "True", ",", "False", ",", "False"}], 
               "}"}]}], ",", 
             RowBox[{"PlotRange", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0.5", ",", 
                  RowBox[{"n", "+", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.5", ",", 
                  RowBox[{"n", "+", "0.5"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "max"}], "}"}]}], "}"}]}], ",", 
             RowBox[{"FrameTicks", "\[Rule]", "ticks"}], ",", 
             RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}], ",", 
             RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
             RowBox[{"ClippingStyle", "\[Rule]", 
              RowBox[{"myColorFunction", "[", "max", "]"}]}], ",", 
             RowBox[{"ImagePadding", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"58", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"58", ",", "0"}], "}"}]}], "}"}]}]}], "]"}], ",", 
           "sidebar"}], "}"}]}], "}"}], ",", 
       RowBox[{"Alignment", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"Center", ",", "Top"}], "}"}]}], ",", 
       RowBox[{"Spacings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0.25"}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.606666356181574*^9, 3.6066663634563513`*^9}, {
   3.6066663952994423`*^9, 3.6066664137285147`*^9}, {3.606666451908165*^9, 
   3.606667196650134*^9}, {3.606667315663821*^9, 3.6066673239403763`*^9}, {
   3.606667388057116*^9, 3.606667469000414*^9}, {3.606667769935293*^9, 
   3.606667830860983*^9}, {3.606670580639389*^9, 3.606670588310375*^9}, {
   3.607181497517707*^9, 3.607181498010765*^9}, {3.607189845863757*^9, 
   3.607189887765563*^9}, {3.607190078067212*^9, 3.60719013466696*^9}, {
   3.632001789015881*^9, 3.632002116889463*^9}, {3.6320021650660057`*^9, 
   3.632002177886633*^9}, {3.632002260607766*^9, 3.632002350587344*^9}, {
   3.6320024294235287`*^9, 3.632002439201294*^9}, {3.632002529398963*^9, 
   3.6320025295005207`*^9}, {3.632002791244379*^9, 3.632002814995509*^9}, {
   3.6320028570406*^9, 3.632002904162331*^9}, {3.6320029399296293`*^9, 
   3.63200297763247*^9}, 3.632003020870676*^9, {3.632003071482568*^9, 
   3.632003078873835*^9}, {3.632003225036178*^9, 3.632003250892989*^9}, {
   3.632003397405665*^9, 3.632003448454156*^9}, {3.632003495893002*^9, 
   3.632003503984728*^9}, {3.6320035463711443`*^9, 3.632003552185874*^9}, 
   3.632011924505535*^9, {3.6320119896878157`*^9, 3.632012067915866*^9}, {
   3.6320125602309628`*^9, 3.632012571223426*^9}, {3.632012626119853*^9, 
   3.6320126974578943`*^9}, {3.6320127598662453`*^9, 3.632012904302073*^9}, {
   3.6322346750908327`*^9, 3.632234702343481*^9}, {3.632234737068941*^9, 
   3.632235075760067*^9}, {3.632236099038601*^9, 3.63223617416555*^9}, {
   3.632236206102643*^9, 3.63223625784201*^9}, {3.6322363596993217`*^9, 
   3.632236416721374*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Combined figures", "Title",
 CellChangeTimes->{{3.6062496951664886`*^9, 3.606249696297647*^9}, {
  3.606250688174419*^9, 3.606250689034192*^9}}],

Cell[CellGroupData[{

Cell["Trees", "Subsection",
 CellChangeTimes->{{3.6062496980011597`*^9, 3.606249698716076*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"treePlot", "[", 
   RowBox[{"file_", ",", "type_", ",", "height_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
      "ids", ",", "drop", ",", "antigenic", ",", "typeLabel", ",", "legend"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
        "ids", ",", "antigenic"}], "}"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"ToExpression", "[", "rules", "]"}]}], ";", 
     RowBox[{"labels", "=", 
      RowBox[{"ToExpression", "[", "labels", "]"}]}], ";", 
     RowBox[{"coords", "=", 
      RowBox[{"ToExpression", "[", "coords", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"labels", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "labels"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ids", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"array", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\<->\>\""}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"array", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"array", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], ",", "ids"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"drop", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"ids", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"removeTips", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tips", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"tips", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", "x"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"rules", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"type", ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "height"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "Bold", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"legend", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"AbsolutePointSize", "[", "7", "]"}], ",", 
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#1", "/.", "colorRules"}], ",", 
             RowBox[{"Point", "[", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.02", ",", 
                 RowBox[{"0.97", "-", 
                  RowBox[{"0.045", "*", 
                   RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], "]"}], "]"}],
              ",", "Black", ",", 
             RowBox[{"Style", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{
                 RowBox[{"#1", "/.", "fullNameRules"}], ",", 
                 RowBox[{"Scaled", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.06", ",", 
                    RowBox[{"0.97", "-", 
                    RowBox[{"0.045", "*", 
                    RowBox[{"#2", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
                 RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
                 "Black"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "names"}], 
         "]"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"typeLabel", ",", "legend", ",", 
         RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", "labels"}], "/.", 
               "colorRules"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"coordsA", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "coords"}]}], ",", 
                  RowBox[{"coordsB", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "coords"}]}]}], 
                 "}"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{"coordsA", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coordsB", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"coordsA", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "coordsB"}],
                   "}"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "rules"}], 
          "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "/.", "labels"}], "/.", "colorRules"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Point", "[", 
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coords"}], ")"}], "]"}], ",", 
                RowBox[{"#", "/.", "ids"}]}], "]"}]}], "}"}], "&"}], ",", 
           "tips"}], "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.85"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", "0.03", "]"}], ",", "0"}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
       ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6012600996616993`*^9, 3.6012601872290697`*^9}, {
   3.60126024090471*^9, 3.6012602535988007`*^9}, {3.601260302395293*^9, 
   3.601260302911364*^9}, {3.6012604345679693`*^9, 3.601260434739829*^9}, {
   3.6062499831831703`*^9, 3.606249986958583*^9}, {3.606250097194161*^9, 
   3.606250155534173*^9}, {3.606250215824551*^9, 3.6062502317638903`*^9}, {
   3.606250277741436*^9, 3.606250301313278*^9}, 3.606250347733713*^9, {
   3.6062504280606318`*^9, 3.606250497585043*^9}, {3.60667130379009*^9, 
   3.606671321471459*^9}, 3.6071248833413343`*^9, {3.6071889351341343`*^9, 
   3.607188951528082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"treePlotNoLegend", "[", 
   RowBox[{"file_", ",", "type_", ",", "height_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
      "ids", ",", "drop", ",", "antigenic", ",", "typeLabel", ",", "legend"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
        "ids", ",", "antigenic"}], "}"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"ToExpression", "[", "rules", "]"}]}], ";", 
     RowBox[{"labels", "=", 
      RowBox[{"ToExpression", "[", "labels", "]"}]}], ";", 
     RowBox[{"coords", "=", 
      RowBox[{"ToExpression", "[", "coords", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"labels", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "labels"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ids", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"array", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\<->\>\""}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"array", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"array", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], ",", "ids"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"drop", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"ids", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"removeTips", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tips", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"tips", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", "x"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"rules", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"type", ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "height"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "Bold", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"typeLabel", ",", 
         RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", "labels"}], "/.", 
               "colorRules"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"coordsA", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "coords"}]}], ",", 
                  RowBox[{"coordsB", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "coords"}]}]}], 
                 "}"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{"coordsA", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coordsB", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"coordsA", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "coordsB"}],
                   "}"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "rules"}], 
          "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "/.", "labels"}], "/.", "colorRules"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Point", "[", 
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coords"}], ")"}], "]"}], ",", 
                RowBox[{"#", "/.", "ids"}]}], "]"}]}], "}"}], "&"}], ",", 
           "tips"}], "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "350"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.85"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", "0.03", "]"}], ",", "0"}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
       ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6012600996616993`*^9, 3.6012601872290697`*^9}, {
   3.60126024090471*^9, 3.6012602535988007`*^9}, {3.601260302395293*^9, 
   3.601260302911364*^9}, {3.6012604345679693`*^9, 3.601260434739829*^9}, {
   3.6062498497553253`*^9, 3.606249863994462*^9}, {3.606249991796113*^9, 
   3.606249992800028*^9}, {3.606250104820897*^9, 3.6062501057244463`*^9}, 
   3.606250160229519*^9, {3.606250235164617*^9, 3.606250239075603*^9}, 
   3.606250304074325*^9, 3.6062503496461773`*^9, 3.607124885922031*^9, {
   3.607188938626986*^9, 3.607188945990184*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlot", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_all.rules\>\"", ",", "\"\<H3N2\>\"", ",", 
          "0.09"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_all.rules\>\"", ",", "\"\<H1N1\>\"", ",", 
          "0.22"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_all.rules\>\"", ",", "\"\<Vic\>\"", ",", 
          "0.13"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_all.rules\>\"", ",", "\"\<Yam\>\"", ",", 
          "0.2"}], "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.607124408705061*^9, 3.607124419554524*^9}, {3.607124454561355*^9, 
   3.607124456258416*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/trees.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/trees.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlot", "[", 
         RowBox[{
         "\"\<h3_small_geo/out_all.rules\>\"", ",", "\"\<H3N2\>\"", ",", 
          "0.2"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_small_geo/out_all.rules\>\"", ",", "\"\<H1N1\>\"", ",", 
          "0.22"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_small_geo/out_all.rules\>\"", ",", "\"\<Vic\>\"", ",", 
          "0.13"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_small_geo/out_all.rules\>\"", ",", "\"\<Yam\>\"", ",", 
          "0.2"}], "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.6066744498279037`*^9, 3.6066744614749203`*^9}, {3.606674539460725*^9, 
   3.6066746237280273`*^9}, {3.607124434896988*^9, 3.607124458625247*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/trees_small.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606674636254355*^9, 3.6066746371061153`*^9}, {
   3.6071244275917397`*^9, 3.607124428254178*^9}, {3.607129827676285*^9, 
   3.607129831187078*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/trees_small.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606674641874394*^9, 
   3.606674642706258*^9}, {3.607124430310032*^9, 3.607124432510065*^9}, {
   3.607129833515026*^9, 3.6071298368666*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Histories", "Subsection",
 CellChangeTimes->{{3.606251769795327*^9, 3.606251771106207*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"numberToString", "[", "i", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{"0", ",", " ", "0.01"}], "}"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "0", ",", " ", "5"}], "}"}]}], "]"}], ",", " ", 
      "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}, {3.606251544957864*^9, 
   3.606251554396941*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"historyPlot", "[", 
   RowBox[{"file_", ",", "fromRegion_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rNames", ",", "rColorList", ",", "start", ",", "stop", ",", "skls", ",",
       "length", ",", "timelist", ",", "skltable"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rNames", "=", 
      RowBox[{"Reverse", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rColorList", "=", 
      RowBox[{"Reverse", "[", "colorList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"start", "=", "0"}], ";", 
     RowBox[{"stop", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"skls", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"length", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<prohist_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"timelist", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<prohist_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "length", "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"list", " ", "=", " ", 
              RowBox[{"Select", "[", 
               RowBox[{"skls", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "==", 
                  RowBox[{
                  "\"\<prohist_\>\"", "<>", "fromRegion", "<>", "\"\<_\>\"", "<>",
                    "i"}]}], "&"}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", " ", "4"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "rNames"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Accumulate", "[", "skltable", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"timelist", "[", 
            RowBox[{"[", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "#1"}], 
          "}"}], "&"}], ",", "skltable", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"skltable", ",", 
       RowBox[{"PlotRange", " ", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"start", ",", "stop"}], "}"}], ",", "All"}], "}"}]}], ",", 
       
       RowBox[{"Filling", " ", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", "+", "1"}], "}"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Lighter", "[", 
               RowBox[{
                RowBox[{"rColorList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0.35"}], "]"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.5", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.25", "]"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "150"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.15", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.05", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "10"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"12", ",", "5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"fromRegion", "/.", "fullNameRules"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0.5"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", 
                RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"Pi", "/", "2"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0.5"}], "}"}]}], "]"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.575809271407324*^9, 3.5758093155100193`*^9}, 
   3.575809922124495*^9, {3.575973312067293*^9, 3.575973324542577*^9}, {
   3.59391175064878*^9, 3.5939117507860937`*^9}, 3.59391201698888*^9, {
   3.59950881498554*^9, 3.599508822694296*^9}, 3.599534681118429*^9, {
   3.606251347384489*^9, 3.6062513650919447`*^9}, {3.606251395636416*^9, 
   3.606251437417556*^9}, 3.6062530562124443`*^9, {3.606675439179229*^9, 
   3.606675439615226*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"historyPlot", "[", 
   RowBox[{"file_", ",", "fromRegion_", ",", "padding_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rNames", ",", "rColorList", ",", "start", ",", "stop", ",", "skls", ",",
       "length", ",", "timelist", ",", "skltable"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rNames", "=", 
      RowBox[{"Reverse", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rColorList", "=", 
      RowBox[{"Reverse", "[", "colorList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"start", "=", "0"}], ";", 
     RowBox[{"stop", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"skls", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"length", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<prohist_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"timelist", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<prohist_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "length", "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"list", " ", "=", " ", 
              RowBox[{"Select", "[", 
               RowBox[{"skls", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "==", 
                  RowBox[{
                  "\"\<prohist_\>\"", "<>", "fromRegion", "<>", "\"\<_\>\"", "<>",
                    "i"}]}], "&"}]}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", " ", "4"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "rNames"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Accumulate", "[", "skltable", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"timelist", "[", 
            RowBox[{"[", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "#1"}], 
          "}"}], "&"}], ",", "skltable", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{"skltable", ",", 
       RowBox[{"PlotRange", " ", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"start", ",", "stop"}], "}"}], ",", "All"}], "}"}]}], ",", 
       
       RowBox[{"Filling", " ", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"i", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", "+", "1"}], "}"}], ",", 
             RowBox[{"Directive", "[", 
              RowBox[{"Lighter", "[", 
               RowBox[{
                RowBox[{"rColorList", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "0.35"}], "]"}], 
              "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"Axes", "\[Rule]", "False"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.5", "]"}], ",", 
          RowBox[{"GrayLevel", "[", "0.25", "]"}]}], "]"}]}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "150"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.33"}], ",", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.05", ",", "0"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", "padding"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.575809271407324*^9, 3.5758093155100193`*^9}, 
   3.575809922124495*^9, {3.575973312067293*^9, 3.575973324542577*^9}, {
   3.59391175064878*^9, 3.5939117507860937`*^9}, 3.59391201698888*^9, {
   3.59950881498554*^9, 3.599508822694296*^9}, 3.599534681118429*^9, {
   3.606251347384489*^9, 3.6062513650919447`*^9}, {3.606251395636416*^9, 
   3.606251437417556*^9}, {3.606252670649351*^9, 3.606252733385681*^9}, {
   3.606252814656994*^9, 3.606252876243878*^9}, {3.6062529631839943`*^9, 
   3.6062529899635687`*^9}, {3.6062530410894814`*^9, 3.606253061749484*^9}, {
   3.60625341331808*^9, 3.60625342195028*^9}, {3.606253948135727*^9, 
   3.606253948375745*^9}, {3.606675436972414*^9, 3.606675437386402*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subsetNames", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<USACanada\>\"", ",", "\"\<SouthAmerica\>\"", ",", "\"\<India\>\"", 
     ",", "\"\<SouthChina\>\"", ",", "\"\<SoutheastAsia\>\""}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606251798700965*^9, 3.606251806927092*^9}, {
  3.606251858696835*^9, 3.6062518619129763`*^9}, {3.606252201361053*^9, 
  3.6062522076567183`*^9}, {3.606252298134789*^9, 3.606252306697899*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stems", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<h3_large_geo\>\"", ",", "\"\<h1_large_geo\>\"", ",", 
     "\"\<vic_large_geo\>\"", ",", "\"\<yam_large_geo\>\""}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6062518125125017`*^9, 3.606251854540258*^9}, {
  3.607124469552854*^9, 3.6071244849175034`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"historyFigs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"name", "=", 
          RowBox[{"subsetNames", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"stem", "=", 
          RowBox[{"stems", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"historyPlot", "[", 
        RowBox[{
         RowBox[{"stem", "<>", "\"\</out_hist.skylines\>\""}], ",", "name", 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", 
            RowBox[{"Length", "[", "subsetNames", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"5", ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"12", ",", "3"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"5", ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "subsetNames", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "stems", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606253080719048*^9, 3.606253115144146*^9}, {
   3.606253189739489*^9, 3.6062533590562983`*^9}, {3.606253425846538*^9, 
   3.6062534416014*^9}, {3.606253988804587*^9, 3.6062539889567842`*^9}, {
   3.606254323294338*^9, 3.606254350428227*^9}, {3.606675082247533*^9, 
   3.6066750900143547`*^9}, 3.606675752731533*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rowLabels", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"\"\< \>\"", "<>", 
               RowBox[{"(", 
                RowBox[{"#", "/.", "shortNameRules"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"Pi", "/", "2"}]}], "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "4"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "15"}]}], "]"}], "&"}], ",", 
     "subsetNames"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606252463126487*^9, 3.606252600424962*^9}, {
  3.60625276431244*^9, 3.60625279060115*^9}, {3.606252886628378*^9, 
  3.606252933943994*^9}, {3.606253006523663*^9, 3.606253007100675*^9}, {
  3.606253373431582*^9, 3.606253382366*^9}, {3.606675556919907*^9, 
  3.606675582048563*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paddedHistoryFigs", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "rowLabels", "}"}], ",", 
      RowBox[{"Transpose", "[", "historyFigs", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606252608095601*^9, 3.606252660484232*^9}, {
  3.606253172406109*^9, 3.6062531999421453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"yearLabel", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"\"\<Year\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.6"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
       RowBox[{"{", "4", "}"}]}], "]"}], ",", "\"\<\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606254013531686*^9, 3.606254094111887*^9}, {
  3.60625412823622*^9, 3.606254128357676*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stemLabel", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", 
                RowBox[{"StringSplit", "[", 
                 RowBox[{"#", ",", "\"\<_\>\""}], "]"}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<h3\>\"", "\[Rule]", "\"\<H3N2\>\""}], ",", 
                 RowBox[{"\"\<h1\>\"", "\[Rule]", "\"\<H1N1\>\""}], ",", 
                 RowBox[{"\"\<vic\>\"", "\[Rule]", "\"\<Vic\>\""}], ",", 
                 RowBox[{"\"\<yam\>\"", "\[Rule]", "\"\<Yam\>\""}]}], "}"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], "&"}], ",", 
       "stems"}], "]"}], ",", "\"\<\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606254013531686*^9, 3.606254094111887*^9}, {
  3.60625412823622*^9, 3.6062542409921513`*^9}, {3.606254365792667*^9, 
  3.606254365913007*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paddedHistoryFigs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "stemLabel", "}"}], ",", "paddedHistoryFigs", ",", 
     RowBox[{"{", "yearLabel", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606254100267014*^9, 3.606254121276267*^9}, {
  3.606254229495501*^9, 3.606254232353771*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"paddedHistoryFigs", ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606252139832671*^9, 3.606252154979186*^9}, {
   3.6062521856274*^9, 3.606252194427331*^9}, {3.606252228001419*^9, 
   3.606252238075222*^9}, {3.606252417648424*^9, 3.606252421559943*^9}, 
   3.606252663188645*^9, 3.6062536048961153`*^9, 3.606253919511977*^9, {
   3.6062542741662903`*^9, 3.606254277195239*^9}, 3.606254336970273*^9, 
   3.60625437881701*^9, 3.606675417706599*^9, 3.6066756077146606`*^9, 
   3.606675697800555*^9, 3.606675851492103*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/histories.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606254290381599*^9, 3.606254291420542*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/histories.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, 3.606254294035791*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"historyFigs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"name", "=", 
          RowBox[{"names", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"stem", "=", 
          RowBox[{"stems", "[", 
           RowBox[{"[", "j", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"historyPlot", "[", 
        RowBox[{
         RowBox[{"stem", "<>", "\"\</out_hist.skylines\>\""}], ",", "name", 
         ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[Equal]", "n"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"5", ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"12", ",", "3"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"5", ",", "8"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"3", ",", "3"}], "}"}]}], "}"}]}], "]"}]}], "]"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "n"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "stems", "]"}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606253080719048*^9, 3.606253115144146*^9}, {
   3.606253189739489*^9, 3.6062533590562983`*^9}, {3.606253425846538*^9, 
   3.6062534416014*^9}, {3.606253988804587*^9, 3.6062539889567842`*^9}, {
   3.606254323294338*^9, 3.606254350428227*^9}, {3.606675082247533*^9, 
   3.606675124752954*^9}, 3.6066757569495907`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rowLabels", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"\"\< \>\"", "<>", 
               RowBox[{"(", 
                RowBox[{"#", "/.", "shortNameRules"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"Pi", "/", "2"}]}], "]"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "4"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "15"}]}], "]"}], "&"}], ",", 
     "names"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606252463126487*^9, 3.606252600424962*^9}, {
  3.60625276431244*^9, 3.60625279060115*^9}, {3.606252886628378*^9, 
  3.606252933943994*^9}, {3.606253006523663*^9, 3.606253007100675*^9}, {
  3.606253373431582*^9, 3.606253382366*^9}, {3.606675137815399*^9, 
  3.606675138313868*^9}, {3.60667561903967*^9, 3.606675621081007*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paddedHistoryFigs", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"{", "rowLabels", "}"}], ",", 
      RowBox[{"Transpose", "[", "historyFigs", "]"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606252608095601*^9, 3.606252660484232*^9}, {
  3.606253172406109*^9, 3.6062531999421453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"yearLabel", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{"\"\<Year\>\"", ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
             RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.6"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], ",", 
       RowBox[{"{", "4", "}"}]}], "]"}], ",", "\"\<\>\""}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.606254013531686*^9, 3.606254094111887*^9}, {
  3.60625412823622*^9, 3.606254128357676*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stemLabel", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"First", "[", 
                RowBox[{"StringSplit", "[", 
                 RowBox[{"#", ",", "\"\<_\>\""}], "]"}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<h3\>\"", "\[Rule]", "\"\<H3N2\>\""}], ",", 
                 RowBox[{"\"\<h1\>\"", "\[Rule]", "\"\<H1N1\>\""}], ",", 
                 RowBox[{"\"\<vic\>\"", "\[Rule]", "\"\<Vic\>\""}], ",", 
                 RowBox[{"\"\<yam\>\"", "\[Rule]", "\"\<Yam\>\""}]}], "}"}]}],
               ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "10"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "30"}]}], "]"}], "&"}], ",", 
       "stems"}], "]"}], ",", "\"\<\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606254013531686*^9, 3.606254094111887*^9}, {
  3.60625412823622*^9, 3.6062542409921513`*^9}, {3.606254365792667*^9, 
  3.606254365913007*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paddedHistoryFigs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", "stemLabel", "}"}], ",", "paddedHistoryFigs", ",", 
     RowBox[{"{", "yearLabel", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606254100267014*^9, 3.606254121276267*^9}, {
  3.606254229495501*^9, 3.606254232353771*^9}, {3.606675157076665*^9, 
  3.606675167831658*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"paddedHistoryFigs", ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606252139832671*^9, 3.606252154979186*^9}, {
   3.6062521856274*^9, 3.606252194427331*^9}, {3.606252228001419*^9, 
   3.606252238075222*^9}, {3.606252417648424*^9, 3.606252421559943*^9}, 
   3.606252663188645*^9, 3.6062536048961153`*^9, 3.606253919511977*^9, {
   3.6062542741662903`*^9, 3.606254277195239*^9}, 3.606254336970273*^9, 
   3.60625437881701*^9, {3.606675169912012*^9, 3.606675181115144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/full_histories.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606254290381599*^9, 3.606254291420542*^9}, {
   3.606675189248208*^9, 3.606675191774475*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/full_histories.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, 3.606254294035791*^9, {
   3.6066751944088182`*^9, 3.606675195310878*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Maps", "Subsection",
 CellChangeTimes->{{3.606594337670182*^9, 3.606594338125354*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mapPlot", "[", 
          RowBox[{
          "\"\<h3_large_geo/h3_large_geo.log\>\"", ",", 
           "\"\<h3_large_geo/out_hist.skylines\>\"", ",", "\"\<H3N2\>\""}], 
          "]"}], ",", 
         RowBox[{"mapPlot", "[", 
          RowBox[{
          "\"\<h1_large_geo/h1_large_geo.log\>\"", ",", 
           "\"\<h1_large_geo/out_hist.skylines\>\"", ",", "\"\<H1N1\>\""}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"mapPlot", "[", 
          RowBox[{
          "\"\<vic_large_geo/vic_large_geo.log\>\"", ",", 
           "\"\<vic_large_geo/out_hist.skylines\>\"", ",", "\"\<Vic\>\""}], 
          "]"}], ",", 
         RowBox[{"mapPlot", "[", 
          RowBox[{
          "\"\<yam_large_geo/yam_large_geo.log\>\"", ",", 
           "\"\<yam_large_geo/out_hist.skylines\>\"", ",", "\"\<Yam\>\""}], 
          "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.606660106769579*^9, 3.606660178550362*^9}, {3.606660311701645*^9, 
   3.606660315351345*^9}, {3.6066609390995398`*^9, 3.60666096794207*^9}, {
   3.607124499856464*^9, 3.607124519779963*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.63200172942734*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/maps.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606660997679592*^9, 3.606660997986701*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/maps.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, 3.606661000384609*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Persistence", "Subsection",
 CellChangeTimes->{{3.606667346335738*^9, 3.606667347588798*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"persistencePlot", "[", 
          RowBox[{
          "\"\<h3_large_geo/stats/h3_large_geo_persistence.tsv\>\"", ",", 
           "\"\<H3N2\>\""}], "]"}], ",", 
         RowBox[{"persistencePlot", "[", 
          RowBox[{
          "\"\<h1_large_geo/stats/h1_large_geo_persistence.tsv\>\"", ",", 
           "\"\<H1N1\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"persistencePlot", "[", 
          RowBox[{
          "\"\<vic_large_geo/stats/vic_large_geo_persistence.tsv\>\"", ",", 
           "\"\<Vic\>\""}], "]"}], ",", 
         RowBox[{"persistencePlot", "[", 
          RowBox[{
          "\"\<yam_large_geo/stats/yam_large_geo_persistence.tsv\>\"", ",", 
           "\"\<Yam\>\""}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606667354198214*^9, 3.606667377181322*^9}, {
   3.606667497425684*^9, 3.606667572380024*^9}, {3.606670608545211*^9, 
   3.6066706231883783`*^9}, {3.6071245408462687`*^9, 3.607124551133484*^9}, 
   3.632001731699498*^9, 3.632012973545176*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606660997679592*^9, 3.606660997986701*^9}, {
   3.606668246217551*^9, 3.60666824730586*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], "]"}],
   ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, 3.606661000384609*^9, 
   3.6066682496712112`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Persistence amalgamated", "Subsection",
 CellChangeTimes->{{3.632012939079649*^9, 3.632012942355741*^9}, {
  3.6322343171509733`*^9, 3.632234320440292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistencePairPlot", "[", 
            RowBox[{
            "\"\<h3_large_geo/stats/h3_large_geo_persistence.tsv\>\"", ",", 
             "\"\<H3N2\>\""}], "]"}], ",", "\"\<a\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}], ",", 
         
         RowBox[{"persistencePairPlot", "[", 
          RowBox[{
          "\"\<h1_large_geo/stats/h1_large_geo_persistence.tsv\>\"", ",", 
           "\"\<H1N1\>\""}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"persistencePairPlot", "[", 
          RowBox[{
          "\"\<vic_large_geo/stats/vic_large_geo_persistence.tsv\>\"", ",", 
           "\"\<Vic\>\""}], "]"}], ",", 
         RowBox[{"persistencePairPlot", "[", 
          RowBox[{
          "\"\<yam_large_geo/stats/yam_large_geo_persistence.tsv\>\"", ",", 
           "\"\<Yam\>\""}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606667354198214*^9, 3.606667377181322*^9}, {
   3.606667497425684*^9, 3.606667572380024*^9}, {3.606670608545211*^9, 
   3.6066706231883783`*^9}, {3.6071245408462687`*^9, 3.607124551133484*^9}, 
   3.632001731699498*^9, {3.632003126996209*^9, 3.632003130405135*^9}, 
   3.6320129647624893`*^9, {3.632235402124446*^9, 3.632235405760746*^9}, 
   3.632235502215982*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"figA", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistencePairPlot", "[", 
            RowBox[{
            "\"\<h3_large_geo/stats/h3_large_geo_persistence.tsv\>\"", ",", 
             "\"\<H3N2\>\""}], "]"}], ",", "\"\<a\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}], ",", 
         
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistencePairPlot", "[", 
            RowBox[{
            "\"\<h1_large_geo/stats/h1_large_geo_persistence.tsv\>\"", ",", 
             "\"\<H1N1\>\""}], "]"}], ",", "\"\<\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistencePairPlot", "[", 
            RowBox[{
            "\"\<vic_large_geo/stats/vic_large_geo_persistence.tsv\>\"", ",", 
             "\"\<Vic\>\""}], "]"}], ",", "\"\<\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}], ",", 
         
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistencePairPlot", "[", 
            RowBox[{
            "\"\<yam_large_geo/stats/yam_large_geo_persistence.tsv\>\"", ",", 
             "\"\<Yam\>\""}], "]"}], ",", "\"\<\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606667354198214*^9, 3.606667377181322*^9}, {
   3.606667497425684*^9, 3.606667572380024*^9}, {3.606670608545211*^9, 
   3.6066706231883783`*^9}, {3.6071245408462687`*^9, 3.607124551133484*^9}, 
   3.632001731699498*^9, {3.632003126996209*^9, 3.632003130405135*^9}, 
   3.6320129647624893`*^9, {3.632235402124446*^9, 3.632235405760746*^9}, {
   3.632235439345373*^9, 3.6322354893548193`*^9}, {3.632235614930191*^9, 
   3.6322356176089697`*^9}, 3.632235650056546*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence_amalgamation.png\>\"", ",", "fig", ",", 
    "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606660997679592*^9, 3.606660997986701*^9}, {
   3.606668246217551*^9, 3.60666824730586*^9}, {3.606670688348261*^9, 
   3.606670693338957*^9}, {3.632012952873596*^9, 3.632012955367885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence_amalgamation.pdf\>\"", ",", "fig", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, 3.606661000384609*^9, 
   3.6066682496712112`*^9, {3.606670697216777*^9, 3.606670697478945*^9}, 
   3.632012957851202*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Persistence correlation", "Subsection",
 CellChangeTimes->{{3.606670320274783*^9, 3.606670323198604*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"persistenceCorrelationPlot", "[", 
          RowBox[{
          "\"\<h3_large_geo/stats/h3_large_geo_persistence.tsv\>\"", ",", 
           "\"\<h3_large_geo/out_hist.skylines\>\"", ",", "\"\<H3N2\>\""}], 
          "]"}], ",", 
         RowBox[{"persistenceCorrelationPlot", "[", 
          RowBox[{
          "\"\<h1_large_geo/stats/h1_large_geo_persistence.tsv\>\"", ",", 
           "\"\<h1_large_geo/out_hist.skylines\>\"", ",", "\"\<H1N1\>\""}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"persistenceCorrelationPlot", "[", 
          RowBox[{
          "\"\<vic_large_geo/stats/vic_large_geo_persistence.tsv\>\"", ",", 
           "\"\<vic_large_geo/out_hist.skylines\>\"", ",", "\"\<Vic\>\""}], 
          "]"}], ",", 
         RowBox[{"persistenceCorrelationPlot", "[", 
          RowBox[{
          "\"\<yam_large_geo/stats/yam_large_geo_persistence.tsv\>\"", ",", 
           "\"\<yam_large_geo/out_hist.skylines\>\"", ",", "\"\<Yam\>\""}], 
          "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606667354198214*^9, 3.606667377181322*^9}, {
   3.606667497425684*^9, 3.606667572380024*^9}, {3.6066703278529987`*^9, 
   3.6066703335167017`*^9}, {3.6066703641980753`*^9, 3.606670417414175*^9}, {
   3.6066704871020937`*^9, 3.606670525363853*^9}, {3.607124605711954*^9, 
   3.607124632438683*^9}, {3.6071297335039062`*^9, 3.607129734405752*^9}, {
   3.607132784444892*^9, 3.607132784795621*^9}, 3.607184385137478*^9, 
   3.607184541969654*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"figB", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistenceCorrelationPlot", "[", 
            RowBox[{
            "\"\<h3_large_geo/stats/h3_large_geo_persistence.tsv\>\"", ",", 
             "\"\<h3_large_geo/out_hist.skylines\>\"", ",", "\"\<H3N2\>\""}], 
            "]"}], ",", "\"\<b\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}], ",", 
         
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistenceCorrelationPlot", "[", 
            RowBox[{
            "\"\<h1_large_geo/stats/h1_large_geo_persistence.tsv\>\"", ",", 
             "\"\<h1_large_geo/out_hist.skylines\>\"", ",", "\"\<H1N1\>\""}], 
            "]"}], ",", "\"\<\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistenceCorrelationPlot", "[", 
            RowBox[{
            "\"\<vic_large_geo/stats/vic_large_geo_persistence.tsv\>\"", ",", 
             "\"\<vic_large_geo/out_hist.skylines\>\"", ",", "\"\<Vic\>\""}], 
            "]"}], ",", "\"\<\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}], ",", 
         
         RowBox[{"Labeled", "[", 
          RowBox[{
           RowBox[{"persistenceCorrelationPlot", "[", 
            RowBox[{
            "\"\<yam_large_geo/stats/yam_large_geo_persistence.tsv\>\"", ",", 
             "\"\<yam_large_geo/out_hist.skylines\>\"", ",", "\"\<Yam\>\""}], 
            "]"}], ",", "\"\<\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Top", ",", "Left"}], "}"}], "}"}], ",", 
           RowBox[{"BaselinePosition", "\[Rule]", "Bottom"}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", "Bold", ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "13"}]}], "]"}]}]}], "]"}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606667354198214*^9, 3.606667377181322*^9}, {
   3.606667497425684*^9, 3.606667572380024*^9}, {3.606670608545211*^9, 
   3.6066706231883783`*^9}, {3.6071245408462687`*^9, 3.607124551133484*^9}, 
   3.632001731699498*^9, {3.632003126996209*^9, 3.632003130405135*^9}, 
   3.6320129647624893`*^9, {3.632235402124446*^9, 3.632235405760746*^9}, {
   3.632235439345373*^9, 3.6322354893548193`*^9}, {3.6322355279085207`*^9, 
   3.632235549130021*^9}, {3.632235603954302*^9, 3.632235605337833*^9}, 
   3.632235646551947*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence_correlation.png\>\"", ",", "fig", ",", 
    "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606660997679592*^9, 3.606660997986701*^9}, {
   3.606668246217551*^9, 3.60666824730586*^9}, {3.606670688348261*^9, 
   3.606670693338957*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence_correlation.pdf\>\"", ",", "fig", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, 3.606661000384609*^9, 
   3.6066682496712112`*^9, {3.606670697216777*^9, 3.606670697478945*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Persistence follow-up", "Subsection",
 CellChangeTimes->{{3.6322355604804497`*^9, 3.6322355690208406`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "figA", "}"}], ",", 
       RowBox[{"{", "figB", "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.632235570262207*^9, 3.6322355828136663`*^9}, {
   3.6322356421496763`*^9, 3.632235655236215*^9}, 3.6322361882420187`*^9, 
   3.6322365853290997`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence_followup.png\>\"", ",", "fig", ",", "\"\<PNG\>\"",
     ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606660997679592*^9, 3.606660997986701*^9}, {
   3.606668246217551*^9, 3.60666824730586*^9}, {3.606670688348261*^9, 
   3.606670693338957*^9}, {3.632235663045219*^9, 3.6322356643477163`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/persistence_followup.pdf\>\"", ",", "fig", ",", 
    "\"\<PDF\>\""}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, 3.606661000384609*^9, 
   3.6066682496712112`*^9, {3.606670697216777*^9, 3.606670697478945*^9}, 
   3.6322356664468393`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regional trees H3", "Subsection",
 CellChangeTimes->{{3.6066710401514482`*^9, 3.60667104254005*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlot", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_usa.rules\>\"", ",", "\"\<H3N2\>\"", ",", 
          "1.01"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_sa.rules\>\"", ",", "\"\<\>\"", ",", "1"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1"}], 
         "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", "1"}],
          "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.606671046953845*^9, 3.606671063524207*^9}, {3.606671105927994*^9, 
   3.606671181064802*^9}, {3.606671219922063*^9, 3.606671264924569*^9}, {
   3.6066713094523077`*^9, 3.606671337481825*^9}, {3.606671416031417*^9, 
   3.606671423318288*^9}, {3.607124637173997*^9, 3.607124644653777*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/h3_regional_trees.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", 
    ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606671349833582*^9, 3.606671352399167*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/h3_regional_trees.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606671355924122*^9, 
   3.606671360264675*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regional trees H1", "Subsection",
 CellChangeTimes->{{3.6066710401514482`*^9, 3.60667104254005*^9}, {
  3.606671431965562*^9, 3.606671432066187*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlot", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_usa.rules\>\"", ",", "\"\<H1N1\>\"", ",", 
          "1.01"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_sa.rules\>\"", ",", "\"\<\>\"", ",", "1"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1"}], 
         "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", "1"}],
          "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.606671046953845*^9, 3.606671063524207*^9}, {3.606671105927994*^9, 
   3.606671181064802*^9}, {3.606671219922063*^9, 3.606671264924569*^9}, {
   3.6066713094523077`*^9, 3.606671337481825*^9}, {3.606671416031417*^9, 
   3.606671445377943*^9}, 3.606671550546733*^9, {3.607124653005644*^9, 
   3.607124657662513*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/h1_regional_trees.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", 
    ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606671349833582*^9, 3.606671352399167*^9}, {
   3.606671555616131*^9, 3.606671555717093*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/h1_regional_trees.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606671355924122*^9, 
   3.606671360264675*^9}, {3.606671558497725*^9, 3.6066715586173553`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regional trees Vic", "Subsection",
 CellChangeTimes->{{3.6066710401514482`*^9, 3.60667104254005*^9}, {
  3.606671431965562*^9, 3.606671432066187*^9}, {3.6066715714447317`*^9, 
  3.6066715722739763`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlot", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_usa.rules\>\"", ",", "\"\<Vic\>\"", ",", 
          "1.01"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_sa.rules\>\"", ",", "\"\<\>\"", ",", "1"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1"}],
          "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", 
          "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.606671046953845*^9, 3.606671063524207*^9}, {3.606671105927994*^9, 
   3.606671181064802*^9}, {3.606671219922063*^9, 3.606671264924569*^9}, {
   3.6066713094523077`*^9, 3.606671337481825*^9}, {3.606671416031417*^9, 
   3.606671445377943*^9}, {3.606671550546733*^9, 3.606671601384734*^9}, {
   3.6071246601975327`*^9, 3.607124664549396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/vic_regional_trees.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", 
    ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606671349833582*^9, 3.606671352399167*^9}, {
   3.606671555616131*^9, 3.606671555717093*^9}, {3.60667160541698*^9, 
   3.606671605770995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/vic_regional_trees.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}],
    "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606671355924122*^9, 
   3.606671360264675*^9}, {3.606671558497725*^9, 3.6066715586173553`*^9}, {
   3.606671608474923*^9, 3.606671610123528*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regional trees Yam", "Subsection",
 CellChangeTimes->{{3.6066710401514482`*^9, 3.60667104254005*^9}, {
  3.606671431965562*^9, 3.606671432066187*^9}, {3.6066715714447317`*^9, 
  3.6066715722739763`*^9}, {3.606671616888212*^9, 3.6066716172248487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"numberToString", "[", "i", "]"}], ",", "\"\<\>\""}], 
           "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlot", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_usa.rules\>\"", ",", "\"\<Yam\>\"", ",", 
          "1.01"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_sa.rules\>\"", ",", "\"\<\>\"", ",", "1"}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1"}],
          "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", 
          "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.606671046953845*^9, 3.606671063524207*^9}, {3.606671105927994*^9, 
   3.606671181064802*^9}, {3.606671219922063*^9, 3.606671264924569*^9}, {
   3.6066713094523077`*^9, 3.606671337481825*^9}, {3.606671416031417*^9, 
   3.606671445377943*^9}, {3.606671550546733*^9, 3.606671627513505*^9}, {
   3.607124667063911*^9, 3.607124674350512*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/yam_regional_trees.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", 
    ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606671349833582*^9, 3.606671352399167*^9}, {
   3.606671555616131*^9, 3.606671555717093*^9}, {3.60667160541698*^9, 
   3.60667162970129*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/yam_regional_trees.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}],
    "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606671355924122*^9, 
   3.606671360264675*^9}, {3.606671558497725*^9, 3.6066715586173553`*^9}, {
   3.606671608474923*^9, 3.606671630351577*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Regional trees combined", "Subsection",
 CellChangeTimes->{{3.621035163870573*^9, 3.621035168093699*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frameTicks", "[", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"None", ",", " ", "None"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"i", ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"numberToString", "[", "i", "]"}], ",", 
              RowBox[{"-", "2"}]}], "]"}], ",", "\"\<\>\""}], "]"}], ",", " ", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"EvenQ", "[", "i", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.01"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", " ", "0.005"}], "}"}]}], "]"}]}], "}"}], ",", 
        " ", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1994", ",", " ", "2014"}], "}"}]}], "]"}], ",", 
      " ", "None"}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.543030558875434*^9, 3.543030616317918*^9}, 
   3.543034407192216*^9, {3.543034571795858*^9, 3.543034578727668*^9}, {
   3.5430634640913258`*^9, 3.543063495860332*^9}, 3.5727010583102713`*^9, {
   3.572701143217442*^9, 3.572701247597377*^9}, {3.6210355372190638`*^9, 
   3.621035544346504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"treePlotNoLegend", "[", 
   RowBox[{"file_", ",", "type_", ",", "height_", ",", "plotlabel_"}], "]"}], 
  ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
      "ids", ",", "drop", ",", "antigenic", ",", "typeLabel", ",", "legend"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
        "ids", ",", "antigenic"}], "}"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"ToExpression", "[", "rules", "]"}]}], ";", 
     RowBox[{"labels", "=", 
      RowBox[{"ToExpression", "[", "labels", "]"}]}], ";", 
     RowBox[{"coords", "=", 
      RowBox[{"ToExpression", "[", "coords", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"labels", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "labels"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ids", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"array", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\<->\>\""}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"array", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"array", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], ",", "ids"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"drop", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"ids", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"removeTips", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tips", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"tips", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", "x"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"rules", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"type", ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "height"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "Bold", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"typeLabel", ",", 
         RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", "labels"}], "/.", 
               "colorRules"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"coordsA", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "coords"}]}], ",", 
                  RowBox[{"coordsB", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "coords"}]}]}], 
                 "}"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{"coordsA", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coordsB", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"coordsA", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "coordsB"}],
                   "}"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "rules"}], 
          "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "/.", "labels"}], "/.", "colorRules"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Point", "[", 
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coords"}], ")"}], "]"}], ",", 
                RowBox[{"#", "/.", "ids"}]}], "]"}]}], "}"}], "&"}], ",", 
           "tips"}], "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.85"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", "0.03", "]"}], ",", "0"}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
       ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "5"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", "plotlabel"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6012600996616993`*^9, 3.6012601872290697`*^9}, {
   3.60126024090471*^9, 3.6012602535988007`*^9}, {3.601260302395293*^9, 
   3.601260302911364*^9}, {3.6012604345679693`*^9, 3.601260434739829*^9}, {
   3.6062498497553253`*^9, 3.606249863994462*^9}, {3.606249991796113*^9, 
   3.606249992800028*^9}, {3.606250104820897*^9, 3.6062501057244463`*^9}, 
   3.606250160229519*^9, {3.606250235164617*^9, 3.606250239075603*^9}, 
   3.606250304074325*^9, 3.6062503496461773`*^9, 3.607124885922031*^9, {
   3.607188938626986*^9, 3.607188945990184*^9}, {3.621035510469582*^9, 
   3.621035510541103*^9}, {3.621035637323299*^9, 3.6210356617914762`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"treePlotNoLegend", "[", 
   RowBox[{"file_", ",", "type_", ",", "height_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
      "ids", ",", "drop", ",", "antigenic", ",", "typeLabel", ",", "legend"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tips", ",", "trunk", ",", "rules", ",", "labels", ",", "coords", ",", 
        "ids", ",", "antigenic"}], "}"}], "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"ToExpression", "[", "rules", "]"}]}], ";", 
     RowBox[{"labels", "=", 
      RowBox[{"ToExpression", "[", "labels", "]"}]}], ";", 
     RowBox[{"coords", "=", 
      RowBox[{"ToExpression", "[", "coords", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"labels", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"ToString", "[", 
           RowBox[{"#", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "&"}], ",", "labels"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ids", "=", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"array", "=", 
             RowBox[{"StringSplit", "[", 
              RowBox[{"#", ",", "\"\<->\>\""}], "]"}]}], "}"}], ",", 
           RowBox[{
            RowBox[{"ToExpression", "[", 
             RowBox[{"array", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
            RowBox[{"array", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], "&"}], ",", "ids"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"drop", "=", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"ids", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"MemberQ", "[", 
           RowBox[{"removeTips", ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tips", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"tips", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", "x"}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rules", "=", 
      RowBox[{"DeleteCases", "[", 
       RowBox[{"rules", ",", 
        RowBox[{"x_", "/;", 
         RowBox[{"MemberQ", "[", 
          RowBox[{"drop", ",", 
           RowBox[{"x", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"typeLabel", "=", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{"type", ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0", ",", "height"}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Directive", "[", 
         RowBox[{"Black", ",", "Bold", ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"typeLabel", ",", 
         RowBox[{"AbsolutePointSize", "[", "3", "]"}], ",", 
         RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "/.", "labels"}], "/.", 
               "colorRules"}], ",", 
              RowBox[{"With", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"coordsA", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "/.", "coords"}]}], ",", 
                  RowBox[{"coordsB", "=", 
                   RowBox[{
                    RowBox[{"#", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "/.", "coords"}]}]}], 
                 "}"}], ",", 
                RowBox[{"Line", "[", 
                 RowBox[{"{", 
                  RowBox[{"coordsA", ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"coordsB", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"coordsA", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", "coordsB"}],
                   "}"}], "]"}]}], "]"}]}], "}"}], "&"}], ",", "rules"}], 
          "]"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "/.", "labels"}], "/.", "colorRules"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Point", "[", 
                 RowBox[{"(", 
                  RowBox[{"#", "/.", "coords"}], ")"}], "]"}], ",", 
                RowBox[{"#", "/.", "ids"}]}], "]"}]}], "}"}], "&"}], ",", 
           "tips"}], "]"}]}], "}"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "250"}], ",", 
       RowBox[{"AspectRatio", "\[Rule]", "0.85"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "False", ",", "False", ",", "False"}], "}"}]}], 
       ",", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Scaled", "[", "0.03", "]"}], ",", "0"}], "}"}]}], 
         "}"}]}], ",", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{
          RowBox[{"AbsoluteThickness", "[", "0.75", "]"}], ",", 
          RowBox[{"FontSize", "\[Rule]", "10"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
       ",", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"frameTicks", "[", "]"}]}], ",", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"20", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6012600996616993`*^9, 3.6012601872290697`*^9}, {
   3.60126024090471*^9, 3.6012602535988007`*^9}, {3.601260302395293*^9, 
   3.601260302911364*^9}, {3.6012604345679693`*^9, 3.601260434739829*^9}, {
   3.6062498497553253`*^9, 3.606249863994462*^9}, {3.606249991796113*^9, 
   3.606249992800028*^9}, {3.606250104820897*^9, 3.6062501057244463`*^9}, 
   3.606250160229519*^9, {3.606250235164617*^9, 3.606250239075603*^9}, 
   3.606250304074325*^9, 3.6062503496461773`*^9, 3.607124885922031*^9, {
   3.607188938626986*^9, 3.607188945990184*^9}, {3.621035510469582*^9, 
   3.621035510541103*^9}, {3.621035637323299*^9, 3.6210356617914762`*^9}, {
   3.62103576153655*^9, 3.6210357657846603`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_usa.rules\>\"", ",", "\"\<H3N2\>\"", ",", 
          "1.01", ",", "\"\<USA & Canada\>\""}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1", 
          ",", "\"\<India\>\""}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h3_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", "1", 
          ",", "\"\<South China\>\""}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_usa.rules\>\"", ",", "\"\<H1N1\>\"", ",", 
          "1.01"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1"}], 
         "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<h1_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", "1"}],
          "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_usa.rules\>\"", ",", "\"\<Vic\>\"", ",", 
          "1.01"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1"}],
          "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<vic_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", 
          "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_usa.rules\>\"", ",", "\"\<Yam\>\"", ",", 
          "1.01"}], "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_india.rules\>\"", ",", "\"\<\>\"", ",", "1"}],
          "]"}], ",", 
        RowBox[{"treePlotNoLegend", "[", 
         RowBox[{
         "\"\<yam_large_geo/out_schina.rules\>\"", ",", "\"\<\>\"", ",", 
          "1"}], "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.606249807202544*^9, 3.606249817241296*^9}, {
   3.606249873324778*^9, 3.606249906803013*^9}, {3.606249999614016*^9, 
   3.6062500448492737`*^9}, {3.606250252736772*^9, 3.606250273738655*^9}, {
   3.606250321791959*^9, 3.606250403300219*^9}, 3.606250732281328*^9, {
   3.606671046953845*^9, 3.606671063524207*^9}, {3.606671105927994*^9, 
   3.606671181064802*^9}, {3.606671219922063*^9, 3.606671264924569*^9}, {
   3.6066713094523077`*^9, 3.606671337481825*^9}, {3.606671416031417*^9, 
   3.606671423318288*^9}, {3.607124637173997*^9, 3.607124644653777*^9}, {
   3.6210353835130377`*^9, 3.621035461116625*^9}, {3.6210356674327383`*^9, 
   3.621035727119812*^9}, 3.621035770271297*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/regional_trees.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606671349833582*^9, 3.606671352399167*^9}, {
   3.621035568819737*^9, 3.6210355691479607`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/regional_trees.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606671355924122*^9, 
   3.606671360264675*^9}, {3.621035572896871*^9, 3.6210355732243023`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Migration grid", "Subsection",
 CellChangeTimes->{{3.606671795055646*^9, 3.606671796550826*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"migPlot", "[", 
         RowBox[{
         "\"\<h3_large_geo/h3_large_geo.log\>\"", ",", "\"\<H3N2\>\""}], 
         "]"}], ",", 
        RowBox[{"migPlot", "[", 
         RowBox[{
         "\"\<h1_large_geo/h1_large_geo.log\>\"", ",", "\"\<H1N1\>\""}], 
         "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"migPlot", "[", 
         RowBox[{
         "\"\<vic_large_geo/vic_large_geo.log\>\"", ",", "\"\<Vic\>\""}], 
         "]"}], ",", 
        RowBox[{"migPlot", "[", 
         RowBox[{
         "\"\<yam_large_geo/yam_large_geo.log\>\"", ",", "\"\<Yam\>\""}], 
         "]"}]}], "}"}]}], "}"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6066736860240097`*^9, 3.6066737079426003`*^9}, {
  3.606674208146442*^9, 3.606674259127953*^9}, {3.607124677861372*^9, 
  3.607124689780961*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/grids.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606671349833582*^9, 3.606671352399167*^9}, {
   3.606671555616131*^9, 3.606671555717093*^9}, {3.60667160541698*^9, 
   3.60667162970129*^9}, {3.606674270590789*^9, 3.606674272697916*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/grids.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606671355924122*^9, 
   3.606671360264675*^9}, {3.606671558497725*^9, 3.6066715586173553`*^9}, {
   3.606671608474923*^9, 3.606671630351577*^9}, 3.606674277025358*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trunk ", "Subsection",
 CellChangeTimes->{{3.458494930766955*^9, 3.458494933124058*^9}, 
   3.466088773182148*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeLabel", "[", 
   RowBox[{"name_", ",", "loc_"}], "]"}], ":=", 
  RowBox[{"Style", "[", 
   RowBox[{
    RowBox[{"Text", "[", 
     RowBox[{
      RowBox[{"name", "/.", "shortNameRules"}], ",", "loc"}], "]"}], ",", 
    RowBox[{"Directive", "[", 
     RowBox[{
      RowBox[{"Darker", "[", 
       RowBox[{
        RowBox[{"name", "/.", "colorRules"}], ",", "0.4"}], "]"}], ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "]"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"trunkPlot", "[", 
   RowBox[{"file_", ",", "labels_", ",", "panel_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rNames", ",", "rColorList", ",", "start", ",", "stop", ",", "skls", ",",
       "length", ",", "skltable", ",", "timelist", ",", "listPlot", ",", 
      "panelLabel"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rNames", "=", 
      RowBox[{"Reverse", "[", "names", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rColorList", "=", 
      RowBox[{"Reverse", "[", "colorList", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"start", "=", "2000"}], ";", 
     RowBox[{"stop", "=", "2010"}], ";", "\[IndentingNewLine]", 
     RowBox[{"skls", "=", 
      RowBox[{"Import", "[", 
       RowBox[{"file", ",", "\"\<Table\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"length", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<pro_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Table", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", "length", "}"}]}], "]"}], "}"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"list", " ", "=", " ", 
              RowBox[{"Select", "[", 
               RowBox[{"skls", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "==", 
                  RowBox[{"\"\<pro_\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}]}], "&"}]}], "]"}]}], 
             "}"}], ",", " ", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", " ", "4"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", " ", "rNames"}], "}"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"Accumulate", "[", "skltable", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"timelist", "=", 
      RowBox[{
       RowBox[{"Select", "[", 
        RowBox[{"skls", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "==", 
           RowBox[{"\"\<pro_\>\"", "<>", 
            RowBox[{"names", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "&"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"skltable", "=", 
      RowBox[{"MapIndexed", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"timelist", "[", 
            RowBox[{"[", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", "#1"}], 
          "}"}], "&"}], ",", "skltable", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"listPlot", "=", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"skltable", ",", 
        RowBox[{"PlotRange", " ", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"start", ",", "stop"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1.01"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"Filling", " ", "\[Rule]", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"i", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"i", "+", "1"}], "}"}], ",", 
              RowBox[{"Directive", "[", 
               RowBox[{"Lighter", "[", 
                RowBox[{
                 RowBox[{"rColorList", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], ",", "0.4"}], "]"}], 
               "]"}]}], "}"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Frame", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
        ",", 
        RowBox[{"Axes", "\[Rule]", "False"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{
           RowBox[{"AbsoluteThickness", "[", "0.5", "]"}], ",", 
           RowBox[{"GrayLevel", "[", "0.25", "]"}]}], "]"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
        RowBox[{"PlotRangePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.15", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.05", ",", "0"}], "}"}]}], "}"}]}], ",", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"frameTicks", "[", 
          RowBox[{"0", ",", "1", ",", "0.25"}], "]"}]}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\"\<\>\"", ",", "\"\<Trunk probability\>\""}], "}"}]}], 
        ",", 
        RowBox[{"PlotRangeClipping", "\[Rule]", "False"}], ",", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"45", ",", "10"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"15", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"panelLabel", "=", 
      RowBox[{"Graphics", "[", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"panel", ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "0.08"}], ",", "1"}], "}"}], "]"}]}], "]"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", "Bold", 
         ",", 
         RowBox[{"FontSize", "\[Rule]", "12"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"listPlot", ",", "labels", ",", "panelLabel"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.62714985084879*^9, 3.6271498547006903`*^9}, {
  3.627149900220097*^9, 3.627149909445202*^9}, {3.627149943432062*^9, 
  3.627149982884829*^9}, {3.6271501162122173`*^9, 3.6271502556989717`*^9}, {
  3.6271506062998447`*^9, 3.627150880690709*^9}, {3.630850752007316*^9, 
  3.630850752874083*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h3LargeLabels", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<NorthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2000.7", ",", "0.9"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SouthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2002.2", ",", "0.4"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SoutheastAsia\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2003.6", ",", "0.08"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SouthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2004.7", ",", "0.32"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<India\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2005.8", ",", "0.48"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<USACanada\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2008.05", ",", "0.9"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.611507131581678*^9, 3.611507364541959*^9}, {
  3.6115074218128*^9, 3.6115074346102753`*^9}, {3.627150903266679*^9, 
  3.627150905803829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h3LargePlot", "=", 
   RowBox[{"trunkPlot", "[", 
    RowBox[{
    "\"\<h3_large_geo/out_trunk.skylines\>\"", ",", "h3LargeLabels", ",", 
     "\"\<a\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.627150265413199*^9, 3.627150297232636*^9}, {
  3.627150669819869*^9, 3.627150671682701*^9}, {3.6271508924702578`*^9, 
  3.627150909727521*^9}, {3.6308507304449863`*^9, 3.630850730981913*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h3SmallLabels", "=", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<NorthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2000.6", ",", "0.8"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SouthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2001.9", ",", "0.4"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SoutheastAsia\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2003.55", ",", "0.08"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<SouthChina\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2004.6", ",", "0.32"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<Europe\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2006.1", ",", "0.62"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<USACanada\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2008.1", ",", "0.9"}], "}"}]}], "]"}], ",", 
      RowBox[{"makeLabel", "[", 
       RowBox[{"\"\<India\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"2008.9", ",", "0.48"}], "}"}]}], "]"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.611507131581678*^9, 3.611507364541959*^9}, {
  3.6115074218128*^9, 3.6115074346102753`*^9}, {3.627150437880918*^9, 
  3.627150442237776*^9}, {3.627150485252084*^9, 3.627150578653199*^9}, {
  3.6271509130572453`*^9, 3.6271509152581797`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h3SmallPlot", "=", 
   RowBox[{"trunkPlot", "[", 
    RowBox[{
    "\"\<h3_small_geo/out_trunk.skylines\>\"", ",", "h3SmallLabels", ",", 
     "\"\<b\>\""}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.627150265413199*^9, 3.627150297232636*^9}, {
  3.627150384335864*^9, 3.62715038812494*^9}, {3.627150858008904*^9, 
  3.627150860973192*^9}, {3.627150894752739*^9, 3.627150918412488*^9}, {
  3.630850732877862*^9, 3.630850733653819*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "h3LargePlot", "}"}], ",", 
       RowBox[{"{", "h3SmallPlot", "}"}]}], "}"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.627150588254108*^9, 3.627150590323141*^9}, {
  3.6271509213469753`*^9, 3.6271509473738728`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<figures/h3_trunk.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
    RowBox[{"ImageResolution", "\[Rule]", "300"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.575265611662064*^9, 3.5752656284367113`*^9}, {
   3.5995322730510073`*^9, 3.599532300723711*^9}, 3.599532547576456*^9, 
   3.601307848308333*^9, 3.602946424170743*^9, {3.606250544275236*^9, 
   3.606250570771834*^9}, {3.606671349833582*^9, 3.606671352399167*^9}, {
   3.606671555616131*^9, 3.606671555717093*^9}, {3.60667160541698*^9, 
   3.60667162970129*^9}, {3.606674270590789*^9, 3.606674272697916*^9}, 
   3.6271503673719463`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<figures/h3_trunk.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.466439589861575*^9, 3.466439600740834*^9}, {
   3.5727227397846327`*^9, 3.572722743713212*^9}, {3.599532276969256*^9, 
   3.599532303903984*^9}, 3.6013078494313593`*^9, 3.60294642505169*^9, {
   3.606250555650209*^9, 3.606250557166277*^9}, {3.606671355924122*^9, 
   3.606671360264675*^9}, {3.606671558497725*^9, 3.6066715586173553`*^9}, {
   3.606671608474923*^9, 3.606671630351577*^9}, 3.606674277025358*^9, 
   3.6271503688199244`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Significance test", "Section",
 CellChangeTimes->{{3.6066779419612427`*^9, 3.606677950348467*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rhoList", "=", 
   RowBox[{"{", 
    RowBox[{"0.60", ",", "0.63", ",", "0.32", ",", "0.62"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.617282847957252*^9, 3.6172828632136297`*^9}}],

Cell[CellGroupData[{

Cell["Total", "Subsection",
 CellChangeTimes->{{3.606678456218994*^9, 3.6066784577600946`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"observed", "=", 
  RowBox[{"Total", "[", "rhoList", "]"}]}]], "Input",
 CellChangeTimes->{{3.606678067271433*^9, 3.606678087626265*^9}, {
  3.6172828371767406`*^9, 3.6172828663467817`*^9}}],

Cell[BoxData["2.17`"], "Output",
 CellChangeTimes->{3.606678088158413*^9, 3.607125752018426*^9, 
  3.607130029835321*^9, 3.607132989439618*^9, 3.6071811597444572`*^9, 
  3.607183700813093*^9, 3.6071847545081253`*^9, 3.607188609060916*^9, 
  3.607189158598762*^9, 3.6172466052280893`*^9, 3.6172804787711678`*^9, 
  3.617280704089682*^9, 3.617280905920458*^9, 3.617282875313058*^9, 
  3.626708166685479*^9, 3.626708866762165*^9, 3.626709165442717*^9, 
  3.6267094799196863`*^9, 3.626715872658214*^9, 3.6267163184400997`*^9, 
  3.6267169630487633`*^9, 3.6271437738308897`*^9, 3.627149801409792*^9, 
  3.630850959120356*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rRho", "[", "]"}], ":=", 
  RowBox[{"SpearmanRho", "[", 
   RowBox[{
    RowBox[{"RandomVariate", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", "1"}], "]"}], ",", "n"}], "]"}], ",", 
    RowBox[{"RandomVariate", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", "1"}], "]"}], ",", "n"}], "]"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.606678101982148*^9, 3.606678118159284*^9}, {
  3.606678159051762*^9, 3.606678169099338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rRho", "[", "]"}], ",", 
        RowBox[{"rRho", "[", "]"}], ",", 
        RowBox[{"rRho", "[", "]"}], ",", 
        RowBox[{"rRho", "[", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", "10000", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6066779542445393`*^9, 3.606677998393611*^9}, {
  3.606678097885387*^9, 3.606678128703178*^9}, {3.606678175732113*^9, 
  3.606678213073289*^9}, {3.606678480572111*^9, 3.606678482394639*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "[", 
   RowBox[{"Cases", "[", 
    RowBox[{"rList", ",", 
     RowBox[{"x_", "/;", 
      RowBox[{"x", ">", "observed"}]}]}], "]"}], "]"}], "/", 
  "10000."}]], "Input",
 CellChangeTimes->{{3.606678001566299*^9, 3.606678054413512*^9}, 
   3.6066781455875053`*^9, {3.60667818955612*^9, 3.606678215112059*^9}}],

Cell[BoxData["0.0013000000000000002`"], "Output",
 CellChangeTimes->{{3.606678006000451*^9, 3.60667805496454*^9}, {
   3.6066781338458014`*^9, 3.606678146138907*^9}, {3.606678186323168*^9, 
   3.606678216998654*^9}, 3.6071257553895397`*^9, 3.607130033132807*^9, 
   3.607132993095093*^9, 3.607181163364455*^9, 3.607183704199374*^9, 
   3.6071847579788437`*^9, 3.6071886125133867`*^9, 3.607189162114202*^9, 
   3.617246608565071*^9, 3.6172804822387533`*^9, 3.617280707407405*^9, 
   3.617280909205517*^9, 3.6172828785126123`*^9, 3.626708170071536*^9, 
   3.626708870195553*^9, 3.626709168926877*^9, 3.626709483503587*^9, 
   3.6267158761263523`*^9, 3.626716321861124*^9, 3.626716966385029*^9, 
   3.627143777135954*^9, 3.627149804846349*^9, 3.630850962488573*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Min", "Subsection",
 CellChangeTimes->{{3.6066784599382973`*^9, 3.606678460219965*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"observed", "=", 
  RowBox[{"Min", "[", "rhoList", "]"}]}]], "Input",
 CellChangeTimes->{{3.606678067271433*^9, 3.606678087626265*^9}, {
   3.6066784622277317`*^9, 3.606678462504867*^9}, 3.6172828689146*^9}],

Cell[BoxData["0.32`"], "Output",
 CellChangeTimes->{
  3.606678088158413*^9, {3.606678462849101*^9, 3.60667848473423*^9}, 
   3.607125755412478*^9, 3.6071300331605663`*^9, 3.6071329931229143`*^9, 
   3.607181163420295*^9, 3.607183704233984*^9, 3.6071847580129232`*^9, 
   3.607188612546953*^9, 3.6071891621577597`*^9, 3.617246608610941*^9, 
   3.617280482278123*^9, 3.617280707441188*^9, 3.61728090923899*^9, 
   3.617282878545801*^9, 3.626708170120833*^9, 3.626708870234367*^9, 
   3.626709168959229*^9, 3.626709483536804*^9, 3.626715876169915*^9, 
   3.6267163218930197`*^9, 3.626716966418067*^9, 3.627143777190609*^9, 
   3.627149804891038*^9, 3.6308509625386963`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rList", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Min", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rRho", "[", "]"}], ",", 
        RowBox[{"rRho", "[", "]"}], ",", 
        RowBox[{"rRho", "[", "]"}], ",", 
        RowBox[{"rRho", "[", "]"}]}], "}"}], "]"}], ",", 
     RowBox[{"{", "10000", "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6066779542445393`*^9, 3.606677998393611*^9}, {
  3.606678097885387*^9, 3.606678128703178*^9}, {3.606678175732113*^9, 
  3.606678213073289*^9}, {3.606678465455266*^9, 3.606678475836858*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "[", 
   RowBox[{"Cases", "[", 
    RowBox[{"rList", ",", 
     RowBox[{"x_", "/;", 
      RowBox[{"x", ">", "observed"}]}]}], "]"}], "]"}], "/", 
  "10000."}]], "Input"],

Cell[BoxData["0.0014`"], "Output",
 CellChangeTimes->{3.606678490087297*^9, 3.607125758609497*^9, 
  3.607130036358474*^9, 3.607132996318017*^9, 3.607181166783145*^9, 
  3.607183707436068*^9, 3.607184761281734*^9, 3.6071886158488827`*^9, 
  3.607189165368277*^9, 3.617246611811145*^9, 3.6172804857390947`*^9, 
  3.6172807105754137`*^9, 3.6172809124387836`*^9, 3.617282881663759*^9, 
  3.626708173303348*^9, 3.626708873596911*^9, 3.626709172447256*^9, 
  3.626709486886722*^9, 3.626715879517604*^9, 3.626716325193836*^9, 
  3.6267169696249866`*^9, 3.6271437803385773`*^9, 3.627149808132251*^9, 
  3.630850965671076*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1418, 799},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingOptions->{"PaperOrientation"->"Portrait"},
ShowSelection->True,
Magnification->1.25,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 125, 1, 114, "Title"],
Cell[707, 25, 187, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[919, 35, 100, 1, 100, "Section"],
Cell[1022, 38, 7750, 106, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8809, 149, 92, 1, 100, "Section"],
Cell[8904, 152, 217, 5, 36, "Input"],
Cell[9124, 159, 282, 5, 36, "Input"],
Cell[9409, 166, 207, 4, 35, "Input"],
Cell[9619, 172, 673, 14, 35, "Input"],
Cell[10295, 188, 873, 18, 57, "Input"],
Cell[11171, 208, 951, 17, 57, "Input"],
Cell[12125, 227, 440, 8, 35, "Input"],
Cell[12568, 237, 570, 14, 36, "Input"],
Cell[13141, 253, 207, 5, 36, "Input"],
Cell[13351, 260, 251, 6, 35, "Input"],
Cell[13605, 268, 255, 5, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13897, 278, 94, 1, 100, "Section"],
Cell[CellGroupData[{
Cell[14016, 283, 96, 1, 54, "Subsection"],
Cell[14115, 286, 295, 7, 36, "Input"],
Cell[14413, 295, 456, 11, 36, "Input"],
Cell[14872, 308, 135, 2, 35, "Input"],
Cell[15010, 312, 1659, 43, 78, "Input"],
Cell[16672, 357, 1226, 32, 57, "Input"],
Cell[17901, 391, 1882, 48, 78, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19820, 444, 95, 1, 54, "Subsection"],
Cell[19918, 447, 909, 20, 57, "Input"],
Cell[20830, 469, 1363, 26, 57, "Input"],
Cell[22196, 497, 1410, 27, 57, "Input"],
Cell[23609, 526, 1423, 27, 57, "Input"],
Cell[25035, 555, 1432, 27, 57, "Input"],
Cell[26470, 584, 1389, 25, 57, "Input"],
Cell[27862, 611, 1433, 25, 57, "Input"],
Cell[29298, 638, 1486, 28, 57, "Input"],
Cell[30787, 668, 1205, 23, 57, "Input"],
Cell[31995, 693, 1071, 23, 78, "Input"],
Cell[33069, 718, 1038, 22, 57, "Input"],
Cell[34110, 742, 368, 8, 36, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[34527, 756, 93, 1, 100, "Section"],
Cell[34623, 759, 3269, 60, 99, "Input"],
Cell[37895, 821, 483, 14, 36, "Input"],
Cell[38381, 837, 179, 4, 35, "Input"],
Cell[38563, 843, 2159, 48, 141, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40759, 896, 93, 1, 100, "Section"],
Cell[40855, 899, 3446, 69, 99, "Input",
 CellID->1143417716],
Cell[44304, 970, 3011, 59, 57, "Input"],
Cell[47318, 1031, 232, 5, 35, "Input"],
Cell[47553, 1038, 1148, 33, 57, "Input"],
Cell[48704, 1073, 216, 5, 35, "Input"],
Cell[48923, 1080, 1223, 34, 57, "Input"],
Cell[50149, 1116, 241, 5, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50427, 1126, 94, 1, 100, "Section"],
Cell[50524, 1129, 615, 12, 36, "Input"],
Cell[51142, 1143, 317, 9, 35, "Input"],
Cell[51462, 1154, 605, 14, 35, "Input"],
Cell[52070, 1170, 530, 11, 35, "Input"],
Cell[52603, 1183, 1692, 39, 162, "Input"],
Cell[54298, 1224, 1009, 22, 141, "Input"],
Cell[55310, 1248, 1057, 23, 141, "Input"],
Cell[56370, 1273, 770, 19, 141, "Input"],
Cell[57143, 1294, 1747, 45, 162, "Input"],
Cell[58893, 1341, 188, 4, 35, "Input"],
Cell[59084, 1347, 196, 5, 36, "Input"],
Cell[59283, 1354, 711, 18, 36, "Input"],
Cell[59997, 1374, 418, 11, 35, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60452, 1390, 213, 3, 100, "Section"],
Cell[60668, 1395, 1226, 32, 57, "Input"],
Cell[61897, 1429, 243, 5, 36, "Input"],
Cell[62143, 1436, 8951, 228, 477, "Input"],
Cell[CellGroupData[{
Cell[71119, 1668, 98, 1, 43, "Subsubsection"],
Cell[71220, 1671, 545, 11, 36, "Input"],
Cell[71768, 1684, 582, 12, 36, "Input"],
Cell[72353, 1698, 452, 9, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72842, 1712, 96, 1, 43, "Subsubsection"],
Cell[72941, 1715, 251, 7, 36, "Input"],
Cell[73195, 1724, 631, 12, 36, "Input"],
Cell[73829, 1738, 505, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74371, 1753, 102, 1, 43, "Subsubsection"],
Cell[74476, 1756, 329, 8, 36, "Input"],
Cell[74808, 1766, 708, 13, 36, "Input"],
Cell[75519, 1781, 582, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76138, 1797, 104, 1, 43, "Subsubsection"],
Cell[76245, 1800, 375, 8, 36, "Input"],
Cell[76623, 1810, 758, 14, 36, "Input"],
Cell[77384, 1826, 630, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78051, 1842, 95, 1, 43, "Subsubsection"],
Cell[78149, 1845, 351, 8, 36, "Input"],
Cell[78503, 1855, 737, 14, 36, "Input"],
Cell[79243, 1871, 605, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79885, 1887, 106, 1, 43, "Subsubsection"],
Cell[79994, 1890, 350, 8, 36, "Input"],
Cell[80347, 1900, 734, 14, 36, "Input"],
Cell[81084, 1916, 604, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81725, 1932, 105, 1, 43, "Subsubsection"],
Cell[81833, 1935, 407, 9, 36, "Input"],
Cell[82243, 1946, 784, 14, 36, "Input"],
Cell[83030, 1962, 632, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83699, 1978, 155, 2, 43, "Subsubsection"],
Cell[83857, 1982, 452, 9, 36, "Input"],
Cell[84312, 1993, 832, 15, 36, "Input"],
Cell[85147, 2010, 680, 12, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85864, 2027, 147, 2, 43, "Subsubsection"],
Cell[86014, 2031, 506, 10, 36, "Input"],
Cell[86523, 2043, 891, 16, 36, "Input"],
Cell[87417, 2061, 735, 13, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88189, 2079, 194, 3, 43, "Subsubsection"],
Cell[88386, 2084, 507, 10, 36, "Input"],
Cell[88896, 2096, 888, 16, 36, "Input"],
Cell[89787, 2114, 734, 13, 36, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90570, 2133, 117, 2, 100, "Section"],
Cell[90690, 2137, 179, 4, 35, "Input"],
Cell[90872, 2143, 183, 4, 35, "Input"],
Cell[91058, 2149, 877, 14, 35, "Input"],
Cell[91938, 2165, 1980, 30, 36, "Input"],
Cell[93921, 2197, 592, 16, 36, "Input"],
Cell[94516, 2215, 1360, 35, 57, "Input"],
Cell[95879, 2252, 237, 5, 35, "Input"],
Cell[96119, 2259, 614, 17, 36, "Input"],
Cell[96736, 2278, 699, 17, 35, "Input"],
Cell[97438, 2297, 4111, 82, 99, "Input"],
Cell[101552, 2381, 650, 17, 57, "Input"],
Cell[102205, 2400, 1224, 32, 78, "Input"],
Cell[103432, 2434, 406, 10, 99, "Input"],
Cell[103841, 2446, 510, 11, 36, "Input"],
Cell[104354, 2459, 487, 9, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104878, 2473, 175, 2, 100, "Section"],
Cell[CellGroupData[{
Cell[105078, 2479, 111, 1, 54, "Subsection"],
Cell[105192, 2482, 918, 23, 36, "Input"],
Cell[106113, 2507, 6878, 174, 414, "Input"],
Cell[112994, 2683, 405, 11, 36, "Input"],
Cell[113402, 2696, 406, 9, 36, "Input"],
Cell[113811, 2707, 653, 13, 36, "Input"],
Cell[114467, 2722, 613, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115117, 2738, 102, 1, 54, "Subsection"],
Cell[115222, 2741, 129, 1, 37, "Text"],
Cell[115354, 2744, 2925, 76, 204, "Input"],
Cell[CellGroupData[{
Cell[118304, 2824, 255, 5, 36, "Input"],
Cell[118562, 2831, 1468, 23, 35, "Output"]
}, Open  ]],
Cell[120045, 2857, 519, 12, 36, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[120613, 2875, 228, 3, 100, "Section"],
Cell[120844, 2880, 5645, 148, 456, "Input"],
Cell[126492, 3030, 273, 7, 36, "Input"],
Cell[126768, 3039, 1512, 30, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128317, 3074, 92, 1, 100, "Section"],
Cell[128412, 3077, 2267, 41, 99, "Input"],
Cell[130682, 3120, 7748, 184, 393, "Input"],
Cell[138433, 3306, 502, 10, 36, "Input"],
Cell[138938, 3318, 793, 15, 36, "Input"],
Cell[139734, 3335, 727, 13, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140498, 3353, 231, 3, 100, "Section"],
Cell[140732, 3358, 168, 3, 37, "Text"],
Cell[140903, 3363, 2496, 65, 267, "Input"],
Cell[143402, 3430, 214, 5, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143653, 3440, 90, 1, 100, "Section"],
Cell[143746, 3443, 1818, 43, 204, "Input"],
Cell[145567, 3488, 2561, 54, 120, "Input"],
Cell[148131, 3544, 3111, 68, 141, "Input"],
Cell[151245, 3614, 2758, 45, 162, "Input"],
Cell[154006, 3661, 1180, 20, 57, "Input"],
Cell[155189, 3683, 329, 8, 35, "Input"],
Cell[155521, 3693, 3612, 93, 330, "Input"],
Cell[159136, 3788, 3606, 93, 330, "Input"],
Cell[162745, 3883, 1355, 20, 35, "Input"],
Cell[164103, 3905, 2958, 65, 162, "Input"],
Cell[167064, 3972, 3027, 66, 162, "Input"],
Cell[170094, 4040, 1898, 45, 225, "Input"],
Cell[171995, 4087, 2622, 62, 267, "Input"],
Cell[174620, 4151, 618, 13, 36, "Input"],
Cell[175241, 4166, 440, 10, 36, "Input"],
Cell[175684, 4178, 391, 8, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176112, 4191, 96, 1, 100, "Section"],
Cell[176211, 4194, 7696, 203, 456, "Input"],
Cell[183910, 4399, 8446, 216, 561, "Input"],
Cell[192359, 4617, 1123, 32, 120, "Input"],
Cell[193485, 4651, 6933, 169, 498, "Input"],
Cell[200421, 4822, 632, 13, 36, "Input"],
Cell[201056, 4837, 2317, 41, 99, "Input"],
Cell[203376, 4880, 12729, 296, 687, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[216154, 5182, 150, 2, 114, "Title"],
Cell[CellGroupData[{
Cell[216329, 5188, 95, 1, 54, "Subsection"],
Cell[216427, 5191, 1226, 32, 57, "Input"],
Cell[217656, 5225, 9269, 233, 477, "Input"],
Cell[226928, 5460, 7563, 192, 372, "Input"],
Cell[234494, 5654, 1267, 31, 57, "Input"],
Cell[235764, 5687, 444, 8, 36, "Input"],
Cell[236211, 5697, 414, 8, 36, "Input"],
Cell[236628, 5707, 1318, 31, 57, "Input"],
Cell[237949, 5740, 604, 11, 36, "Input"],
Cell[238556, 5753, 567, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239160, 5769, 97, 1, 54, "Subsection"],
Cell[239260, 5772, 918, 23, 36, "Input"],
Cell[240181, 5797, 6952, 175, 414, "Input"],
Cell[247136, 5974, 6231, 152, 351, "Input"],
Cell[253370, 6128, 468, 10, 35, "Input"],
Cell[253841, 6140, 351, 9, 36, "Input"],
Cell[254195, 6151, 1753, 47, 99, "Input"],
Cell[255951, 6200, 1296, 31, 99, "Input"],
Cell[257250, 6233, 384, 10, 36, "Input"],
Cell[257637, 6245, 949, 24, 78, "Input"],
Cell[258589, 6271, 1561, 36, 99, "Input"],
Cell[260153, 6309, 349, 8, 36, "Input"],
Cell[260505, 6319, 711, 14, 36, "Input"],
Cell[261219, 6335, 498, 9, 36, "Input"],
Cell[261720, 6346, 440, 8, 36, "Input"],
Cell[262163, 6356, 1646, 45, 78, "Input"],
Cell[263812, 6403, 1335, 31, 99, "Input"],
Cell[265150, 6436, 384, 10, 36, "Input"],
Cell[265537, 6448, 949, 24, 78, "Input"],
Cell[266489, 6474, 1561, 36, 99, "Input"],
Cell[268053, 6512, 398, 9, 36, "Input"],
Cell[268454, 6523, 663, 13, 36, "Input"],
Cell[269120, 6538, 558, 11, 36, "Input"],
Cell[269681, 6551, 501, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270219, 6566, 92, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[270336, 6571, 1674, 40, 120, "Input"],
Cell[272013, 6613, 76, 1, 35, "Output"]
}, Open  ]],
Cell[272104, 6617, 489, 8, 36, "Input"],
Cell[272596, 6627, 435, 8, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273068, 6640, 99, 1, 54, "Subsection"],
Cell[273170, 6643, 1325, 33, 120, "Input"],
Cell[274498, 6678, 549, 10, 36, "Input"],
Cell[275050, 6690, 473, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[275560, 6705, 162, 2, 54, "Subsection"],
Cell[275725, 6709, 2146, 50, 162, "Input"],
Cell[277874, 6761, 4285, 96, 246, "Input"],
Cell[282162, 6859, 663, 12, 36, "Input"],
Cell[282828, 6873, 560, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283425, 6889, 111, 1, 54, "Subsection"],
Cell[283539, 6892, 1805, 40, 141, "Input"],
Cell[285347, 6934, 4605, 101, 309, "Input"],
Cell[289955, 7037, 616, 12, 36, "Input"],
Cell[290574, 7051, 533, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291144, 7066, 113, 1, 54, "Subsection"],
Cell[291260, 7069, 507, 14, 36, "Input"],
Cell[291770, 7085, 661, 12, 36, "Input"],
Cell[292434, 7099, 558, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[293029, 7115, 106, 1, 54, "Subsection"],
Cell[293138, 7118, 1226, 32, 57, "Input"],
Cell[294367, 7152, 1442, 33, 57, "Input"],
Cell[295812, 7187, 511, 10, 36, "Input"],
Cell[296326, 7199, 480, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296843, 7214, 155, 2, 54, "Subsection"],
Cell[297001, 7218, 1226, 32, 57, "Input"],
Cell[298230, 7252, 1468, 34, 57, "Input"],
Cell[299701, 7288, 561, 11, 36, "Input"],
Cell[300265, 7301, 528, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300830, 7316, 209, 3, 54, "Subsection"],
Cell[301042, 7321, 1226, 32, 57, "Input"],
Cell[302271, 7355, 1498, 34, 57, "Input"],
Cell[303772, 7391, 611, 12, 36, "Input"],
Cell[304386, 7405, 579, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305002, 7421, 257, 3, 54, "Subsection"],
Cell[305262, 7426, 1226, 32, 57, "Input"],
Cell[306491, 7460, 1496, 34, 57, "Input"],
Cell[307990, 7496, 610, 12, 36, "Input"],
Cell[308603, 7510, 579, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309219, 7526, 111, 1, 54, "Subsection"],
Cell[309333, 7529, 1379, 35, 78, "Input"],
Cell[310715, 7566, 7743, 195, 393, "Input"],
Cell[318461, 7763, 7712, 194, 372, "Input"],
Cell[326176, 7959, 3065, 71, 225, "Input"],
Cell[329244, 8032, 560, 11, 36, "Input"],
Cell[329807, 8045, 525, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330369, 8060, 102, 1, 54, "Subsection"],
Cell[330474, 8063, 980, 28, 57, "Input"],
Cell[331457, 8093, 634, 10, 36, "Input"],
Cell[332094, 8105, 584, 10, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332715, 8120, 120, 2, 54, "Subsection"],
Cell[332838, 8124, 513, 15, 57, "Input"],
Cell[333354, 8141, 6811, 173, 414, "Input"],
Cell[340168, 8316, 1280, 33, 78, "Input"],
Cell[341451, 8351, 432, 9, 36, "Input"],
Cell[341886, 8362, 1537, 38, 78, "Input"],
Cell[343426, 8402, 476, 10, 36, "Input"],
Cell[343905, 8414, 468, 13, 36, "Input"],
Cell[344376, 8429, 669, 12, 36, "Input"],
Cell[345048, 8443, 615, 11, 36, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[345700, 8459, 104, 1, 100, "Section"],
Cell[345807, 8462, 225, 6, 35, "Input"],
Cell[CellGroupData[{
Cell[346057, 8472, 95, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[346177, 8477, 213, 4, 35, "Input"],
Cell[346393, 8483, 620, 9, 35, "Output"]
}, Open  ]],
Cell[347028, 8495, 545, 15, 35, "Input"],
Cell[347576, 8512, 609, 15, 35, "Input"],
Cell[CellGroupData[{
Cell[348210, 8531, 353, 9, 36, "Input"],
Cell[348566, 8542, 762, 10, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[349377, 8558, 93, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[349495, 8563, 230, 4, 35, "Input"],
Cell[349728, 8569, 671, 10, 35, "Output"]
}, Open  ]],
Cell[350414, 8582, 607, 15, 35, "Input"],
Cell[CellGroupData[{
Cell[351046, 8601, 214, 7, 36, "Input"],
Cell[351263, 8610, 618, 9, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
