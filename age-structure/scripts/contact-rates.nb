(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     88075,       2226]
NotebookOptionsPosition[     81164,       1986]
NotebookOutlinePosition[     81644,       2005]
CellTagsIndexPosition[     81601,       2002]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Contact rates", "Title",
 CellChangeTimes->{{3.5600713070641813`*^9, 3.560071314693212*^9}, {
  3.60288098755223*^9, 3.602880989361352*^9}}],

Cell[CellGroupData[{

Cell["Setup", "Section",
 CellChangeTimes->{{3.59457970586907*^9, 3.594579707954959*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.450268464627475*^9, 3.450268482415883*^9}, {
  3.594592076804743*^9, 3.594592099609638*^9}}],

Cell[BoxData["\<\"/Users/trvrb/Dropbox/current-projects/global-migration/age-\
structure/scripts\"\>"], "Output",
 CellChangeTimes->{{3.450268475340981*^9, 3.450268482982368*^9}, 
   3.450269003043511*^9, 3.4502690446989737`*^9, {3.450269165727572*^9, 
   3.4502692014135437`*^9}, {3.450269376370208*^9, 3.45026941432729*^9}, {
   3.450269493491192*^9, 3.4502695001205482`*^9}, {3.450269585139248*^9, 
   3.450269603221554*^9}, {3.450269694401799*^9, 3.450269780178831*^9}, 
   3.450269820807786*^9, 3.450269888150284*^9, 3.45026993553715*^9, {
   3.4502699663810987`*^9, 3.4502699856866407`*^9}, 3.450271508540023*^9, {
   3.450295207920567*^9, 3.4502952287157297`*^9}, 3.450295670711678*^9, 
   3.450295923925455*^9, 3.4503038520816393`*^9, 3.4503500042820263`*^9, 
   3.4503505853767347`*^9, 3.450350616234778*^9, {3.450350674474004*^9, 
   3.450350697434856*^9}, 3.450351034363248*^9, 3.450351087465323*^9, 
   3.450626367627396*^9, {3.450736367214211*^9, 3.450736380737665*^9}, 
   3.452510878283227*^9, 3.453067527170946*^9, {3.453067562395196*^9, 
   3.453067588024865*^9}, {3.4530734097851763`*^9, 3.4530734301054773`*^9}, {
   3.453114954551077*^9, 3.453114967317504*^9}, 3.45311516210535*^9, 
   3.4531215162148733`*^9, {3.453125558162672*^9, 3.453125572348158*^9}, {
   3.4531327458367043`*^9, 3.4531327522627783`*^9}, 3.453160310339766*^9, 
   3.453160467624352*^9, 3.459187123143997*^9, 3.459187223755754*^9, 
   3.459187339444747*^9, 3.45918801762411*^9, 3.459192444895165*^9, 
   3.4591936742894173`*^9, 3.459198341403022*^9, 3.4591991015748796`*^9, 
   3.4591999140760717`*^9, 3.459201639787648*^9, 3.4592524711779137`*^9, 
   3.460308753425786*^9, 3.4609343322539043`*^9, 3.461077812978075*^9, {
   3.461079035641181*^9, 3.461079060735257*^9}, 3.475595497060254*^9, 
   3.4764608420789843`*^9, 3.4940087139676037`*^9, 3.4940090275293694`*^9, 
   3.49406251150988*^9, 3.494063286494256*^9, 3.4940639779751883`*^9, 
   3.494080715825486*^9, 3.494604589827167*^9, 3.558412135641445*^9, {
   3.560071303481288*^9, 3.560071317131789*^9}, 3.560071647028105*^9, 
   3.560072202900852*^9, 3.560076987869961*^9, {3.560078719933135*^9, 
   3.560078745454475*^9}, 3.560080161310811*^9, 3.560083020401866*^9, 
   3.56008501655723*^9, 3.56008508201114*^9, 3.56008774483641*^9, 
   3.560087800566177*^9, 3.560087919147285*^9, 3.5600880452906647`*^9, 
   3.560146153549789*^9, 3.56015167013983*^9, 3.5601534557947607`*^9, {
   3.560153519841165*^9, 3.560153535150337*^9}, 3.560153890546218*^9, 
   3.560154593128662*^9, 3.560154789386918*^9, 3.560246484003585*^9, 
   3.560246938921238*^9, {3.56024718089898*^9, 3.560247197509544*^9}, 
   3.56024724838595*^9, 3.560247345115943*^9, 3.56024743247572*^9, 
   3.560247476680418*^9, {3.560274710344214*^9, 3.560274763412016*^9}, 
   3.560274823782847*^9, 3.560435806946928*^9, 3.560435861398952*^9, 
   3.560439185833459*^9, 3.560439219335103*^9, 3.560439332720701*^9, 
   3.562931011268011*^9, 3.56293116120503*^9, {3.562931369032134*^9, 
   3.5629313808743067`*^9}, 3.562931507800981*^9, {3.563015117479783*^9, 
   3.563015131041376*^9}, 3.563015286139956*^9, 3.563015455211267*^9, 
   3.563015508610359*^9, 3.5630163343045*^9, 3.5636259484004717`*^9, 
   3.563626468495459*^9, 3.5636266078229303`*^9, 3.563626681639447*^9, 
   3.563626750144809*^9, 3.563626930784127*^9, 3.5636270621715927`*^9, 
   3.563627228280569*^9, 3.5636274559972982`*^9, 3.563627506646494*^9, 
   3.5636275713622513`*^9, 3.563627638795382*^9, 3.563627710887026*^9, 
   3.563627820817809*^9, 3.563689345741376*^9, 3.5636893878896313`*^9, 
   3.5637034892526417`*^9, 3.563703618691814*^9, 3.563703739593314*^9, 
   3.564830011374797*^9, 3.564830526193203*^9, 3.564830613727036*^9, 
   3.564830663257882*^9, 3.5648307647084312`*^9, 3.56483082468073*^9, 
   3.5648308831689177`*^9, 3.564830938790984*^9, 3.564831051032736*^9, 
   3.564831170845158*^9, 3.564831217538349*^9, 3.564831251095467*^9, 
   3.564831833696732*^9, 3.564839498838723*^9, {3.564839650818874*^9, 
   3.564839703168195*^9}, 3.564839749399323*^9, 3.5648398160602694`*^9, 
   3.5648398680436993`*^9, 3.564840277584*^9, 3.564840674416807*^9, 
   3.564840851567295*^9, 3.564841000511004*^9, 3.564841066983264*^9, 
   3.5648411850706873`*^9, 3.564841967021895*^9, 3.5681073257229433`*^9, {
   3.594579553951851*^9, 3.594579581008399*^9}, 3.5945804038340683`*^9, 
   3.594580577807382*^9, 3.594581211880712*^9, 3.5945814244863853`*^9, 
   3.594581489390719*^9, {3.594581611858183*^9, 3.5945817019669323`*^9}, 
   3.594581955891429*^9, 3.5945819921051407`*^9, 3.594582023663808*^9, 
   3.5945820711195374`*^9, 3.594583002932783*^9, {3.594583214473236*^9, 
   3.594583240627769*^9}, 3.594583334321456*^9, 3.594583384428919*^9, 
   3.594583433955267*^9, 3.594583479290866*^9, 3.594584371608015*^9, 
   3.5945844314888287`*^9, 3.5945858762424517`*^9, 3.594586195722268*^9, 
   3.594586230717561*^9, {3.5945862756389236`*^9, 3.5945863043615713`*^9}, 
   3.594586390615157*^9, 3.5945864329685802`*^9, 3.594586479304838*^9, 
   3.5945865730667562`*^9, 3.594586627359953*^9, 3.594586689144812*^9, 
   3.594586737784449*^9, 3.5945867690611477`*^9, {3.594587710150086*^9, 
   3.5945877203928757`*^9}, 3.594587806512554*^9, 3.594587864027568*^9, 
   3.594587934702545*^9, 3.59458812962512*^9, 3.594588359635047*^9, 
   3.5945886902911386`*^9, 3.594588995206354*^9, 3.594589616968617*^9, 
   3.594589681603704*^9, {3.594589761936719*^9, 3.594589783488068*^9}, 
   3.5945898537459784`*^9, 3.594590616769312*^9, 3.5945906910447483`*^9, 
   3.594590739505232*^9, 3.594590896470245*^9, 3.5945912627216663`*^9, 
   3.594591338200192*^9, {3.594591494360224*^9, 3.594591518030984*^9}, 
   3.594591885533617*^9, {3.594592081521556*^9, 3.594592099943577*^9}, 
   3.594592169936145*^9, 3.602880991330386*^9, 3.6029523899132423`*^9, 
   3.6029526449938307`*^9, {3.602955512083975*^9, 3.602955519554864*^9}, 
   3.602955812150888*^9, {3.602955857068551*^9, 3.602955861583124*^9}, 
   3.6029576852392282`*^9, 3.602958571419764*^9, 3.603042599508027*^9, 
   3.60304317878784*^9, {3.6030432948267813`*^9, 3.60304331093071*^9}, 
   3.603043384124241*^9, 3.610388500674281*^9, 3.6103887748966303`*^9, 
   3.610389455570841*^9, 3.6115954141867037`*^9, {3.6127969852586946`*^9, 
   3.6127970032112837`*^9}, {3.61279705095109*^9, 3.6127970765544024`*^9}, 
   3.6127977503390627`*^9, 3.6275961952828007`*^9, 3.628178162394247*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", "\"\<..\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.450268464627475*^9, 3.450268482415883*^9}, {
  3.594592076804743*^9, 3.594592099609638*^9}, {3.6029523971509933`*^9, 
  3.602952400924651*^9}}],

Cell[BoxData["\<\"/Users/trvrb/Dropbox/current-projects/global-migration/age-\
structure\"\>"], "Output",
 CellChangeTimes->{
  3.6029524012097483`*^9, 3.6029526455527163`*^9, {3.602955512249918*^9, 
   3.602955519636869*^9}, 3.602955812282435*^9, {3.602955857217964*^9, 
   3.602955861700925*^9}, 3.602957685374885*^9, 3.602958571569599*^9, 
   3.603042600025105*^9, 3.603043178885858*^9, {3.603043294959683*^9, 
   3.6030433110653133`*^9}, 3.60304338425672*^9, 3.61038850078299*^9, 
   3.6103887750616407`*^9, 3.610389455705882*^9, 3.611595414338126*^9, {
   3.612796985372301*^9, 3.6127970033354273`*^9}, {3.612797051074552*^9, 
   3.612797076678597*^9}, 3.6127977504358788`*^9, 3.627596195558853*^9, 
   3.628178162737322*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"types", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<h3\>\"", ",", "\"\<h1\>\"", ",", "\"\<vic\>\"", ",", "\"\<yam\>\""}],
     "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.594579559635344*^9, 3.594579574094781*^9}}],

Cell[CellGroupData[{

Cell["Type colors", "Subsection",
 CellChangeTimes->{{3.5669122280573063`*^9, 3.566912229310246*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"yC", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.893", ",", "0.385", ",", "0.248"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.542728241553544*^9, 3.54272824857557*^9}, 
   3.542728554508416*^9, {3.5427293326845207`*^9, 3.542729332962269*^9}, 
   3.54278640839375*^9, 3.5635564719241467`*^9, {3.563615554881195*^9, 
   3.5636155755093317`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vC", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.894", ",", "0.664", ",", "0.303"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.542728252093964*^9, 3.542728263753111*^9}, {
   3.542728566407638*^9, 3.54272856651897*^9}, 3.5427286464272823`*^9, {
   3.542729334505932*^9, 3.542729334600424*^9}, 3.563556473074856*^9, {
   3.5636155627367697`*^9, 3.563615574964746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h1C", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.323", ",", "0.34", ",", "0.805"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.542728267275118*^9, 3.542728281166119*^9}, 
   3.5427285321396523`*^9, 3.56355647397123*^9, {3.56361558132379*^9, 
   3.563615585670574*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h3C", "=", 
   RowBox[{"RGBColor", "[", 
    RowBox[{"0.374", ",", "0.625", ",", "0.766"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.542728267275118*^9, 3.542728286246022*^9}, 
   3.5427286112351713`*^9, 3.5635564746992617`*^9, {3.5636155909939404`*^9, 
   3.563615601629912*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"typeColors", "=", 
   RowBox[{"{", 
    RowBox[{"h3C", ",", "h1C", ",", "vC", ",", "yC"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.542728288094841*^9, 3.542728302622429*^9}, {
   3.542728517415512*^9, 3.542728525780899*^9}, 3.5636131289581623`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"typeColorRules", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<H3N2\>\"", ",", "\"\<H1N1\>\"", ",", "\"\<Vic\>\"", ",", 
         "\"\<Yam\>\""}], "}"}], ",", "typeColors"}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.5669122366973*^9, 3.5669122848185177`*^9}, {
  3.59388773666232*^9, 3.59388773999433*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"imageResolution", "=", "300"}], ";"}]], "Input",
 CellChangeTimes->{{3.6029547948541613`*^9, 3.6029547987880697`*^9}, {
  3.610388499430908*^9, 3.610388499511239*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Demographic structure", "Section",
 CellChangeTimes->{{3.6115956516890707`*^9, 3.611595664939172*^9}}],

Cell["Children are 15 and under", "Text",
 CellChangeTimes->{{3.611596639457961*^9, 3.611596644577279*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ukChildrenPro", "=", 
  RowBox[{
   RowBox[{"CountryData", "[", 
    RowBox[{"\"\<UnitedKingdom\>\"", ",", "\"\<ChildPopulation\>\""}], "]"}], 
   "/", 
   RowBox[{"CountryData", "[", 
    RowBox[{"\"\<UnitedKingdom\>\"", ",", "\"\<Population\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.61159574638513*^9, 3.6115957792541924`*^9}}],

Cell[BoxData["0.17223318505088347`"], "Output",
 CellChangeTimes->{
  3.61159577976236*^9, {3.612796986491025*^9, 3.612797003601575*^9}, {
   3.612797051323977*^9, 3.612797076927906*^9}, 3.612797750668977*^9, 
   3.627596198048295*^9, 3.628178166605122*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ausChildrenPro", "=", 
  RowBox[{
   RowBox[{"CountryData", "[", 
    RowBox[{"\"\<Australia\>\"", ",", "\"\<ChildPopulation\>\""}], "]"}], "/", 
   RowBox[{"CountryData", "[", 
    RowBox[{"\"\<Australia\>\"", ",", "\"\<Population\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.61159574638513*^9, 3.6115957792541924`*^9}, {
  3.61159581863964*^9, 3.6115958275404463`*^9}}],

Cell[BoxData["0.18789436335843876`"], "Output",
 CellChangeTimes->{
  3.611595827967293*^9, {3.6127969866051683`*^9, 3.61279700364147*^9}, {
   3.612797051362502*^9, 3.612797076966516*^9}, 3.612797750717033*^9, 
   3.627596198301756*^9, 3.62817816689424*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"childrenPro", "=", 
  RowBox[{"Mean", "[", 
   RowBox[{"{", 
    RowBox[{"ukChildrenPro", ",", "ausChildrenPro"}], "}"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.611595831517083*^9, 3.611595841731648*^9}}],

Cell[BoxData["0.18006377420466113`"], "Output",
 CellChangeTimes->{
  3.6115958422785053`*^9, {3.612796986643243*^9, 3.6127970036928587`*^9}, {
   3.612797051411632*^9, 3.612797077016678*^9}, 3.612797750753077*^9, 
   3.627596198348768*^9, 3.628178167007036*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"adultPro", "=", 
  RowBox[{"1", "-", "childrenPro"}]}]], "Input",
 CellChangeTimes->{{3.611595831517083*^9, 3.611595841731648*^9}, {
  3.61159597725968*^9, 3.6115959831930437`*^9}}],

Cell[BoxData["0.8199362257953389`"], "Output",
 CellChangeTimes->{
  3.611595983574086*^9, {3.612796986694881*^9, 3.6127970037691107`*^9}, {
   3.612797051462307*^9, 3.612797077065782*^9}, 3.612797750801457*^9, 
   3.627596198400671*^9, 3.628178167073802*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bins", "Section",
 CellChangeTimes->{{3.602953302182982*^9, 3.6029533025300837`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bins", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "15"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"16", ",", "19"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"20", ",", "24"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"25", ",", "34"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"35", ",", "44"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"45", ",", "54"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"55", ",", "59"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"60", ",", "64"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"65", ",", "74"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"75", ",", "100"}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602953303610051*^9, 3.602953323976222*^9}, {
  3.6103893312050543`*^9, 3.61038933132405*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Air travel", "Section",
 CellChangeTimes->{{3.6028810805606813`*^9, 3.602881084085781*^9}}],

Cell[CellGroupData[{

Cell["Full distribution", "Subsection",
 CellChangeTimes->{{3.611596061238963*^9, 3.611596063070509*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"heathrow", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<data/heathrow.tsv\>\"", ",", "\"\<Table\>\""}], "]"}], ",",
      "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6029526474737167`*^9, 3.602952669800108*^9}, 
   3.602954757590993*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"gatwick", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"\"\<data/gatwick.tsv\>\"", ",", "\"\<Table\>\""}], "]"}], ",", 
     "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6029526474737167`*^9, 3.602952677377708*^9}, 
   3.602954758557539*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"travel", "=", 
   RowBox[{
    RowBox[{"Mean", "[", 
     RowBox[{"{", 
      RowBox[{"heathrow", ",", "gatwick"}], "}"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602881452097567*^9, 3.6028814668314667`*^9}, {
   3.6029535773298607`*^9, 3.6029535790035143`*^9}, 3.602954759646852*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"lines", "=", 
   RowBox[{"MapThread", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "#2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "#2"}], "}"}]}], "}"}], "&"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"bins", ",", "travel"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.610389163442658*^9, 3.6103892018262863`*^9}, {
   3.6103892623999453`*^9, 3.610389312289946*^9}, {3.610389370258877*^9, 
   3.6103893847599792`*^9}, 3.610389452737589*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fig", "=", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{"lines", ",", 
    RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
    RowBox[{"AspectRatio", "\[Rule]", "0.65"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Age\>\"", ",", "\"\<% of passengers\>\""}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
    RowBox[{"FillingStyle", "\[Rule]", "LightGray"}], ",", 
    RowBox[{"Filling", "\[Rule]", "Axis"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.610389208213854*^9, 3.6103892409389343`*^9}, {
  3.610389390261176*^9, 3.610389444322372*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, GraphicsComplexBox[CompressedData["
1:eJxd0DEKwjAUBuCgsxcQB4XSSUolFdrJl6VLbCnZugqdvUKuodfoBTyAF/Ac
Tm62yVN4/w/h8fFe0jS7y9UNC6XUflpz/eUW8jlFJSSd0j14SdEZOCcdsmJr
cEHPOeeEXYKreN7ryDbS3lAxHzdq7tfSvub7HLhvpb2N9xm37EZatVw3XDtp
6uL39Jr3O+mH4/9983v10lNfifTS1El7nG/BOG/BDbiG/ThvoI/zFRjnC3AJ
zsEanIIzMCb597+sEV1q
    "], {{{}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{1, 43, 44, 2}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{3, 41, 42, 4}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{5, 39, 40, 6}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{7, 37, 38, 8}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{9, 35, 36, 10}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{11, 33, 34, 12}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{13, 31, 32, 14}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{15, 29, 30, 16}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{17, 27, 28, 18}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[PolygonBox[{{19, 25, 26, 20}}]]}, {}, 
      {GrayLevel[0.85], EdgeForm[None], 
       GraphicsGroupBox[
        PolygonBox[{{21, 23, 24, 
         22}}]]}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}}, {{}, {}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{1, 2}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{3, 4}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{5, 6}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{7, 8}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{9, 10}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{11, 12}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{13, 14}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{15, 16}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{17, 18}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{19, 20}]}, 
      {GrayLevel[0], PointSize[0.019444444444444445`], AbsoluteThickness[1.6],
        LineBox[{21, 22}]}}}], {}},
  AspectRatio->0.65,
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{True, False}, {True, False}},
  FrameLabel->{{
     FormBox["\"% of passengers\"", TraditionalForm], None}, {
     FormBox["\"Age\"", TraditionalForm], None}},
  FrameStyle->GrayLevel[0],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  FrameTicksStyle->{},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->300,
  LabelStyle->Directive[
    GrayLevel[0], FontSize -> 10, FontFamily -> "Helvetica"],
  Method->{},
  PlotRange->{{0, 100.}, {0, 21.85}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {0, 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.610389208720807*^9, 3.61038924184758*^9}, {
   3.610389314007594*^9, 3.610389337108387*^9}, {3.610389390670295*^9, 
   3.6103894564067163`*^9}, 3.6115954148576727`*^9, 3.611595886216834*^9, 
   3.611596659415183*^9, {3.612796987052374*^9, 3.6127970039726887`*^9}, {
   3.612797051660058*^9, 3.61279707725463*^9}, 3.612797751004571*^9, 
   3.6275961986029053`*^9, 3.6281781690654*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<figures/air-travel-by-age.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602954765978997*^9, 3.6029547907877483`*^9}, {
  3.6029548245093718`*^9, 3.602954827079212*^9}}],

Cell[BoxData["\<\"figures/air-travel-by-age.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.602954791435279*^9, 3.602954827623211*^9, {3.602955512882473*^9, 
   3.602955520179544*^9}, 3.60295581287882*^9, {3.6029558578178997`*^9, 
   3.602955862303747*^9}, 3.602957685907942*^9, 3.60295857216477*^9, 
   3.6030426076912327`*^9, 3.603043179557057*^9, {3.6030432955826902`*^9, 
   3.603043311836234*^9}, 3.6030433849402637`*^9, 3.6103885015147467`*^9, 
   3.6103887757811527`*^9, 3.6103890856537437`*^9, 3.6103894566092443`*^9, 
   3.6115954151746597`*^9, 3.61159588645744*^9, 3.611596659637719*^9, {
   3.612796987325362*^9, 3.6127970041876783`*^9}, {3.612797051808714*^9, 
   3.6127970774460707`*^9}, 3.612797751240596*^9, 3.627596198910071*^9, 
   3.628178169954405*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<figures/air-travel-by-age.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", 
   ",", 
   RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602954765978997*^9, 3.60295483076705*^9}}],

Cell[BoxData["\<\"figures/air-travel-by-age.png\"\>"], "Output",
 CellChangeTimes->{{3.602954812343308*^9, 3.6029548312272453`*^9}, {
   3.6029555130027113`*^9, 3.602955520275483*^9}, 3.602955812987924*^9, {
   3.602955857921151*^9, 3.602955862404182*^9}, 3.6029576860056257`*^9, 
   3.6029585722642717`*^9, 3.6030426080236893`*^9, 3.603043179672154*^9, {
   3.603043295887805*^9, 3.60304331195111*^9}, 3.6030433850614443`*^9, 
   3.610388501846098*^9, 3.61038877606038*^9, 3.610389085973114*^9, 
   3.610389456958489*^9, 3.611595415571958*^9, 3.611595886761676*^9, 
   3.611596660148038*^9, {3.612796987683873*^9, 3.612797004455738*^9}, {
   3.612797052086063*^9, 3.612797077718081*^9}, 3.612797751515614*^9, 
   3.627596199732275*^9, 3.62817817043642*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two compartments", "Subsection",
 CellChangeTimes->{{3.6115960675626507`*^9, 3.611596071124996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"threshold", "=", "2"}], ";"}]], "Input",
 CellChangeTimes->{{3.612798861287732*^9, 3.61279886378043*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"travel", "[", 
   RowBox[{"[", 
    RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.611595542556134*^9, 3.611595543229436*^9}, {
   3.6115958936134357`*^9, 3.6115959062772207`*^9}, 3.611596655216242*^9}],

Cell[BoxData["4.05`"], "Output",
 CellChangeTimes->{
  3.611595543557601*^9, {3.611595886803257*^9, 3.611595906714089*^9}, 
   3.6115966602017193`*^9, {3.612796987806842*^9, 3.612797004537855*^9}, {
   3.612797052158463*^9, 3.612797077794828*^9}, 3.6127977517324677`*^9, 
   3.6275962001672993`*^9, 3.6281781705391006`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"travel", "[", 
   RowBox[{"[", 
    RowBox[{"3", ";;", 
     RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.611595542556134*^9, 3.611595543229436*^9}, {
   3.6115958936134357`*^9, 3.611595910721637*^9}, 3.611596656229388*^9}],

Cell[BoxData["96.05000000000001`"], "Output",
 CellChangeTimes->{{3.611595900808569*^9, 3.6115959111667233`*^9}, 
   3.611596660280905*^9, {3.612796987846755*^9, 3.612797004575487*^9}, {
   3.612797052197255*^9, 3.612797077835595*^9}, 3.612797751832079*^9, 
   3.627596200193729*^9, 3.628178170602108*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"childrenRate", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"travel", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}], "/", 
   "childrenPro"}]}]], "Input",
 CellChangeTimes->{{3.611595961869681*^9, 3.611596012796894*^9}, 
   3.6115966649495983`*^9, {3.612798872193824*^9, 3.612798873980254*^9}}],

Cell[BoxData["22.492031047826174`"], "Output",
 CellChangeTimes->{{3.6115959932159233`*^9, 3.6115960131316643`*^9}, {
   3.611596660385673*^9, 3.611596667652569*^9}, {3.612796987895431*^9, 
   3.612797004626403*^9}, {3.6127970522473803`*^9, 3.6127970778841133`*^9}, 
   3.6127977519209127`*^9, 3.6275962002433567`*^9, 3.628178170705209*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"adultRate", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{"travel", "[", 
     RowBox[{"[", 
      RowBox[{"3", ";;", 
       RowBox[{"-", "1"}]}], "]"}], "]"}], "]"}], "/", 
   "adultPro"}]}]], "Input",
 CellChangeTimes->{{3.611595961869681*^9, 3.6115960176879168`*^9}, 
   3.61159666619668*^9}],

Cell[BoxData["117.14325697322548`"], "Output",
 CellChangeTimes->{{3.6115960053266363`*^9, 3.611596018335326*^9}, {
   3.61159666043664*^9, 3.6115966685201283`*^9}, {3.612796987948806*^9, 
   3.6127970046760063`*^9}, {3.612797052297512*^9, 3.612797077935062*^9}, 
   3.612797751954341*^9, 3.627596200292316*^9, 3.6281781708049192`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"childrenRatio", "=", 
  RowBox[{"childrenRate", "/", "adultRate"}]}]], "Input",
 CellChangeTimes->{{3.611596036076109*^9, 3.611596045532529*^9}}],

Cell[BoxData["0.19200448774415588`"], "Output",
 CellChangeTimes->{
  3.611596046040991*^9, {3.6115966604860287`*^9, 3.6115966695205517`*^9}, {
   3.6127969879969273`*^9, 3.612797004715518*^9}, {3.6127970523477297`*^9, 
   3.612797077984923*^9}, 3.6127977519875803`*^9, 3.627596200374187*^9, 
   3.6281781709228153`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Incidence", "Section",
 CellChangeTimes->{{3.602952687741786*^9, 3.602952689048003*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"cutoff", "=", "6"}], ";"}]], "Input",
 CellChangeTimes->{{3.603043016030816*^9, 3.603043035491124*^9}, {
   3.603043119515132*^9, 3.60304313741847*^9}, {3.603043293933051*^9, 
   3.603043310204413*^9}, 3.6030433826394377`*^9, 3.611596421193048*^9, 
   3.612797001936675*^9, {3.612797049683922*^9, 3.612797075363038*^9}, {
   3.627596264964377*^9, 3.627596278194804*^9}, {3.627596308371526*^9, 
   3.62759631913805*^9}, 3.62759643527174*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"typeIndex", "=", "1"}], ";", 
  RowBox[{"ageIndex", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.6030428841033287`*^9, 3.603042889677252*^9}, {
  3.628178179671461*^9, 3.628178181062818*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"inc", "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<data/melb-isolations.tsv\>\"", ",", "\"\<Table\>\""}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602953020749817*^9, 3.602953038987446*^9}, 
   3.602953078525647*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"header", "=", 
  RowBox[{"inc", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.628178189056959*^9, 3.628178192278142*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"virus\"\>", ",", "\<\"strain\"\>", 
   ",", "\<\"age_of_infection\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.628178192632897*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"inc", "=", 
   RowBox[{"Drop", "[", 
    RowBox[{"inc", ",", "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.62817819405552*^9, 3.628178197902145*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"types", "=", 
  RowBox[{"{", 
   RowBox[{"\"\<H3\>\"", ",", "\"\<H1\>\"", ",", "\"\<B\>\""}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.602953185439044*^9, 3.602953203024227*^9}, {
  3.603042853734915*^9, 3.603042855008334*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"H3\"\>", ",", "\<\"H1\"\>", ",", "\<\"B\"\>"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6029532034119387`*^9, 3.602954160848713*^9, {3.602954385321333*^9, 
   3.6029544098542767`*^9}, {3.602954464562872*^9, 3.6029544778783207`*^9}, 
   3.602954630479636*^9, 3.6029546672579327`*^9, {3.6029555136908693`*^9, 
   3.6029555208386793`*^9}, 3.6029558136070023`*^9, {3.602955858522903*^9, 
   3.602955863070526*^9}, 3.602957686615816*^9, 3.602958572796693*^9, {
   3.603042840655388*^9, 3.6030428643810062`*^9}, {3.603043027084296*^9, 
   3.603043037359396*^9}, {3.6030431227063932`*^9, 3.603043139287368*^9}, 
   3.6030431800364857`*^9, {3.603043296330193*^9, 3.603043312427204*^9}, 
   3.60304338540231*^9, 3.610388502730547*^9, 3.61038877670614*^9, 
   3.610389457780676*^9, 3.611595415978598*^9, 3.611596311641927*^9, 
   3.611596423127905*^9, {3.612796988312916*^9, 3.612797005109839*^9}, {
   3.612797052647189*^9, 3.612797078285046*^9}, 3.6127977523040657`*^9, {
   3.627596201024914*^9, 3.6275962171779413`*^9}, {3.627596267593195*^9, 
   3.627596322308846*^9}, 3.627596437813909*^9, 3.628178201552494*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"inc", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{"inc", ",", 
     RowBox[{"x_", "/;", 
      RowBox[{
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "ageIndex", "]"}], "]"}], "\[GreaterEqual]", "cutoff"}],
        "&&", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "ageIndex", "]"}], "]"}], "\[LessEqual]", "100"}]}]}]}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602954001728909*^9, 3.602954033472814*^9}, {
   3.6029541576676617`*^9, 3.602954157761983*^9}, {3.602954381903796*^9, 
   3.6029544072775373`*^9}, {3.602954461711166*^9, 3.602954475866777*^9}, 
   3.60295461438413*^9, 3.60295466510375*^9, 3.602955856387876*^9, 
   3.602958570570224*^9, {3.603042868017643*^9, 3.6030428975343933`*^9}, 
   3.60304302400299*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h3Ages", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"inc", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "typeIndex", "]"}], "]"}], "\[Equal]", 
        "\"\<H3\>\""}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "ageIndex"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6029532084432898`*^9, 3.602953246772229*^9}, {
  3.6030428803857727`*^9, 3.603042909094768*^9}, {3.6115955007630463`*^9, 
  3.6115955032626333`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h1Ages", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"inc", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "typeIndex", "]"}], "]"}], "\[Equal]", 
        "\"\<H1\>\""}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "ageIndex"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6029532084432898`*^9, 3.602953252082004*^9}, {
  3.603042913949085*^9, 3.603042949899911*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bAges", "=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"inc", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "typeIndex", "]"}], "]"}], "\[Equal]", 
        "\"\<B\>\""}]}]}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "ageIndex"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6029532084432898`*^9, 3.60295326556074*^9}, {
  3.602954491633998*^9, 3.6029545047103567`*^9}, {3.60304292560962*^9, 
  3.603042956106414*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"means", "=", 
  RowBox[{"Map", "[", 
   RowBox[{"Mean", ",", 
    RowBox[{"{", 
     RowBox[{"h3Ages", ",", "h1Ages", ",", "bAges"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.602954882857263*^9, 3.6029549029486217`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "35.297560975609755`", ",", "24.952737752161383`", ",", 
   "24.242593957258656`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.60295490336455*^9, {3.602955513952985*^9, 3.602955521163597*^9}, 
   3.602955813851405*^9, {3.60295585889891*^9, 3.602955863387804*^9}, 
   3.6029576869544992`*^9, 3.602958573060244*^9, {3.603042934948209*^9, 
   3.603042957461945*^9}, {3.6030430272677*^9, 3.603043037603093*^9}, {
   3.6030431229605722`*^9, 3.603043139538065*^9}, 3.603043180220789*^9, {
   3.603043296510504*^9, 3.60304331265938*^9}, 3.60304338559019*^9, 
   3.610388503259926*^9, 3.6103887769814463`*^9, 3.610389458370987*^9, 
   3.611595416307617*^9, 3.6115963118862047`*^9, 3.6115964233411922`*^9, {
   3.612796988473686*^9, 3.612797005270472*^9}, {3.612797052808091*^9, 
   3.6127970784448013`*^9}, 3.6127977524557962`*^9, {3.6275962011678257`*^9, 
   3.627596221319961*^9}, {3.627596267679006*^9, 3.627596281579612*^9}, {
   3.6275963115866528`*^9, 3.6275963224015913`*^9}, 3.627596437936397*^9, 
   3.628178207408825*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Map", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Round", "[", 
     RowBox[{
      RowBox[{"Median", "[", "#", "]"}], ",", "0.01"}], "]"}], "&"}], ",", 
   RowBox[{"{", 
    RowBox[{"h3Ages", ",", "h1Ages", ",", "bAges"}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.602954882857263*^9, 3.6029549029486217`*^9}, {
  3.627596224432517*^9, 3.627596230109684*^9}, {3.62759659501614*^9, 
  3.62759660534107*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"30.`", ",", "20.`", ",", "16.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.62759623052934*^9, {3.62759626773555*^9, 3.6275963224725723`*^9}, 
   3.6275964379968557`*^9, {3.627596597779599*^9, 3.627596605600008*^9}, 
   3.628178208499062*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LocationTest", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h3Ages", ",", "h1Ages"}], "}"}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<TestDataTable\>\"", ",", "All"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.627596374447462*^9, 3.6275964099695*^9}}],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"\<\"Mann\[Hyphen]Whitney\"\>", "1.072888`*^6", 
      "4.614424074321183`*^-29"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.627596394858869*^9, 3.627596438051879*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LocationTest", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h3Ages", ",", "bAges"}], "}"}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<TestDataTable\>\"", ",", "All"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.627596374447462*^9, 3.627596428965312*^9}}],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"\<\"Mann\[Hyphen]Whitney\"\>", "2.178062`*^6", 
      "1.2374649865626927`*^-62"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.627596394858869*^9, 3.62759643812458*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LocationTest", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"h1Ages", ",", "bAges"}], "}"}], ",", "0", ",", 
   RowBox[{"{", 
    RowBox[{"\"\<TestDataTable\>\"", ",", "All"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.627596374447462*^9, 3.6275964189176197`*^9}}],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"\"\>", "\<\"Statistic\"\>", "\<\"P\[Hyphen]Value\"\>"},
     {"\<\"Mann\[Hyphen]Whitney\"\>", "496849.`", "0.04056552167415119`"}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Automatic}}},
    GridBoxDividers->{
     "ColumnsIndexed" -> {2 -> GrayLevel[0.7]}, 
      "RowsIndexed" -> {2 -> GrayLevel[0.7]}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
    GridBoxSpacings->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "DialogStyle",
  StripOnInput->False]], "Output",
 CellChangeTimes->{{3.627596419321847*^9, 3.6275964381880198`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"fig", "=", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Histogram", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "100", ",", "2"}], "}"}], ",", 
            RowBox[{"AspectRatio", "\[Rule]", "0.65"}], ",", 
            RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
            RowBox[{"ChartBaseStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"EdgeForm", "[", "Thin", "]"}], "]"}]}], ",", 
            RowBox[{"ChartStyle", "\[Rule]", "#2"}], ",", 
            RowBox[{"PlotLabel", "\[Rule]", 
             RowBox[{"#3", "<>", "\"\< mean age = \>\"", "<>", 
              RowBox[{"ToString", "[", 
               RowBox[{"Round", "[", 
                RowBox[{"#4", ",", "0.1"}], "]"}], "]"}]}]}], ",", 
            RowBox[{"FrameLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\"\<Age\>\"", ",", "\"\<Count\>\""}], "}"}]}]}], "]"}],
           "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"h3Ages", ",", "h1Ages", ",", "bAges"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"h3C", ",", "h1C", ",", "vC"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\"\<H3\>\"", ",", "\"\<H1\>\"", ",", "\"\<B\>\""}], 
            "}"}], ",", "means"}], "}"}]}], "]"}], ",", "3"}], "]"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602953266516218*^9, 3.602953274837566*^9}, {
   3.602954297719298*^9, 3.602954362717514*^9}, {3.6029545083407393`*^9, 
   3.6029545335800943`*^9}, {3.602954681968195*^9, 3.602954744195059*^9}, {
   3.602954865253454*^9, 3.6029548784202747`*^9}, {3.602954914567095*^9, 
   3.602954942730447*^9}, 3.602955517713441*^9, 3.603042974887992*^9, 
   3.603043174828402*^9, {3.6103885843779087`*^9, 3.610388605765809*^9}, {
   3.6103886398420467`*^9, 3.610388691895722*^9}, {3.610388729827363*^9, 
   3.61038877398638*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"fig", "=", 
  RowBox[{"Grid", "[", 
   RowBox[{
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Histogram", "[", 
          RowBox[{"#1", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "100", ",", "2"}], "}"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "400"}], ",", 
           RowBox[{"ChartBaseStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{"EdgeForm", "[", "Thin", "]"}], "]"}]}], ",", 
           RowBox[{"ChartStyle", "\[Rule]", "#2"}], ",", 
           RowBox[{"Epilog", "\[Rule]", 
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"Text", "[", 
               RowBox[{
                RowBox[{"#3", "<>", "\"\< mean age = \>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"Round", "[", 
                   RowBox[{"#4", ",", "0.1"}], "]"}], "]"}]}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
              RowBox[{"FontSize", "\[Rule]", "11"}]}], "]"}]}], ",", 
           RowBox[{"FrameLabel", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<Age\>\"", ",", "\"\<Count\>\""}], "}"}]}]}], "]"}], 
         "&"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"h3Ages", ",", "h1Ages", ",", "bAges"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"h3C", ",", "h1C", ",", "vC"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<H3\>\"", ",", "\"\<H1\>\"", ",", "\"\<B\>\""}], "}"}],
           ",", "means"}], "}"}]}], "]"}], ",", "1"}], "]"}], ",", 
    RowBox[{"Spacings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602953266516218*^9, 3.602953274837566*^9}, {
   3.602954297719298*^9, 3.602954362717514*^9}, {3.6029545083407393`*^9, 
   3.6029545335800943`*^9}, {3.602954681968195*^9, 3.602954744195059*^9}, {
   3.602954865253454*^9, 3.6029548784202747`*^9}, {3.602954914567095*^9, 
   3.602954942730447*^9}, 3.602955517713441*^9, 3.603042974887992*^9, 
   3.603043174828402*^9, {3.6103885843779087`*^9, 3.610388605765809*^9}, {
   3.6103886398420467`*^9, 3.610388691895722*^9}, {3.610388729827363*^9, 
   3.61038877398638*^9}, {3.61038883367879*^9, 3.610388981822796*^9}, 
   3.6115963094142847`*^9}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     GraphicsBox[{
       {RGBColor[0.374, 0.625, 0.766], EdgeForm[{Opacity[0.35], Thickness[
        Tiny]}], {}, 
        {RGBColor[0.374, 0.625, 0.766], EdgeForm[{Opacity[0.35], Thickness[
         Tiny]}], RectangleBox[{6., 0}, {8., 162},
          RoundingRadius->0], RectangleBox[{8., 0}, {10., 97},
          RoundingRadius->0], RectangleBox[{10., 0}, {12., 84},
          RoundingRadius->0], RectangleBox[{12., 0}, {14., 84},
          RoundingRadius->0], RectangleBox[{14., 0}, {16., 83},
          RoundingRadius->0], RectangleBox[{16., 0}, {18., 89},
          RoundingRadius->0], RectangleBox[{18., 0}, {20., 93},
          RoundingRadius->0], RectangleBox[{20., 0}, {22., 112},
          RoundingRadius->0], RectangleBox[{22., 0}, {24., 105},
          RoundingRadius->0], RectangleBox[{24., 0}, {26., 87},
          RoundingRadius->0], RectangleBox[{26., 0}, {28., 98},
          RoundingRadius->0], RectangleBox[{28., 0}, {30., 77},
          RoundingRadius->0], RectangleBox[{30., 0}, {32., 87},
          RoundingRadius->0], RectangleBox[{32., 0}, {34., 90},
          RoundingRadius->0], RectangleBox[{34., 0}, {36., 73},
          RoundingRadius->0], RectangleBox[{36., 0}, {38., 64},
          RoundingRadius->0], RectangleBox[{38., 0}, {40., 62},
          RoundingRadius->0], RectangleBox[{40., 0}, {42., 51},
          RoundingRadius->0], RectangleBox[{42., 0}, {44., 50},
          RoundingRadius->0], RectangleBox[{44., 0}, {46., 47},
          RoundingRadius->0], RectangleBox[{46., 0}, {48., 49},
          RoundingRadius->0], RectangleBox[{48., 0}, {50., 42},
          RoundingRadius->0], RectangleBox[{50., 0}, {52., 48},
          RoundingRadius->0], RectangleBox[{52., 0}, {54., 39},
          RoundingRadius->0], RectangleBox[{54., 0}, {56., 31},
          RoundingRadius->0], RectangleBox[{56., 0}, {58., 35},
          RoundingRadius->0], RectangleBox[{58., 0}, {60., 44},
          RoundingRadius->0], RectangleBox[{60., 0}, {62., 43},
          RoundingRadius->0], RectangleBox[{62., 0}, {64., 47},
          RoundingRadius->0], RectangleBox[{64., 0}, {66., 41},
          RoundingRadius->0], RectangleBox[{66., 0}, {68., 36},
          RoundingRadius->0], RectangleBox[{68., 0}, {70., 37},
          RoundingRadius->0], RectangleBox[{70., 0}, {72., 24},
          RoundingRadius->0], RectangleBox[{72., 0}, {74., 37},
          RoundingRadius->0], RectangleBox[{74., 0}, {76., 22},
          RoundingRadius->0], RectangleBox[{76., 0}, {78., 21},
          RoundingRadius->0], RectangleBox[{78., 0}, {80., 22},
          RoundingRadius->0], RectangleBox[{80., 0}, {82., 22},
          RoundingRadius->0], RectangleBox[{82., 0}, {84., 20},
          RoundingRadius->0], RectangleBox[{84., 0}, {86., 27},
          RoundingRadius->0], RectangleBox[{86., 0}, {88., 12},
          RoundingRadius->0], RectangleBox[{88., 0}, {90., 10},
          RoundingRadius->0], RectangleBox[{90., 0}, {92., 3},
          RoundingRadius->0], RectangleBox[{92., 0}, {94., 6},
          RoundingRadius->0], RectangleBox[{94., 0}, {96., 4},
          RoundingRadius->0], RectangleBox[{98., 0}, {100., 2},
          
          RoundingRadius->
           0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
      AspectRatio->0.3,
      Axes->{False, False},
      AxesLabel->{None, None},
      AxesOrigin->{4.12, 0},
      Epilog->StyleBox[
        InsetBox[
         FormBox["\"H3 mean age = 35.3\"", TraditionalForm], 
         Scaled[{1, 1}], {1, 1}], FontFamily -> "Helvetica", FontSize -> 11, 
        StripOnInput -> False],
      Frame->{True, True, False, False},
      FrameLabel->{{
         FormBox["\"Count\"", TraditionalForm], None}, {
         FormBox["\"Age\"", TraditionalForm], None}},
      FrameStyle->GrayLevel[0],
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      FrameTicksStyle->GrayLevel[0],
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImageSize->400,
      LabelStyle->Directive[
        GrayLevel[0], FontSize -> 10, FontFamily -> "Helvetica"],
      PlotRange->{{0., 100.}, {0, All}},
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {None, 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}]},
    {
     GraphicsBox[{
       {RGBColor[0.323, 0.34, 0.805], EdgeForm[{Opacity[0.35], Thickness[
        Tiny]}], {}, 
        {RGBColor[0.323, 0.34, 0.805], EdgeForm[{Opacity[0.35], Thickness[
         Tiny]}], RectangleBox[{6., 0}, {8., 90},
          RoundingRadius->0], RectangleBox[{8., 0}, {10., 74},
          RoundingRadius->0], RectangleBox[{10., 0}, {12., 50},
          RoundingRadius->0], RectangleBox[{12., 0}, {14., 36},
          RoundingRadius->0], RectangleBox[{14., 0}, {16., 22},
          RoundingRadius->0], RectangleBox[{16., 0}, {18., 41},
          RoundingRadius->0], RectangleBox[{18., 0}, {20., 30},
          RoundingRadius->0], RectangleBox[{20., 0}, {22., 20},
          RoundingRadius->0], RectangleBox[{22., 0}, {24., 28},
          RoundingRadius->0], RectangleBox[{24., 0}, {26., 28},
          RoundingRadius->0], RectangleBox[{26., 0}, {28., 14},
          RoundingRadius->0], RectangleBox[{28., 0}, {30., 9},
          RoundingRadius->0], RectangleBox[{30., 0}, {32., 13},
          RoundingRadius->0], RectangleBox[{32., 0}, {34., 20},
          RoundingRadius->0], RectangleBox[{34., 0}, {36., 22},
          RoundingRadius->0], RectangleBox[{36., 0}, {38., 30},
          RoundingRadius->0], RectangleBox[{38., 0}, {40., 21},
          RoundingRadius->0], RectangleBox[{40., 0}, {42., 24},
          RoundingRadius->0], RectangleBox[{42., 0}, {44., 21},
          RoundingRadius->0], RectangleBox[{44., 0}, {46., 6},
          RoundingRadius->0], RectangleBox[{46., 0}, {48., 22},
          RoundingRadius->0], RectangleBox[{48., 0}, {50., 6},
          RoundingRadius->0], RectangleBox[{50., 0}, {52., 7},
          RoundingRadius->0], RectangleBox[{52., 0}, {54., 6},
          RoundingRadius->0], RectangleBox[{54., 0}, {56., 5},
          RoundingRadius->0], RectangleBox[{56., 0}, {58., 8},
          RoundingRadius->0], RectangleBox[{58., 0}, {60., 13},
          RoundingRadius->0], RectangleBox[{60., 0}, {62., 3},
          RoundingRadius->0], RectangleBox[{62., 0}, {64., 4},
          RoundingRadius->0], RectangleBox[{64., 0}, {66., 8},
          RoundingRadius->0], RectangleBox[{66., 0}, {68., 1},
          RoundingRadius->0], RectangleBox[{68., 0}, {70., 3},
          RoundingRadius->0], RectangleBox[{70., 0}, {72., 1},
          RoundingRadius->0], RectangleBox[{72., 0}, {74., 2},
          RoundingRadius->0], RectangleBox[{76., 0}, {78., 2},
          RoundingRadius->0], RectangleBox[{80., 0}, {82., 1},
          RoundingRadius->0], RectangleBox[{82., 0}, {84., 1},
          RoundingRadius->0], RectangleBox[{94., 0}, {96., 1},
          RoundingRadius->0], RectangleBox[{98., 0}, {100., 1},
          
          RoundingRadius->
           0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}}},
      AspectRatio->0.3,
      Axes->{False, False},
      AxesLabel->{None, None},
      AxesOrigin->{4.12, 0},
      Epilog->StyleBox[
        InsetBox[
         FormBox["\"H1 mean age = 25.\"", TraditionalForm], 
         Scaled[{1, 1}], {1, 1}], FontFamily -> "Helvetica", FontSize -> 11, 
        StripOnInput -> False],
      Frame->{True, True, False, False},
      FrameLabel->{{
         FormBox["\"Count\"", TraditionalForm], None}, {
         FormBox["\"Age\"", TraditionalForm], None}},
      FrameStyle->GrayLevel[0],
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      FrameTicksStyle->GrayLevel[0],
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImageSize->400,
      LabelStyle->Directive[
        GrayLevel[0], FontSize -> 10, FontFamily -> "Helvetica"],
      PlotRange->{{0., 100.}, {0, All}},
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {None, 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}]},
    {
     GraphicsBox[{
       {RGBColor[0.894, 0.664, 0.303], EdgeForm[{Opacity[0.371], Thickness[
        Tiny]}], {}, 
        {RGBColor[0.894, 0.664, 0.303], EdgeForm[{Opacity[0.371], Thickness[
         Tiny]}], RectangleBox[{6., 0}, {8., 183},
          RoundingRadius->0], RectangleBox[{8., 0}, {10., 157},
          RoundingRadius->0], RectangleBox[{10., 0}, {12., 121},
          RoundingRadius->0], RectangleBox[{12., 0}, {14., 115},
          RoundingRadius->0], RectangleBox[{14., 0}, {16., 86},
          RoundingRadius->0], RectangleBox[{16., 0}, {18., 71},
          RoundingRadius->0], RectangleBox[{18., 0}, {20., 57},
          RoundingRadius->0], RectangleBox[{20., 0}, {22., 45},
          RoundingRadius->0], RectangleBox[{22., 0}, {24., 28},
          RoundingRadius->0], RectangleBox[{24., 0}, {26., 26},
          RoundingRadius->0], RectangleBox[{26., 0}, {28., 38},
          RoundingRadius->0], RectangleBox[{28., 0}, {30., 21},
          RoundingRadius->0], RectangleBox[{30., 0}, {32., 22},
          RoundingRadius->0], RectangleBox[{32., 0}, {34., 25},
          RoundingRadius->0], RectangleBox[{34., 0}, {36., 23},
          RoundingRadius->0], RectangleBox[{36., 0}, {38., 29},
          RoundingRadius->0], RectangleBox[{38., 0}, {40., 27},
          RoundingRadius->0], RectangleBox[{40., 0}, {42., 27},
          RoundingRadius->0], RectangleBox[{42., 0}, {44., 18},
          RoundingRadius->0], RectangleBox[{44., 0}, {46., 18},
          RoundingRadius->0], RectangleBox[{46., 0}, {48., 18},
          RoundingRadius->0], RectangleBox[{48., 0}, {50., 27},
          RoundingRadius->0], RectangleBox[{50., 0}, {52., 14},
          RoundingRadius->0], RectangleBox[{52., 0}, {54., 16},
          RoundingRadius->0], RectangleBox[{54., 0}, {56., 14},
          RoundingRadius->0], RectangleBox[{56., 0}, {58., 19},
          RoundingRadius->0], RectangleBox[{58., 0}, {60., 8},
          RoundingRadius->0], RectangleBox[{60., 0}, {62., 12},
          RoundingRadius->0], RectangleBox[{62., 0}, {64., 8},
          RoundingRadius->0], RectangleBox[{64., 0}, {66., 7},
          RoundingRadius->0], RectangleBox[{66., 0}, {68., 12},
          RoundingRadius->0], RectangleBox[{68., 0}, {70., 13},
          RoundingRadius->0], RectangleBox[{70., 0}, {72., 11},
          RoundingRadius->0], RectangleBox[{72., 0}, {74., 6},
          RoundingRadius->0], RectangleBox[{74., 0}, {76., 7},
          RoundingRadius->0], RectangleBox[{76., 0}, {78., 5},
          RoundingRadius->0], RectangleBox[{78., 0}, {80., 5},
          RoundingRadius->0], RectangleBox[{80., 0}, {82., 1},
          RoundingRadius->0], RectangleBox[{82., 0}, {84., 3},
          RoundingRadius->0], RectangleBox[{84., 0}, {86., 5},
          RoundingRadius->0], RectangleBox[{86., 0}, {88., 4},
          RoundingRadius->0], RectangleBox[{88., 0}, {90., 2},
          RoundingRadius->0], RectangleBox[{90., 0}, {92., 2},
          RoundingRadius->0], RectangleBox[{92., 0}, {94., 1},
          RoundingRadius->
           0]}, {}, {}}, {{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, \
{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {}}},
      AspectRatio->0.3,
      Axes->{False, False},
      AxesLabel->{None, None},
      AxesOrigin->{4.24, 0},
      Epilog->StyleBox[
        InsetBox[
         FormBox["\"B mean age = 24.2\"", TraditionalForm], 
         Scaled[{1, 1}], {1, 1}], FontFamily -> "Helvetica", FontSize -> 11, 
        StripOnInput -> False],
      Frame->{True, True, False, False},
      FrameLabel->{{
         FormBox["\"Count\"", TraditionalForm], None}, {
         FormBox["\"Age\"", TraditionalForm], None}},
      FrameStyle->GrayLevel[0],
      FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
      FrameTicksStyle->GrayLevel[0],
      GridLines->{None, None},
      GridLinesStyle->Directive[
        GrayLevel[0.5, 0.4]],
      ImageSize->400,
      LabelStyle->Directive[
        GrayLevel[0], FontSize -> 10, FontFamily -> "Helvetica"],
      PlotRange->{{0., 100.}, {0, All}},
      PlotRangePadding->{{
         Scaled[0.02], 
         Scaled[0.02]}, {None, 
         Scaled[0.05]}},
      Ticks->{Automatic, Automatic}]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
   GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}],
  "Grid"]], "Output",
 CellChangeTimes->{
  3.611596312219204*^9, 3.611596423704761*^9, {3.6127969893728733`*^9, 
   3.6127970056150723`*^9}, {3.612797053209754*^9, 3.612797078763186*^9}, 
   3.6127977528183527`*^9, 3.627596202276066*^9, {3.6275962681366167`*^9, 
   3.627596282000188*^9}, {3.627596312016687*^9, 3.627596322857205*^9}, 
   3.6275964386723127`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<figures/incidence-by-age.pdf\>\"", ",", "fig", ",", "\"\<PDF\>\""}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602954765978997*^9, 3.6029547907877483`*^9}, {
  3.6029548245093718`*^9, 3.602954827079212*^9}, {3.602954979789878*^9, 
  3.6029549822914267`*^9}}],

Cell[BoxData["\<\"figures/incidence-by-age.pdf\"\>"], "Output",
 CellChangeTimes->{
  3.602954791435279*^9, 3.602954827623211*^9, 3.6029549831260138`*^9, {
   3.6029555144484453`*^9, 3.602955521536071*^9}, 3.602955814254339*^9, {
   3.602955859356454*^9, 3.602955863777536*^9}, 3.602957687354547*^9, 
   3.602958573480343*^9, 3.603042984743799*^9, {3.603043027753621*^9, 
   3.603043038076782*^9}, {3.603043123437248*^9, 3.603043140041717*^9}, 
   3.603043180656827*^9, {3.603043296927569*^9, 3.60304331310478*^9}, 
   3.6030433859588537`*^9, 3.610388505146085*^9, 3.6103887774348497`*^9, 
   3.610388983443602*^9, 3.610389458894065*^9, 3.6115954176080847`*^9, 
   3.611596312471519*^9, 3.611596424060892*^9, {3.61279698972643*^9, 
   3.6127970062602663`*^9}, {3.612797053630471*^9, 3.6127970790574007`*^9}, 
   3.612797753017069*^9, 3.627596202668026*^9, {3.627596268412895*^9, 
   3.627596323132163*^9}, 3.627596438899035*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{
  "\"\<figures/incidence-by-age.png\>\"", ",", "fig", ",", "\"\<PNG\>\"", ",", 
   RowBox[{"ImageResolution", "\[Rule]", "imageResolution"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.602954765978997*^9, 3.60295483076705*^9}, 
   3.602954987848998*^9}],

Cell[BoxData["\<\"figures/incidence-by-age.png\"\>"], "Output",
 CellChangeTimes->{{3.602954812343308*^9, 3.6029548312272453`*^9}, {
   3.6029555147050133`*^9, 3.602955521844145*^9}, 3.602955814450779*^9, {
   3.6029558596483*^9, 3.602955863950622*^9}, 3.602957687532681*^9, 
   3.602958573681384*^9, 3.6030429854269323`*^9, {3.603043027986005*^9, 
   3.603043038450927*^9}, {3.603043123764928*^9, 3.603043140464308*^9}, 
   3.603043180870605*^9, {3.603043297239442*^9, 3.6030433135036297`*^9}, 
   3.6030433863240967`*^9, 3.6103885059056807`*^9, 3.610388778202059*^9, 
   3.610388985140174*^9, 3.61038945971308*^9, 3.611595418518611*^9, 
   3.611596313259961*^9, 3.611596424677464*^9, {3.612796990387396*^9, 
   3.612797006965707*^9}, {3.61279705420864*^9, 3.612797079758046*^9}, 
   3.612797753624957*^9, 3.627596203372923*^9, {3.6275962690671453`*^9, 
   3.627596323781927*^9}, 3.6275964394905243`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"h3Inc", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"counts", "=", 
       RowBox[{"N", "[", 
        RowBox[{"BinCounts", "[", 
         RowBox[{"h3Ages", ",", 
          RowBox[{"{", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"bins", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "100"}], "]"}], 
           "}"}]}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"counts", "/", 
      RowBox[{"Total", "[", "counts", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602953387500146*^9, 3.602953391442927*^9}, {
   3.602953448297367*^9, 3.602953463478519*^9}, {3.602953519119937*^9, 
   3.602953525792676*^9}, {3.6029535640428143`*^9, 3.602953565660077*^9}, {
   3.602953623724969*^9, 3.602953638127393*^9}, 3.602953714295354*^9, {
   3.602953759571555*^9, 3.602953781576364*^9}, 3.602954956803875*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h1Inc", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"counts", "=", 
       RowBox[{"N", "[", 
        RowBox[{"BinCounts", "[", 
         RowBox[{"h1Ages", ",", 
          RowBox[{"{", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"bins", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "100"}], "]"}], 
           "}"}]}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"counts", "/", 
      RowBox[{"Total", "[", "counts", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602953387500146*^9, 3.602953391442927*^9}, {
   3.602953448297367*^9, 3.602953463478519*^9}, {3.602953519119937*^9, 
   3.602953525792676*^9}, {3.6029535640428143`*^9, 3.602953565660077*^9}, {
   3.602953623724969*^9, 3.602953638127393*^9}, 3.602953714295354*^9, {
   3.602953759571555*^9, 3.602953797339651*^9}, 3.602954957438611*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"bInc", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"counts", "=", 
       RowBox[{"N", "[", 
        RowBox[{"BinCounts", "[", 
         RowBox[{"bAges", ",", 
          RowBox[{"{", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"bins", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", "100"}], "]"}], 
           "}"}]}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"counts", "/", 
      RowBox[{"Total", "[", "counts", "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.602953387500146*^9, 3.602953391442927*^9}, {
   3.602953448297367*^9, 3.602953463478519*^9}, {3.602953519119937*^9, 
   3.602953525792676*^9}, {3.6029535640428143`*^9, 3.602953565660077*^9}, {
   3.602953623724969*^9, 3.602953638127393*^9}, 3.602953714295354*^9, {
   3.602953759571555*^9, 3.602953814486086*^9}, {3.602954545145379*^9, 
   3.60295455069363*^9}, 3.602954959460834*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"N", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "#1", "]"}], ",", "#2"}], "}"}], "&"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"bins", ",", "h3Inc"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"N", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "#1", "]"}], ",", "#2"}], "}"}], "&"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"bins", ",", "h1Inc"}], "}"}]}], "]"}], "]"}], ",", 
      RowBox[{"N", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", "#1", "]"}], ",", "#2"}], "}"}], "&"}], ",", 
         
         RowBox[{"{", 
          RowBox[{"bins", ",", "bInc"}], "}"}]}], "]"}], "]"}]}], "}"}], ",", 
    
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"h3C", ",", "h1C", ",", "vC"}], "}"}]}], ",", 
    RowBox[{"PlotMarkers", "\[Rule]", "Automatic"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "300"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<Age\>\"", ",", "\"\<% of passengers\>\""}], "}"}]}]}], 
   "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.60288147603384*^9, 3.602881534817072*^9}, {
   3.602953586314249*^9, 3.6029536080558453`*^9}, {3.602953857746849*^9, 
   3.602953902330042*^9}, {3.60295456448711*^9, 3.602954577379362*^9}, 
   3.6029549692170057`*^9, {3.60295583076553*^9, 3.602955834216864*^9}}],

Cell[CellGroupData[{

Cell["Contact rates", "Subsection",
 CellChangeTimes->{{3.6029541045022087`*^9, 3.6029541063946342`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"contactRates", "=", 
  RowBox[{"Round", "[", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Total", "[", 
        RowBox[{"#", "*", "travel"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"h3Inc", ",", "h1Inc", ",", "bInc"}], "}"}]}], "]"}], ",", 
    "0.1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.602955009082258*^9, 3.6029550308792562`*^9}, {
  3.6029558058258038`*^9, 3.602955808522011*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10.8`", ",", "9.4`", ",", "7.5`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.602955031290547*^9, {3.602955514951495*^9, 3.602955522238241*^9}, {
   3.60295580896658*^9, 3.602955864266161*^9}, 3.602957687778673*^9, 
   3.602958573973527*^9, 3.603042990990078*^9, {3.603043028269305*^9, 
   3.60304303867229*^9}, {3.6030431239506617`*^9, 3.603043140857539*^9}, 
   3.603043181120152*^9, {3.6030432974108152`*^9, 3.6030433136652603`*^9}, 
   3.6030433866249037`*^9, 3.610388506112034*^9, 3.610388778434472*^9, 
   3.610389460309492*^9, 3.611595418791354*^9, 3.611596313772502*^9, 
   3.61159642516125*^9, {3.612796990608304*^9, 3.6127970072773037`*^9}, {
   3.6127970543764267`*^9, 3.612797080046598*^9}, 3.612797753838728*^9, 
   3.6275962035260487`*^9, {3.627596269196082*^9, 3.627596323867988*^9}, 
   3.627596439652111*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Round", "[", 
  RowBox[{
   RowBox[{"contactRates", "/", 
    RowBox[{"Max", "[", "contactRates", "]"}]}], ",", "0.01"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.603043243774661*^9, 3.603043263755273*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "0.87`", ",", "0.6900000000000001`"}], "}"}]], "Output",\

 CellChangeTimes->{{3.603043249326211*^9, 3.603043264165387*^9}, {
   3.603043297461296*^9, 3.603043313708384*^9}, 3.603043386672799*^9, 
   3.610388506166297*^9, 3.610388778489436*^9, 3.610389460351837*^9, 
   3.6115954188413887`*^9, 3.611596313827881*^9, 3.61159642528225*^9, {
   3.612796990663004*^9, 3.612797007363062*^9}, {3.612797054421256*^9, 
   3.612797080103791*^9}, 3.6127977538871517`*^9, 3.6275962035766773`*^9, {
   3.6275962692510843`*^9, 3.6275963238935328`*^9}, 3.627596439709425*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two compartments", "Subsection",
 CellChangeTimes->{{3.6115963762506*^9, 3.611596380818118*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h3ChildrenPro", "=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"Count", "[", 
     RowBox[{"h3Ages", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{"x", "<", "19"}]}]}], "]"}], "/", 
    RowBox[{"Length", "[", "h3Ages", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.611596316568549*^9, 3.611596365191791*^9}}],

Cell[BoxData["0.2649855312112443`"], "Output",
 CellChangeTimes->{{3.611596337515571*^9, 3.611596382776339*^9}, 
   3.611596425411202*^9, {3.612796990714171*^9, 3.6127970074118023`*^9}, {
   3.612797054465419*^9, 3.61279708015236*^9}, 3.612797753926839*^9, 
   3.627596203622446*^9, {3.627596269299102*^9, 3.627596323942522*^9}, 
   3.627596439759654*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"h1ChildrenPro", "=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"Count", "[", 
     RowBox[{"h1Ages", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{"x", "<", "19"}]}]}], "]"}], "/", 
    RowBox[{"Length", "[", "h1Ages", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.611596316568549*^9, 3.611596394984582*^9}}],

Cell[BoxData["0.4711815561959654`"], "Output",
 CellChangeTimes->{{3.611596389748191*^9, 3.611596395318843*^9}, 
   3.611596425466051*^9, {3.61279699076455*^9, 3.6127970074603167`*^9}, {
   3.612797054497888*^9, 3.612797080202024*^9}, 3.612797753978879*^9, 
   3.627596203706308*^9, {3.627596269353101*^9, 3.627596323988956*^9}, 
   3.627596439811555*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bChildrenPro", "=", 
  RowBox[{"N", "[", 
   RowBox[{
    RowBox[{"Count", "[", 
     RowBox[{"bAges", ",", 
      RowBox[{"x_", "/;", 
       RowBox[{"x", "<", "19"}]}]}], "]"}], "/", 
    RowBox[{"Length", "[", "bAges", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.611596316568549*^9, 3.611596400510724*^9}, {
  3.612796984045772*^9, 3.612796984328993*^9}}],

Cell[BoxData["0.5659543109801032`"], "Output",
 CellChangeTimes->{{3.6115964008236647`*^9, 3.611596425594099*^9}, {
   3.612796990814062*^9, 3.612797007493127*^9}, {3.6127970545480003`*^9, 
   3.612797080253147*^9}, 3.612797754028043*^9, 3.627596203803526*^9, {
   3.6275962694032583`*^9, 3.627596324045374*^9}, 3.627596439857931*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Age structured mixing", "Section",
 CellChangeTimes->{{3.612797755698814*^9, 3.6127977621525993`*^9}}],

Cell[CellGroupData[{

Cell["Data", "Subsection",
 CellChangeTimes->{{3.612797764506784*^9, 3.6127977649105253`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"files", "=", 
  RowBox[{"FileNames", "[", 
   RowBox[{"\"\<contacts-*\>\"", ",", "\"\<data/\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6127978261790113`*^9, 3.612797867649418*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"data/contacts-belgium.tsv\"\>", 
   ",", "\<\"data/contacts-britain.tsv\"\>", 
   ",", "\<\"data/contacts-finland.tsv\"\>", 
   ",", "\<\"data/contacts-germany.tsv\"\>", 
   ",", "\<\"data/contacts-italy.tsv\"\>", 
   ",", "\<\"data/contacts-luxembourg.tsv\"\>", 
   ",", "\<\"data/contacts-netherlands.tsv\"\>", 
   ",", "\<\"data/contacts-poland.tsv\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.612797834487649*^9, 3.612797868029776*^9}, 
   3.627596204007889*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"contactMatrix", "=", 
  RowBox[{"Mean", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"#", ",", "\"\<Table\>\""}], "]"}], "&"}], ",", "files"}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.612797872065741*^9, 3.612797899472584*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.6812500000000001`", ",", "0.6525`", ",", "0.22`", ",", 
     "0.14125000000000001`", ",", "0.21000000000000002`", ",", "0.42375`", 
     ",", "0.6862499999999999`", ",", "0.49874999999999997`", ",", "0.5925`", 
     ",", "0.30375`", ",", "0.195`", ",", "0.22875`", ",", 
     "0.28250000000000003`", ",", "0.17875`", ",", "0.1225`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.00375`", ",", "4.21125`", ",", "0.68375`", ",", "0.24874999999999997`",
      ",", "0.15000000000000002`", ",", "0.33375000000000005`", ",", 
     "0.53625`", ",", "0.7150000000000001`", ",", "0.48875`", ",", "0.27875`",
      ",", "0.32`", ",", "0.22875`", ",", "0.19624999999999998`", ",", 
     "0.21250000000000002`", ",", "0.15`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.345`", ",", "0.78625`", ",", "5.2275`", ",", "0.775`", ",", 
     "0.15125000000000002`", ",", "0.0875`", ",", "0.29000000000000004`", ",",
      "0.46375000000000005`", ",", "0.61125`", ",", "0.37375`", ",", 
     "0.25125`", ",", "0.14125`", ",", "0.1625`", ",", "0.1325`", ",", 
     "0.29500000000000004`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.18875000000000003`", ",", "0.22125`", ",", "0.9274999999999999`", ",", 
     "5.015000000000001`", ",", "0.8675`", ",", "0.26249999999999996`", ",", 
     "0.18375000000000002`", ",", "0.20625000000000002`", ",", 
     "0.6187499999999999`", ",", "0.615`", ",", "0.265`", ",", 
     "0.18374999999999997`", ",", "0.115`", ",", "0.095`", ",", 
     "0.28250000000000003`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.29500000000000004`", ",", "0.17500000000000002`", ",", "0.20125`", ",",
      "0.8062499999999999`", ",", "2.1237500000000002`", ",", "0.94625`", ",",
      "0.32625`", ",", "0.23375`", ",", "0.3875`", ",", 
     "0.39375000000000004`", ",", "0.34750000000000003`", ",", "0.2675`", ",",
      "0.16375`", ",", "0.115`", ",", "0.11000000000000001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.5862499999999999`", ",", "0.37500000000000006`", ",", 
     "0.14625000000000002`", ",", "0.26375`", ",", "0.96125`", ",", "1.42`", 
     ",", "0.6425`", ",", "0.41`", ",", "0.325`", ",", "0.39375`", ",", 
     "0.49`", ",", "0.40499999999999997`", ",", "0.30125`", ",", "0.15625`", 
     ",", "0.1875`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.875`", ",", "0.6524999999999999`", ",", "0.28375`", ",", 
     "0.16499999999999998`", ",", "0.6000000000000001`", ",", "0.8325`", ",", 
     "1.0474999999999999`", ",", "0.6512499999999999`", ",", 
     "0.44625000000000004`", ",", "0.44125000000000003`", ",", 
     "0.36500000000000005`", ",", "0.41125`", ",", "0.43749999999999994`", 
     ",", "0.23875000000000002`", ",", "0.18875`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.79375`", ",", "0.8387499999999999`", ",", "0.565`", ",", "0.31875`", 
     ",", "0.3725`", ",", "0.44`", ",", "0.9012499999999999`", ",", 
     "1.11375`", ",", "0.59125`", ",", "0.44875`", ",", "0.34875`", ",", 
     "0.31`", ",", "0.40125000000000005`", ",", "0.27`", ",", "0.27375`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.44375000000000003`", ",", "0.7225`", ",", "0.7974999999999999`", ",", 
     "0.46625`", ",", "0.33375`", ",", "0.34375`", ",", "0.5137499999999999`",
      ",", "0.7137499999999999`", ",", "0.9975`", ",", "0.69625`", ",", 
     "0.45125`", ",", "0.34875`", ",", "0.40125000000000005`", ",", 
     "0.33124999999999993`", ",", "0.31749999999999995`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.285`", ",", "0.31125`", ",", "0.48124999999999996`", ",", "0.5725`", 
     ",", "0.5025000000000001`", ",", "0.33125000000000004`", ",", "0.35`", 
     ",", "0.36750000000000005`", ",", "0.64625`", ",", "0.8300000000000001`",
      ",", "0.5449999999999999`", ",", "0.37375`", ",", "0.29625`", ",", 
     "0.22625`", ",", "0.355`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.33625`", ",", "0.23874999999999996`", ",", "0.22374999999999998`", ",",
      "0.32499999999999996`", ",", "0.4325`", ",", "0.4125`", ",", "0.3075`", 
     ",", "0.28`", ",", "0.38875000000000004`", ",", "0.5375000000000001`", 
     ",", "0.7849999999999999`", ",", "0.60375`", ",", "0.35250000000000004`",
      ",", "0.26`", ",", "0.26249999999999996`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.29500000000000004`", ",", "0.22374999999999998`", ",", "0.1325`", ",", 
     "0.15499999999999997`", ",", "0.20375`", ",", "0.26875`", ",", 
     "0.26375`", ",", "0.21375`", ",", "0.1625`", ",", "0.2925`", ",", 
     "0.47625`", ",", "0.8162499999999999`", ",", "0.52375`", ",", 
     "0.34874999999999995`", ",", "0.24`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.28125`", ",", "0.235`", ",", "0.11875`", ",", "0.056249999999999994`", 
     ",", "0.08625000000000001`", ",", "0.16125`", ",", "0.19875`", ",", 
     "0.22625000000000003`", ",", "0.19000000000000003`", ",", "0.14875`", 
     ",", "0.22749999999999998`", ",", "0.34625`", ",", "0.6975`", ",", 
     "0.48624999999999996`", ",", "0.3325`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.19874999999999998`", ",", "0.15875`", ",", "0.1175`", ",", "0.055`", 
     ",", "0.06625`", ",", "0.0875`", ",", "0.13`", ",", 
     "0.20625000000000002`", ",", "0.14875000000000002`", ",", "0.115`", ",", 
     "0.10499999999999998`", ",", "0.2025`", ",", "0.38500000000000006`", ",",
      "0.5425`", ",", "0.41375000000000006`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.23875`", ",", "0.23625`", ",", "0.27249999999999996`", ",", "0.175`", 
     ",", "0.19625000000000004`", ",", "0.18625`", ",", 
     "0.18125000000000002`", ",", "0.2225`", ",", "0.3225`", ",", 
     "0.39875000000000005`", ",", "0.4275`", ",", "0.30625`", ",", "0.4675`", 
     ",", "0.6175`", ",", "0.8124999999999999`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.612797876188922*^9, 3.6127979001092*^9}, 
   3.62759620420623*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"ageBins", "=", 
   RowBox[{"{", 
    RowBox[{
    "\"\<00-04\>\"", ",", "\"\<05-09\>\"", ",", "\"\<10-14\>\"", ",", 
     "\"\<15-19\>\"", ",", "\"\<20-24\>\"", " ", ",", "\"\<25-29\>\"", ",", 
     "\"\<30-34\>\"", ",", " ", "\"\<35-39\>\"", ",", " ", "\"\<40-44\>\"", 
     ",", " ", "\"\<45-49\>\"", " ", ",", "\"\<50-54\>\"", ",", " ", 
     "\"\<55-59\>\"", ",", " ", "\"\<60-64\>\"", ",", " ", "\"\<65-69\>\"", 
     ",", " ", "\"\<70+\>\""}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.612797902724173*^9, 3.612798055502293*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "ageBins", "]"}]], "Input",
 CellChangeTimes->{{3.612798128338745*^9, 3.612798130874498*^9}}],

Cell[BoxData["15"], "Output",
 CellChangeTimes->{3.612798131924542*^9, 3.627596204307158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "contactMatrix", "]"}]], "Input",
 CellChangeTimes->{{3.612798134710123*^9, 3.612798142224613*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"15", ",", "15"}], "}"}]], "Output",
 CellChangeTimes->{3.612798142667081*^9, 3.627596204456411*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-compartments", "Subsection",
 CellChangeTimes->{{3.612798157199746*^9, 3.612798163059826*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"threshold", "=", "3"}], ";"}]], "Input",
 CellChangeTimes->{{3.6127988102529917`*^9, 3.612798844053471*^9}, 
   3.6127988865593433`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"childToChild", "=", 
  RowBox[{"Mean", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"contactMatrix", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"1", ";;", "threshold"}], ",", 
       RowBox[{"1", ";;", "threshold"}]}], "]"}], "]"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.612798165518044*^9, 3.612798195891819*^9}, {
  3.612798237072207*^9, 3.61279824505654*^9}, {3.61279881825084*^9, 
  3.612798819489622*^9}}],

Cell[BoxData["1.6456944444444446`"], "Output",
 CellChangeTimes->{{3.612798176662245*^9, 3.612798180063706*^9}, {
   3.612798210889297*^9, 3.612798245499816*^9}, {3.612798836290976*^9, 
   3.612798845904086*^9}, 3.6127988880330887`*^9, 3.6275962047350616`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"childToAdult", "=", 
  RowBox[{"Mean", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"contactMatrix", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "threshold"}], ",", 
         RowBox[{
          RowBox[{"threshold", "+", "1"}], ";;", 
          RowBox[{"-", "1"}]}]}], "]"}], "]"}], ",", 
      RowBox[{"contactMatrix", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{
          RowBox[{"threshold", "+", "1"}], ";;", 
          RowBox[{"-", "1"}]}], ",", 
         RowBox[{"1", ";;", "threshold"}]}], "]"}], "]"}]}], "}"}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.612798165518044*^9, 3.612798195891819*^9}, {
  3.612798237072207*^9, 3.6127982547773857`*^9}, {3.612798354453887*^9, 
  3.612798373063393*^9}, {3.612798820847048*^9, 3.612798828579748*^9}}],

Cell[BoxData["0.3462673611111111`"], "Output",
 CellChangeTimes->{
  3.612798255241436*^9, {3.612798359909816*^9, 3.612798373503357*^9}, {
   3.6127988363299723`*^9, 3.612798845955037*^9}, 3.612798888072668*^9, 
   3.627596204840151*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"adultToAdult", "=", 
  RowBox[{"Mean", "[", 
   RowBox[{"Flatten", "[", 
    RowBox[{"contactMatrix", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{
        RowBox[{"threshold", "+", "1"}], ";;", 
        RowBox[{"-", "1"}]}], ",", 
       RowBox[{
        RowBox[{"threshold", "+", "1"}], ";;", 
        RowBox[{"-", "1"}]}]}], "]"}], "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.612798165518044*^9, 3.612798195891819*^9}, {
  3.612798237072207*^9, 3.6127982547773857`*^9}, {3.612798354453887*^9, 
  3.6127983946834517`*^9}, {3.612798831632038*^9, 3.612798833696217*^9}}],

Cell[BoxData["0.4351041666666664`"], "Output",
 CellChangeTimes->{
  3.612798395087575*^9, {3.6127988363755703`*^9, 3.612798845987741*^9}, 
   3.6127988881225853`*^9, 3.6275962049392567`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"adultToAdult", "/", "childToChild"}]], "Input",
 CellChangeTimes->{{3.612798509790258*^9, 3.6127985127718153`*^9}}],

Cell[BoxData["0.2643893999493626`"], "Output",
 CellChangeTimes->{
  3.612798513231881*^9, {3.6127988364241734`*^9, 3.6127988460372753`*^9}, 
   3.6127988881851063`*^9, 3.627596205040447*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"childToAdult", "/", "childToChild"}]], "Input",
 CellChangeTimes->{3.612798693532776*^9}],

Cell[BoxData["0.210408051312347`"], "Output",
 CellChangeTimes->{
  3.612798694127503*^9, {3.612798836474773*^9, 3.6127988460875597`*^9}, 
   3.612798888231234*^9, 3.627596205093244*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1141, 775},
WindowMargins->{{Automatic, 29}, {25, Automatic}},
ShowSelection->True,
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 146, 2, 114, "Title"],
Cell[CellGroupData[{
Cell[738, 28, 89, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[852, 33, 219, 4, 36, "Input"],
Cell[1074, 39, 6382, 88, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7493, 132, 240, 4, 36, "Input"],
Cell[7736, 138, 730, 11, 36, "Output"]
}, Open  ]],
Cell[8481, 152, 254, 7, 36, "Input"],
Cell[CellGroupData[{
Cell[8760, 163, 101, 1, 54, "Subsection"],
Cell[8864, 166, 391, 8, 36, "Input"],
Cell[9258, 176, 414, 8, 35, "Input"],
Cell[9675, 186, 315, 7, 35, "Input"],
Cell[9993, 195, 322, 7, 35, "Input"],
Cell[10318, 204, 294, 7, 36, "Input"],
Cell[10615, 213, 514, 15, 36, "Input"],
Cell[11132, 230, 202, 4, 36, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11383, 240, 108, 1, 80, "Section"],
Cell[11494, 243, 107, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[11626, 248, 367, 9, 57, "Input"],
Cell[11996, 259, 257, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12290, 268, 406, 9, 36, "Input"],
Cell[12699, 279, 258, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12994, 288, 232, 6, 35, "Input"],
Cell[13229, 296, 262, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13528, 305, 205, 4, 35, "Input"],
Cell[13736, 311, 259, 4, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14044, 321, 91, 1, 80, "Section"],
Cell[14138, 324, 930, 28, 57, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15105, 357, 97, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[15227, 362, 105, 1, 54, "Subsection"],
Cell[15335, 365, 330, 9, 36, "Input"],
Cell[15668, 376, 328, 9, 36, "Input"],
Cell[15999, 387, 397, 10, 36, "Input"],
Cell[16399, 399, 728, 21, 36, "Input"],
Cell[CellGroupData[{
Cell[17152, 424, 628, 13, 57, "Input"],
Cell[17783, 439, 4452, 92, 274, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22272, 536, 265, 6, 36, "Input"],
Cell[22540, 544, 768, 11, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23345, 560, 283, 7, 36, "Input"],
Cell[23631, 569, 757, 10, 36, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[24437, 585, 106, 1, 54, "Subsection"],
Cell[24546, 588, 140, 3, 35, "Input"],
Cell[CellGroupData[{
Cell[24711, 595, 283, 6, 35, "Input"],
Cell[24997, 603, 323, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25357, 613, 302, 7, 35, "Input"],
Cell[25662, 622, 305, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26004, 631, 359, 9, 35, "Input"],
Cell[26366, 642, 340, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26743, 651, 329, 10, 35, "Input"],
Cell[27075, 663, 335, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27447, 672, 169, 3, 35, "Input"],
Cell[27619, 677, 320, 5, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28000, 689, 94, 1, 80, "Section"],
Cell[28097, 692, 475, 8, 35, "Input"],
Cell[28575, 702, 232, 5, 36, "Input"],
Cell[28810, 709, 268, 7, 36, "Input"],
Cell[CellGroupData[{
Cell[29103, 720, 174, 4, 35, "Input"],
Cell[29280, 726, 177, 4, 36, "Output"]
}, Open  ]],
Cell[29472, 733, 193, 5, 36, "Input"],
Cell[CellGroupData[{
Cell[29690, 742, 255, 6, 36, "Input"],
Cell[29948, 750, 1157, 18, 35, "Output"]
}, Open  ]],
Cell[31120, 771, 811, 20, 36, "Input"],
Cell[31934, 793, 549, 15, 36, "Input"],
Cell[32486, 810, 494, 14, 36, "Input"],
Cell[32983, 826, 541, 15, 36, "Input"],
Cell[CellGroupData[{
Cell[33549, 845, 257, 7, 36, "Input"],
Cell[33809, 854, 1065, 18, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34911, 877, 437, 12, 36, "Input"],
Cell[35351, 891, 283, 6, 69, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35671, 902, 292, 7, 36, "Input"],
Cell[35966, 911, 700, 16, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36703, 932, 293, 7, 36, "Input"],
Cell[36999, 941, 700, 16, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37736, 962, 295, 7, 36, "Input"],
Cell[38034, 971, 688, 15, 55, "Output"]
}, Open  ]],
Cell[38737, 989, 2196, 48, 162, "Input"],
Cell[CellGroupData[{
Cell[40958, 1041, 2713, 59, 183, "Input"],
Cell[43674, 1102, 13153, 254, 554, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56864, 1361, 315, 7, 36, "Input"],
Cell[57182, 1370, 928, 13, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58147, 1388, 304, 7, 36, "Input"],
Cell[58454, 1397, 905, 12, 36, "Output"]
}, Open  ]],
Cell[59374, 1412, 961, 23, 36, "Input"],
Cell[60338, 1437, 961, 23, 36, "Input"],
Cell[61302, 1462, 1008, 24, 36, "Input"],
Cell[62313, 1488, 1746, 49, 99, "Input"],
Cell[CellGroupData[{
Cell[64084, 1541, 105, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[64214, 1546, 469, 13, 36, "Input"],
Cell[64686, 1561, 865, 14, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65588, 1580, 231, 6, 35, "Input"],
Cell[65822, 1588, 612, 10, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[66483, 1604, 102, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[66610, 1609, 342, 9, 36, "Input"],
Cell[66955, 1620, 355, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67347, 1630, 342, 9, 36, "Input"],
Cell[67692, 1641, 355, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68084, 1651, 388, 10, 36, "Input"],
Cell[68475, 1663, 334, 4, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[68870, 1674, 108, 1, 80, "Section"],
Cell[CellGroupData[{
Cell[69003, 1679, 94, 1, 54, "Subsection"],
Cell[CellGroupData[{
Cell[69122, 1684, 210, 4, 35, "Input"],
Cell[69335, 1690, 513, 11, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69885, 1706, 321, 9, 36, "Input"],
Cell[70209, 1717, 5967, 111, 498, "Output"]
}, Open  ]],
Cell[76191, 1831, 576, 11, 71, "Input"],
Cell[CellGroupData[{
Cell[76792, 1846, 131, 2, 45, "Input"],
Cell[76926, 1850, 93, 1, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77056, 1856, 141, 2, 43, "Input"],
Cell[77200, 1860, 139, 3, 43, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77388, 1869, 104, 1, 67, "Subsection"],
Cell[77495, 1872, 171, 4, 43, "Input"],
Cell[CellGroupData[{
Cell[77691, 1880, 461, 12, 43, "Input"],
Cell[78155, 1894, 260, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78452, 1902, 865, 23, 97, "Input"],
Cell[79320, 1927, 237, 4, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79594, 1936, 615, 15, 43, "Input"],
Cell[80212, 1953, 191, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80440, 1961, 139, 2, 43, "Input"],
Cell[80582, 1965, 191, 3, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80810, 1973, 113, 2, 43, "Input"],
Cell[80926, 1977, 186, 3, 43, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
